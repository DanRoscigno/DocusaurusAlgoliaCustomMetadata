<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-2.5 docs-doc-page docs-doc-id-table_design/table_types/primary_key_table" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-beta.0">
<title data-rh="true">Primary Key table | StarRocks</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://danroscigno.github.io/doc/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://danroscigno.github.io/doc/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://danroscigno.github.io/doc/docs/2.5/table_design/table_types/primary_key_table"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.5"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" name="docsearch:version" content="2.5"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.5"><meta data-rh="true" property="og:title" content="Primary Key table | StarRocks"><meta data-rh="true" name="description" content="StarRocks has started to support the Primary Key table since v1.19. When you create a table that uses the Primary Key table, you can define primary key columns and metric columns. Queries return the most recent record among a group of records that have the same primary key. Unlike the Unique Key table, the Primary Key table does not require aggregate operations during queries and supports the pushdown of predicates and indexes. As such, the Primary Key table can deliver high query performance despite real-time and frequent data updates."><meta data-rh="true" property="og:description" content="StarRocks has started to support the Primary Key table since v1.19. When you create a table that uses the Primary Key table, you can define primary key columns and metric columns. Queries return the most recent record among a group of records that have the same primary key. Unlike the Unique Key table, the Primary Key table does not require aggregate operations during queries and supports the pushdown of predicates and indexes. As such, the Primary Key table can deliver high query performance despite real-time and frequent data updates."><link data-rh="true" rel="icon" href="/doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danroscigno.github.io/doc/docs/2.5/table_design/table_types/primary_key_table"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/docs/2.5/table_design/table_types/primary_key_table" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/zh/docs/2.5/table_design/table_types/primary_key_table" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/docs/2.5/table_design/table_types/primary_key_table" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ER08SJMRY1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="StarRocks" href="/doc/opensearch.xml"><link rel="stylesheet" href="/doc/assets/css/styles.910971bc.css">
<script src="/doc/assets/js/runtime~main.3cb88f49.js" defer="defer"></script>
<script src="/doc/assets/js/main.0186dffa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.starrocks.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/doc/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">StarRocks</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/doc/docs/2.5/administration/Authentication">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/doc/docs/2.5/administration/Authentication">Stable-2.5</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/docs/table_design/table_types/primary_key_table">Latest-3.1</a></li><li><a class="dropdown__link" href="/doc/docs/3.0/table_design/table_types/primary_key_table">3.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/doc/docs/2.5/table_design/table_types/primary_key_table">Stable-2.5</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/doc/docs/2.5/table_design/table_types/primary_key_table" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li><li><a href="/doc/zh/docs/2.5/table_design/table_types/primary_key_table" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/StarRocks/starrocks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/administration/Authentication">administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/benchmarking/SSB_Benchmarking">benchmarking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/data_source/External_table">data_source</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/deployment/deploy_broker">deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/developers/How_to_Contribute">developers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/ecosystem_release/flink_connector">ecosystem_release</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/faq/Deploy_faq">faq</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/integrations/authenticate_to_aws_resources">integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/introduction/Architecture">introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/loading/BrokerLoad">loading</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/2.5/quick_start">quick_start</a><button aria-label="Expand sidebar category &#x27;quick_start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/reference/Error_code">reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/release_notes/release-2.1">release_notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/sql-reference/sql-functions/How_to_Write_Functions_Documentation">sql-reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/doc/docs/2.5/table_design">Introduction</a><button aria-label="Collapse sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/Data_distribution">Data distribution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/Sort_key">Sort keys and prefix indexes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/StarRocks_table_design">Understand table design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/Temporary_partition">Temporary partition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/data_compression">Data compression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/dynamic_partitioning">Dynamic partitioning</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/doc/docs/2.5/table_design/table_types">Table Types</a><button aria-label="Collapse sidebar category &#x27;Table Types&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/table_types/aggregate_table">Aggregate table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/table_types/duplicate_key_table">Duplicate Key table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/doc/docs/2.5/table_design/table_types/primary_key_table">Primary Key table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/2.5/table_design/table_types/unique_key_table">Unique Key table</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/unloading/Export">unloading</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/doc/docs/2.5/using_starrocks/Bitmap_index">using_starrocks</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/doc/docs/2.5/table_design"><span itemprop="name">Introduction</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/doc/docs/2.5/table_design/table_types"><span itemprop="name">Table Types</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Primary Key table</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Stable-2.5</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Primary Key table</h1>
<p>StarRocks has started to support the Primary Key table since v1.19. When you create a table that uses the Primary Key table, you can define primary key columns and metric columns. Queries return the most recent record among a group of records that have the same primary key. Unlike the Unique Key table, the Primary Key table does not require aggregate operations during queries and supports the pushdown of predicates and indexes. As such, the Primary Key table can deliver high query performance despite real-time and frequent data updates.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="scenarios">Scenarios<a href="#scenarios" class="hash-link" aria-label="Direct link to Scenarios" title="Direct link to Scenarios">​</a></h2>
<ul>
<li>
<p>The Primary Key table is suitable for the following scenarios in which data needs to be frequently updated in real time:</p>
<ul>
<li>
<p><strong>Stream data in real time from transaction processing systems into StarRocks.</strong> In normal cases, transaction processing systems involve a large number of update and delete operations in addition to insert operations. If you need to synchronize data from a transaction processing system to StarRocks, we recommend that you create a table that uses the Primary Key table. Then, you can use tools, such as CDC Connectors for Apache Flink®, to synchronize the binary logs of the transaction processing system to StarRocks. StarRocks uses the binary logs to add, delete, and update the data in the table in real time. This simplifies data synchronization and delivers 3 to 10 times higher query performance than when a Merge on Read (MoR) table of the Unique Key table is used. For example, you can use flink-connector-starrocks to load data. For more information, see <a href="/doc/docs/2.5/loading/Flink-connector-starrocks">Load data by using flink-connector-starrocks</a>.</p>
</li>
<li>
<p><strong>Join multiple streams by performing update operations on individual columns</strong>. In business scenarios such as user profiling, flat tables are preferably used to improve multi-dimensional analysis performance and simplify the analytics model that is used by data analysts. Upstream data in these scenarios may come from various apps, such as shopping apps, delivery apps, and banking apps, or from systems, such as machine learning systems that perform computations to obtain the distinct tags and properties of users. The Primary Key table is well suited in these scenarios, because it supports updates to individual columns. Each app or system can update only the columns that hold the data within its own service scope while benefiting from real-time data additions, deletions, and updates at high query performance.</p>
</li>
</ul>
</li>
<li>
<p>The Primary Key table is suitable for scenarios in which the memory occupied by the primary key is controllable.</p>
<p>The storage engine of StarRocks creates an index for the primary key of each table that uses the Primary Key table. Additionally, when you load data into a table, StarRocks loads the primary key index into the memory. Therefore, the Primary Key table requires a larger memory capacity than the other three table types. <strong>StarRocks limits the total length of the fields that comprise the primary key to 127 bytes after encoding.</strong></p>
<p>Consider using the Primary Key table if a table has the following characteristics:</p>
<ul>
<li>
<p>The table contains both fast-changing data and slow-changing data. Fast-changing data is frequently updated over the most recent days, whereas slow-changing data is rarely updated. Suppose that you need to synchronize a MySQL order table to StarRocks in real time for analytics and queries. In this example, the data of the table is partitioned by day, and most updates are performed on orders that are created within the most recent days. Historical orders are no longer updated after they are completed. When you run a data load job, the primary key index is not loaded into the memory and only the index entries of the recently updated orders are loaded into the memory.</p>
<p>As shown in the following figure, the data in the table is partitioned by day, and the data in the most recent two partitions is frequently updated.</p>
<p><img loading="lazy" alt="Primary index -1" src="data:image/png;base64,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" width="304" height="483" class="img_ev3q"></p>
</li>
<li>
<p>The table is a flat table that is composed of hundreds or thousands of columns. The primary key comprises only a small portion of the table data and consumes only a small amount of memory. For example, a user status or profile table consists of a large number of columns but only tens to hundreds of millions of users. In this situation, the amount of memory consumed by the primary key is controllable.</p>
<p>As shown in the following figure, the table contains only a few rows, and the primary key of the table comprises only a small portion of the table.</p>
<p><img loading="lazy" alt="Primary index -2" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmwAAABSCAMAAADepHjjAAAAbFBMVEVHcEzGxsaBgYFxcXGIiIhvb2+np6eenp55eXmTk5OJiYmWlpZTU1MADQ2wOztyXV0AAACJLS0AAAAAAABlIiIADAwAAAAAAAD///8A////VVXW1tawsLDt7e0AdnYA7u4Ay8sApaUAPz/ORUU01xB2AAAAGHRSTlMA/OTs5fD34+Xr9O3v/fPoGueHKO3lIHIb9mmvAAAEHklEQVR42u2diVLbMBRFSRwFJ1h1KZTiAlrc///HSsoyvCQ1eCNxet50IDcL4zs6c/20UG5uetX3x/ujKm5FDSdXpZB5JmS5kB9djXQVIzqYT92BanRQ3vSE7dvvoyqfRc0b5ULKlZR3Qr0thZzNhFy+CLl+EzJ7bpJ5o7wMB2ryDm6BbSpDdZEOXqSDV2ADNpKNobo6ByQbsJFsDBU9G7ABG8kGbPRswIYDkg3Y6NkYKpIN2IDt0nu2h8cTlYkqBpNKyuJAqgapirEuakgHxVU7yAqSbSrJdpEb8S/cRrmNsvTBUDFBADZgI9mAbWrrbCQbsJFsDBU9G7ABG8kGbNPv2R7a1xOw4aBTsun29RPYcNCpZ9O2alkO2HDQMdmADdimkWxPp/77hYWo4WQupVLyvZmU+UhX0UfOGx2UBw7mF+ig1xiQbFPJBcVtFNhwwAQB2M6wzkayARvJxlD9j0sf1nvvdiTVDtiAbbxk89qYehdwBtiAbcSezeuYaKZyIeLCl8qmB5X3kT+3ST1nnXeJw/AI2HDQPdkSbFbXxlTaVaauw78gQtq5+M2El4N24bXKaWDDQfeezWvvjXZWhzhLsOnIVBC139w2gzZ1tfkSeAQ2HPTq2UKrZlPblpKt2ogAlo0ZFx6Hu2x8MhDpgA0HfZItBdhJ2HaPE2zhiaiBDQf9erZ/wRYgM3vYnE5tm9iI/3ZUxauoVlI1vbqUr67X8qN38qPL7lfRSpYtDH3gYHUeB6qF7ONAfQCb02FmsIctzBMOT33c/zmq4kWUkjJrI3OhZmshl0sh16/yJ82EbL6oVrLNJfdxoM7kYLQxmH+4g2Dfv56mDNxGcdB5ne3T+1Q+BRuw4aB7z/b5TdG0zAtsOOg+G2UjHtguL9mADQeD9WwH2FkPbDgYKdm2SyDv5gPAhoORerbdetsu5jawWWDDwTjJFs97bA53xKMf4XuQtU3rvL62wIaDgXq2BFu9STTtK1vXVToJErestgeMgA0HAyabT0eK4qmiCJ3TPh4/ittX2nMbxcGgPdsBbPGom4/Hdq3eBxuw4WDQZIvH1mKjZneI1cbv3yhPfZyoXFQxmMykLKUslJTZSFeBg84OTsNWmfhLMHFWoI3fHmszNcl2TgfqqpItLuI6u13Mdd5bl5403tq0KeqZjeKA34gHNvZGGSpmo8AGbCQbQ0XPBmw4INmAbXI9m2ldwIaDbsn2o339AjYcdOrZ+HNCwPZlyQZswPZlPRuwAdtEku3kH91YiRpOrqXMlHzvXMr1SFcxngOVT85B3soByUay0bMxVMxGgQ0HJBuwMRtlqHAAbMBGzwZsJBuw4YCeDdhINoaKng3YgI1kY6jo2T6G7dRG/K2o4eSiFDLPhCwX8qOrka6ij1w1OlDz63ZQ/gU8aAMnm2fkIAAAAABJRU5ErkJggg==" width="620" height="82" class="img_ev3q"></p>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="principle">Principle<a href="#principle" class="hash-link" aria-label="Direct link to Principle" title="Direct link to Principle">​</a></h2>
<p>The Primary Key table is designed based on a new storage engine that is provided by StarRocks. The metadata structure and the read/write mechanism in the Primary Key table differ from those in the Duplicate Key table. As such, the Primary Key table does not require aggregate operations and supports the pushdown of predicates and indexes. These significantly increase query performance.</p>
<p>The Duplicate Key table adopts the MoR policy. MoR streamlines data writes but requires online aggregation of multiple data versions. Additionally, the Merge operator does not support the pushdown of predicates and indexes. As a result, query performance deteriorates.</p>
<p>The Primary Key table adopts the Delete+Insert policy to ensure that each record has a unique primary key. This way, the Primary Key table does not require merge operations. Details are as follows:</p>
<ul>
<li>
<p>When StarRocks receives a request for an update operation on a record, it locates the record by searching the primary key index, marks the record as deleted, and inserts a new record. In other words, StarRocks converts an update operation to a delete operation plus an insert operation.</p>
</li>
<li>
<p>When StarRocks receives a delete operation on a record, it locates the record by searching the primary key index and marks the record as deleted.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-table">Create a table<a href="#create-a-table" class="hash-link" aria-label="Direct link to Create a table" title="Direct link to Create a table">​</a></h2>
<p>Example 1: Suppose that you need to analyze orders on a daily basis. In this example, create a table named <code>orders</code>, define <code>dt</code> and <code>order_id</code> as the primary key, and define the other columns as metric columns.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> orders </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dt </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    order_id </span><span class="token keyword" style="color:#00009f">bigint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merchant_id </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    good_id </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    good_name string </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    price </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cnt </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    revenue </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> order_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> RANGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p20210820 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-08-20&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-08-21&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p20210821 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-08-21&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-08-22&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p20210929 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-09-29&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-09-30&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p20210930 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-09-30&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2021-10-01&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">order_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> BUCKETS </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;enable_persistent_index&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example 2: Suppose that you need to analyze user behavior in real time. In this example, create a table named <code>users</code>, define <code>user_id</code> as the primary key, and define the other columns as metric columns.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> users </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_id </span><span class="token keyword" style="color:#00009f">bigint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name string </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    email string </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    address string </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    age </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sex </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    last_active </span><span class="token keyword" style="color:#00009f">datetime</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    property0 </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    property1 </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    property2 </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    property3 </span><span class="token keyword" style="color:#00009f">tinyint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> BUCKETS </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;enable_persistent_index&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;true&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-notes">Usage notes<a href="#usage-notes" class="hash-link" aria-label="Direct link to Usage notes" title="Direct link to Usage notes">​</a></h3>
<ul>
<li>
<p>Take note of the following points about the primary key of a table:</p>
<ul>
<li>
<p>The primary key is defined by using the <code>PRIMARY KEY</code> keyword.</p>
</li>
<li>
<p>The primary key must be created on columns on which unique constraints are enforced, and the names of the primary key columns cannot be changed.</p>
</li>
<li>
<p>The primary key columns can be any of the following data types: BOOLEAN, TINYINT, SMALLINT, INT, BIGINT, LARGEINT, STRING, VARCHAR, DATE, and DATETIME. However, the primary key columns cannot be defined as <code>NULL</code>.</p>
</li>
<li>
<p>The partition column and the bucket column must participate in the primary key.</p>
</li>
<li>
<p>The number and total length of primary key columns must be properly designed to save memory. We recommend that you identify columns whose data types occupy less memory and define those columns as the primary key. Such data types include INT and BIGINT. We recommend that you do not let a column of the VARCHAR data type to participate in the primary key.</p>
</li>
<li>
<p>Before you create the table, we recommend that you estimate the memory occupied by the primary key index based on the data types of the primary key columns and the number of rows in the table. This way, you can prevent the table from running out of memory. The following example explains how to calculate the memory occupied by the primary key index:</p>
<ul>
<li>
<p>Suppose that the <code>dt</code> column, which is of the DATE data type that occupies 4 bytes, and the <code>id</code> column, which is of the BIGINT data type that occupies 8 bytes, are defined as the primary key. In this case, the primary key is 12 bytes in length.</p>
</li>
<li>
<p>Suppose that the table contains 10,000,000 rows of hot data and is stored in three replicas.</p>
</li>
<li>
<p>Given the preceding information, the memory occupied by the primary key index is 945 MB based on the following formula:</p>
<p>(12 + 9) x 10,000,000 x 3 x 1.5 = 945 (MB)</p>
<p>In the preceding formula, <code>9</code> is the immutable overhead per row, and <code>1.5</code> is the average extra overhead per hash table.</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>enable_persistent_index</code>: the primary key index can be persisted to disk and stored in memory to avoid it taking up too much memory. Generally, the primary key index can only take up 1/10 of the memory it does before. You can set this property in <code>PROPERTIES</code> when you create a table. Valid values are true or false. Default value is false.</p>
<blockquote>
<ul>
<li>If you want to modify this parameter after the table is created, please see the part Modify the properties of table in <a href="/doc/docs/2.5/sql-reference/sql-statements/data-definition/ALTER_TABLE">ALTER TABLE</a>.</li>
<li>It is recommended to set this property to true if the disk is SSD.</li>
<li>As of version 2.3.0, StarRocks supports to set this property.</li>
</ul>
</blockquote>
</li>
<li>
<p>Since version 2.3.0, the indicator column now supports BITMAP, HLL data types.</p>
</li>
<li>
<p>When you create a table, you cannot create BITMAP indexes or Bloom Filter indexes on the metric columns of the table.</p>
</li>
<li>
<p>Since version 2.4.0, you can create asynchronous materialized views based on Primary Key tables.</p>
</li>
<li>
<p>The Primary Key table does not support materialized views.</p>
</li>
<li>
<p>You cannot use the ALTER TABLE statement to change the data types of the primary key columns and reorder metric columns. For the syntax and examples of using the ALTER TABLE statement, see <a href="/doc/docs/2.5/sql-reference/sql-statements/data-definition/ALTER_TABLE">ALTER TABLE</a>.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-to-do-next">What to do next<a href="#what-to-do-next" class="hash-link" aria-label="Direct link to What to do next" title="Direct link to What to do next">​</a></h2>
<p>After table creation, you can run load jobs to load data into the Primary Key table. For more information about supported loading methods, see <a href="/doc/docs/2.5/loading/Loading_intro">Overview of data loading</a>.</p>
<p>If you need to update data in the Primary Key table, you can <a href="/doc/docs/2.5/loading/Load_to_Primary_Key_tables">run a load job</a> or execute a DML statement (<a href="/doc/docs/2.5/sql-reference/sql-statements/data-manipulation/UPDATE">UPDATE</a> or <a href="/doc/docs/2.5/sql-reference/sql-statements/data-manipulation/DELETE">DELETE</a>). Also, these update operations guarantee atomicity.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/StarRocks/starrocks/edit/main/docs/table_design/table_types/primary_key_table.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc/docs/2.5/table_design/table_types/duplicate_key_table"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Duplicate Key table</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/doc/docs/2.5/table_design/table_types/unique_key_table"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Unique Key table</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scenarios" class="table-of-contents__link toc-highlight">Scenarios</a></li><li><a href="#principle" class="table-of-contents__link toc-highlight">Principle</a></li><li><a href="#create-a-table" class="table-of-contents__link toc-highlight">Create a table</a><ul><li><a href="#usage-notes" class="table-of-contents__link toc-highlight">Usage notes</a></li></ul></li><li><a href="#what-to-do-next" class="table-of-contents__link toc-highlight">What to do next</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc/docs/introduction/StarRocks_intro">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 StarRocks, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>