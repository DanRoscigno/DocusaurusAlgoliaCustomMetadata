<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-3.1 docs-doc-page docs-doc-id-unloading/Spark_connector" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-beta.0">
<title data-rh="true">Read data from StarRocks using Spark connector | StarRocks</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://danroscigno.github.io/doc/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://danroscigno.github.io/doc/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://danroscigno.github.io/doc/docs/unloading/Spark_connector"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="3.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.1"><meta data-rh="true" name="docsearch:version" content="3.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.1"><meta data-rh="true" property="og:title" content="Read data from StarRocks using Spark connector | StarRocks"><meta data-rh="true" name="description" content="StarRocks provides a self-developed connector named StarRocks Connector for Apache Spark™ (Spark connector for short) to help you read data from a StarRocks table by using Spark. You can use Spark for complex processing and machine learning on the data you have read from StarRocks."><meta data-rh="true" property="og:description" content="StarRocks provides a self-developed connector named StarRocks Connector for Apache Spark™ (Spark connector for short) to help you read data from a StarRocks table by using Spark. You can use Spark for complex processing and machine learning on the data you have read from StarRocks."><link data-rh="true" rel="icon" href="/doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danroscigno.github.io/doc/docs/unloading/Spark_connector"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/docs/unloading/Spark_connector" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/zh/docs/unloading/Spark_connector" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/docs/unloading/Spark_connector" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ER08SJMRY1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="StarRocks" href="/doc/opensearch.xml"><link rel="stylesheet" href="/doc/assets/css/styles.910971bc.css">
<script src="/doc/assets/js/runtime~main.346c5410.js" defer="defer"></script>
<script src="/doc/assets/js/main.a5815ce3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.starrocks.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/doc/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">StarRocks</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/doc/docs/introduction/StarRocks_intro">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/doc/docs/introduction/StarRocks_intro">latest-3.1</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/doc/docs/unloading/Spark_connector">latest-3.1</a></li><li><a class="dropdown__link" href="/doc/docs/3.0/unloading/Spark_connector">3.0</a></li><li><a class="dropdown__link" href="/doc/docs/2.5/unloading/Spark_connector">2.5</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/doc/docs/unloading/Spark_connector" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li><li><a href="/doc/zh/docs/unloading/Spark_connector" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/StarRocks/starrocks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/docs/introduction/StarRocks_intro">StarRocks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/introduction-to-starrocks">Introduction to StarRocks</a><button aria-label="Expand sidebar category &#x27;Introduction to StarRocks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/quick_start">Quick Start</a><button aria-label="Expand sidebar category &#x27;Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/deployment/deployment_overview">Deployment</a><button aria-label="Expand sidebar category &#x27;Deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/table_design/StarRocks_table_design">Table Design</a><button aria-label="Expand sidebar category &#x27;Table Design&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/loading/Loading_intro">Data Loading</a><button aria-label="Expand sidebar category &#x27;Data Loading&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/doc/docs/category/data-unloading">Data Unloading</a><button aria-label="Collapse sidebar category &#x27;Data Unloading&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/unloading/Export">Export data using EXPORT</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/doc/docs/unloading/Spark_connector">Read data from StarRocks using Spark connector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/docs/unloading/Flink_connector">Read data from StarRocks using Flink connector</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/query-data-lakes">Query Data Lakes</a><button aria-label="Expand sidebar category &#x27;Query Data Lakes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/query-acceleration">Query Acceleration</a><button aria-label="Expand sidebar category &#x27;Query Acceleration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/integrations">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/administration">Administration</a><button aria-label="Expand sidebar category &#x27;Administration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/faq">FAQ</a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/benchmarks">Benchmarks</a><button aria-label="Expand sidebar category &#x27;Benchmarks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/developers">Developers</a><button aria-label="Expand sidebar category &#x27;Developers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/docs/category/ecosystem-release-notes">Ecosystem Release Notes</a><button aria-label="Expand sidebar category &#x27;Ecosystem Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/doc/docs/category/data-unloading"><span itemprop="name">Data Unloading</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Read data from StarRocks using Spark connector</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: latest-3.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Read data from StarRocks using Spark connector</h1>
<p>StarRocks provides a self-developed connector named StarRocks Connector for Apache Spark™ (Spark connector for short) to help you read data from a StarRocks table by using Spark. You can use Spark for complex processing and machine learning on the data you have read from StarRocks.</p>
<p>The Spark connector supports three reading methods: Spark SQL, Spark DataFrame, and Spark RDD.</p>
<p>You can use Spark SQL to create a temporary view on the StarRocks table, and then directly read data from the StarRocks table by using that temporary view.</p>
<p>You can also map the StarRocks table to a Spark DataFrame or a Spark RDD, and then read data from the Spark DataFrame or Spark RDD. We recommend the use of a Spark DataFrame.</p>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>Only users with the SELECT privilege on a StarRocks table can read data from this table. You can follow the instructions provided in <a href="/doc/docs/sql-reference/sql-statements/account-management/GRANT">GRANT</a> to grant the privilege to a user.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage-notes">Usage notes<a href="#usage-notes" class="hash-link" aria-label="Direct link to Usage notes" title="Direct link to Usage notes">​</a></h2>
<ul>
<li>You can filter data on StarRocks before you read the data, thereby reducing the amount of data transferred.</li>
<li>If the overhead of reading data is substantial, you can employ appropriate table design and filter conditions to prevent Spark from reading an excessive amount of data at a time. As such, you can reduce I/O pressure on your disk and network connection, thereby ensuring routine queries can be run properly.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="version-requirements">Version requirements<a href="#version-requirements" class="hash-link" aria-label="Direct link to Version requirements" title="Direct link to Version requirements">​</a></h2>
<table><thead><tr><th>Spark connector</th><th>Spark</th><th>StarRocks</th><th>Java</th><th>Scala</th></tr></thead><tbody><tr><td>1.1.1</td><td>3.2, 3.3, 3.4</td><td>2.5 and later</td><td>8</td><td>2.12</td></tr><tr><td>1.1.0</td><td>3.2, 3.3, 3.4</td><td>2.5 and later</td><td>8</td><td>2.12</td></tr><tr><td>1.0.0</td><td>3.x</td><td>1.18 and later</td><td>8</td><td>2.12</td></tr><tr><td>1.0.0</td><td>2.x</td><td>1.18 and later</td><td>8</td><td>2.11</td></tr></tbody></table>
<blockquote>
<p><strong>NOTICE</strong></p>
<ul>
<li>Please see <a href="#upgrade-spark-connector">Upgrade Spark connector</a> for behaviour changes among different connector versions.</li>
<li>The connector does not provide MySQL JDBC driver since version 1.1.1, and you need import the driver to the Spark classpath manually. You can find the driver on <a href="https://repo1.maven.org/maven2/mysql/mysql-connector-java/" target="_blank" rel="noopener noreferrer">Maven Central</a>.</li>
<li>In version 1.0.0, the Spark connector only supports reading data from StarRocks. From version 1.1.0 onwards, the Spark connector supports both reading data from and writing data to StarRocks.</li>
<li>Version 1.0.0 differs from version 1.1.0 in terms of parameters and data type mappings. See <a href="#upgrade-spark-connector">Upgrade Spark connector</a>.</li>
<li>In general cases, no new features will be added to version 1.0.0. We recommend that you upgrade your Spark connector at your earliest opportunity.</li>
</ul>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="obtain-spark-connector">Obtain Spark connector<a href="#obtain-spark-connector" class="hash-link" aria-label="Direct link to Obtain Spark connector" title="Direct link to Obtain Spark connector">​</a></h2>
<p>Use one of the following methods to obtain the Spark connector <strong>.jar</strong> package that suits your business needs:</p>
<ul>
<li>Download a compiled package.</li>
<li>Use Maven to add the dependencies required by the Spark connector. (This method is supported only for Spark connector 1.1.0 and later.)</li>
<li>Manually compile a package.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spark-connector-110-and-later">Spark connector 1.1.0 and later<a href="#spark-connector-110-and-later" class="hash-link" aria-label="Direct link to Spark connector 1.1.0 and later" title="Direct link to Spark connector 1.1.0 and later">​</a></h3>
<p>Spark connector <strong>.jar</strong> packages are named in the following format:</p>
<p><code>starrocks-spark-connector-${spark_version}_${scala_version}-${connector_version}.jar</code></p>
<p>For example, if you want to use Spark connector 1.1.0 with Spark 3.2 and Scala 2.12, you can choose <code>starrocks-spark-connector-3.2_2.12-1.1.0.jar</code>.</p>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>In normal cases, the latest Spark connector version can be used with the most recent three Spark versions.</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="download-a-compiled-package">Download a compiled package<a href="#download-a-compiled-package" class="hash-link" aria-label="Direct link to Download a compiled package" title="Direct link to Download a compiled package">​</a></h4>
<p>You can obtain Spark connector <strong>.jar</strong> packages of various versions at <a href="https://repo1.maven.org/maven2/com/starrocks" target="_blank" rel="noopener noreferrer">Maven Central Repository</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="add-maven-dependencies">Add Maven dependencies<a href="#add-maven-dependencies" class="hash-link" aria-label="Direct link to Add Maven dependencies" title="Direct link to Add Maven dependencies">​</a></h4>
<p>Configure the dependencies required by the Spark connector as follows:</p>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>You must replace <code>spark_version</code>, <code>scala_version</code>, and <code>connector_version</code> with the Spark version, Scala version, and Spark connector version you use.</p>
</blockquote>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.starrocks</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">starrocks-spark-connector-${spark_version}_${scala_version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${connector_version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For example, if you want to use Spark connector 1.1.0 with Spark 3.2 and Scala 2.12, configure the dependencies as follows:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.starrocks</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">starrocks-spark-connector-3.2_2.12</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.1.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="manually-compile-a-package">Manually compile a package<a href="#manually-compile-a-package" class="hash-link" aria-label="Direct link to Manually compile a package" title="Direct link to Manually compile a package">​</a></h4>
<ol>
<li>
<p>Download <a href="https://github.com/StarRocks/starrocks-connector-for-apache-spark" target="_blank" rel="noopener noreferrer">the Spark connector code</a>.</p>
</li>
<li>
<p>Use the following command to compile the Spark connector:</p>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>You must replace <code>spark_version</code> with the Spark version you use.</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sh</span><span class="token plain"> build.sh </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">spark_version</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For example, if you want to use the Spark connector with Spark 3.2, compile the Spark connector as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sh</span><span class="token plain"> build.sh </span><span class="token number" style="color:#36acaa">3.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Go to the <code>target/</code> path, in which a Spark connector <strong>.jar</strong> package like <code>starrocks-spark-connector-3.2_2.12-1.1.0-SNAPSHOT.jar</code> is generated upon compilation.</p>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>If you are using a Spark connector version that is not officially released, the name of the generated Spark connector <strong>.jar</strong> package contains <code>SNAPSHOT</code> as a suffix.</p>
</blockquote>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spark-connector-100">Spark connector 1.0.0<a href="#spark-connector-100" class="hash-link" aria-label="Direct link to Spark connector 1.0.0" title="Direct link to Spark connector 1.0.0">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="download-a-compiled-package-1">Download a compiled package<a href="#download-a-compiled-package-1" class="hash-link" aria-label="Direct link to Download a compiled package" title="Direct link to Download a compiled package">​</a></h4>
<ul>
<li><a href="https://cdn-thirdparty.starrocks.com/spark/starrocks-spark2_2.11-1.0.0.jar" target="_blank" rel="noopener noreferrer">Spark 2.x</a></li>
<li><a href="https://cdn-thirdparty.starrocks.com/spark/starrocks-spark3_2.12-1.0.0.jar" target="_blank" rel="noopener noreferrer">Spark 3.x</a></li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="manually-compile-a-package-1">Manually compile a package<a href="#manually-compile-a-package-1" class="hash-link" aria-label="Direct link to Manually compile a package" title="Direct link to Manually compile a package">​</a></h4>
<ol>
<li>
<p>Download <a href="https://github.com/StarRocks/starrocks-connector-for-apache-spark/tree/spark-1.0" target="_blank" rel="noopener noreferrer">the Spark connector code</a>.</p>
<blockquote>
<p><strong>NOTICE</strong></p>
<p>You must switch to <code>spark-1.0</code>.</p>
</blockquote>
</li>
<li>
<p>Take one of the following actions to compile the Spark connector:</p>
<ul>
<li>
<p>If you are using Spark 2.x, run the following command, which compiles the Spark connector to suit Spark 2.3.4 by default:</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh build.sh 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If you are using Spark 3.x, run the following command, which compiles the Spark connector to suit Spark 3.1.2 by default:</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh build.sh 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<p>Go to the <code>output/</code> path, in which the <code>starrocks-spark2_2.11-1.0.0.jar</code> file is generated upon compilation. Then, copy the file to the classpath of Spark:</p>
<ul>
<li>If your Spark cluster runs in <code>Local</code> mode, place the file into the <code>jars/</code> path.</li>
<li>If your Spark cluster runs in <code>Yarn</code> mode, place the file into the pre-deployment package.</li>
</ul>
</li>
</ol>
<p>You can use the Spark connector to read data from StarRocks only after you place the file into the specified location.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="parameters">Parameters<a href="#parameters" class="hash-link" aria-label="Direct link to Parameters" title="Direct link to Parameters">​</a></h2>
<p>This section describes the parameters you need to configure when you use the Spark connector to read data from StarRocks.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-parameters">Common parameters<a href="#common-parameters" class="hash-link" aria-label="Direct link to Common parameters" title="Direct link to Common parameters">​</a></h3>
<p>The following parameters apply to all three reading methods: Spark SQL, Spark DataFrame, and Spark RDD.</p>
<table><thead><tr><th>Parameter</th><th>Default value</th><th>Description</th></tr></thead><tbody><tr><td>starrocks.fenodes</td><td>None</td><td>The HTTP URL of the FE in your StarRocks cluster. Format <code>&lt;fe_host&gt;:&lt;fe_http_port&gt;</code>. You can specify multiple URLs, which must be separated by a comma (,).</td></tr><tr><td>starrocks.table.identifier</td><td>None</td><td>The name of the StarRocks table. Format: <code>&lt;database_name&gt;.&lt;table_name&gt;</code>.</td></tr><tr><td>starrocks.request.retries</td><td>3</td><td>The maximum number of times that Spark can retry to send a read request o StarRocks.</td></tr><tr><td>starrocks.request.connect.timeout.ms</td><td>30000</td><td>The maximum amount of time after which a read request sent to StarRocks times out.</td></tr><tr><td>starrocks.request.read.timeout.ms</td><td>30000</td><td>The maximum amount of time after which the reading for a request sent to StarRocks times out.</td></tr><tr><td>starrocks.request.query.timeout.s</td><td>3600</td><td>The maximum amount of time after which a query of data from StarRocks times out. The default timeout period is 1 hour. <code>-1</code> means that no timeout period is specified.</td></tr><tr><td>starrocks.request.tablet.size</td><td>Integer.MAX_VALUE</td><td>The number of StarRocks tablets grouped into each Spark RDD partition. A smaller value of this parameter indicates that a larger number of Spark RDD partitions will be generated. A larger number of Spark RDD partitions means higher parallelism on Spark but greater pressure on StarRocks.</td></tr><tr><td>starrocks.batch.size</td><td>4096</td><td>The maximum number of rows that can be read from BEs at a time. Increasing the value of this parameter can reduce the number of connections established between Spark and StarRocks, thereby mitigating extra time overheads caused by network latency.</td></tr><tr><td>starrocks.exec.mem.limit</td><td>2147483648</td><td>The maximum amount of memory allowed per query. Unit: bytes. The default memory limit is 2 GB.</td></tr><tr><td>starrocks.deserialize.arrow.async</td><td>false</td><td>Specifies whether to support asynchronously converting the Arrow memory format to RowBatches required for the iteration of the Spark connector.</td></tr><tr><td>starrocks.deserialize.queue.size</td><td>64</td><td>The size of the internal queue that holds tasks for asynchronously converting the Arrow memory format to RowBatches. This parameter is valid when <code>starrocks.deserialize.arrow.async</code> is set to <code>true</code>.</td></tr><tr><td>starrocks.filter.query</td><td>None</td><td>The condition based on which you want to filter data on StarRocks. You can specify multiple filter conditions, which must be joined by <code>and</code>. StarRocks filters the data from the StarRocks table based on the specified filter conditions before the data is read by Spark.</td></tr><tr><td>starrocks.timezone</td><td>Default timezone of JVM</td><td>Supported since 1.1.1. The timezone used to convert StarRocks <code>DATETIME</code> to Spark <code>TimestampType</code>. The default is the timezone of JVM returned by <code>ZoneId#systemDefault()</code>. The format could be a timezone name such as <code>Asia/Shanghai</code>, or a zone offset such as <code>+08:00</code>.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-for-spark-sql-and-spark-dataframe">Parameters for Spark SQL and Spark DataFrame<a href="#parameters-for-spark-sql-and-spark-dataframe" class="hash-link" aria-label="Direct link to Parameters for Spark SQL and Spark DataFrame" title="Direct link to Parameters for Spark SQL and Spark DataFrame">​</a></h3>
<p>The following parameters apply only to the Spark SQL and Spark DataFrame reading methods.</p>
<table><thead><tr><th>Parameter</th><th>Default value</th><th>Description</th></tr></thead><tbody><tr><td>starrocks.fe.http.url</td><td>None</td><td>The HTTP IP address of the FE. This parameter is supported from Spark connector 1.1.0 onwards. This parameter is equivalent to <code>starrocks.fenodes</code>. You only need to configure one of them. In Spark connector 1.1.0 and later, we recommend that you use <code>starrocks.fe.http.url</code> because <code>starrocks.fenodes</code> may be deprecated.</td></tr><tr><td>starrocks.fe.jdbc.url</td><td>None</td><td>The address that is used to connect to the MySQL server of the FE. Format: <code>jdbc:mysql://&lt;fe_host&gt;:&lt;fe_query_port&gt;</code>.<br><strong>NOTICE</strong><br>In Spark connector 1.1.0 and later, this parameter is mandatory.</td></tr><tr><td>user</td><td>None</td><td>The username of your StarRocks cluster account. The user needs the <a href="/doc/docs/sql-reference/sql-statements/account-management/GRANT">SELECT privilege</a> on the StarRocks table.</td></tr><tr><td>starrocks.user</td><td>None</td><td>The username of your StarRocks cluster account. This parameter is supported from Spark connector 1.1.0 onwards. This parameter is equivalent to <code>user</code>. You only need to configure one of them. In Spark connector 1.1.0 and later, we recommend that you use <code>starrocks.user</code> because <code>user</code> may be deprecated.</td></tr><tr><td>password</td><td>None</td><td>The password of your StarRocks cluster account.</td></tr><tr><td>starrocks.password</td><td>None</td><td>The password of your StarRocks cluster account. This parameter is supported from Spark connector 1.1.0 onwards. This parameter is equivalent to <code>password</code>. You only need to configure one of them. In Spark connector 1.1.0 and later, we recommend that you use <code>starrocks.password</code> because <code>password</code> may be deprecated.</td></tr><tr><td>starrocks.filter.query.in.max.count</td><td>100</td><td>The maximum number of values supported by the IN expression during predicate pushdown. If the number of values specified in the IN expression exceeds this limit, the filter conditions specified in the IN expression are processed on Spark.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-for-spark-rdd">Parameters for Spark RDD<a href="#parameters-for-spark-rdd" class="hash-link" aria-label="Direct link to Parameters for Spark RDD" title="Direct link to Parameters for Spark RDD">​</a></h3>
<p>The following parameters apply only to the Spark RDD reading method.</p>
<table><thead><tr><th>Parameter</th><th>Default value</th><th>Description</th></tr></thead><tbody><tr><td>starrocks.request.auth.user</td><td>None</td><td>The username of your StarRocks cluster account.</td></tr><tr><td>starrocks.request.auth.password</td><td>None</td><td>The password of your StarRocks cluster account.</td></tr><tr><td>starrocks.read.field</td><td>None</td><td>The StarRocks table column from which you want to read data. You can specify multiple columns, which must be separated by a comma (,).</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-type-mapping-between-starrocks-and-spark">Data type mapping between StarRocks and Spark<a href="#data-type-mapping-between-starrocks-and-spark" class="hash-link" aria-label="Direct link to Data type mapping between StarRocks and Spark" title="Direct link to Data type mapping between StarRocks and Spark">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spark-connector-110-and-later-1">Spark connector 1.1.0 and later<a href="#spark-connector-110-and-later-1" class="hash-link" aria-label="Direct link to Spark connector 1.1.0 and later" title="Direct link to Spark connector 1.1.0 and later">​</a></h3>
<table><thead><tr><th>StarRocks data type</th><th>Spark data type</th></tr></thead><tbody><tr><td>BOOLEAN</td><td>DataTypes.BooleanType</td></tr><tr><td>TINYINT</td><td>DataTypes.ByteType</td></tr><tr><td>SMALLINT</td><td>DataTypes.ShortType</td></tr><tr><td>INT</td><td>DataTypes.IntegerType</td></tr><tr><td>BIGINT</td><td>DataTypes.LongType</td></tr><tr><td>LARGEINT</td><td>DataTypes.StringType</td></tr><tr><td>FLOAT</td><td>DataTypes.FloatType</td></tr><tr><td>DOUBLE</td><td>DataTypes.DoubleType</td></tr><tr><td>DECIMAL</td><td>DecimalType</td></tr><tr><td>CHAR</td><td>DataTypes.StringType</td></tr><tr><td>VARCHAR</td><td>DataTypes.StringType</td></tr><tr><td>STRING</td><td>DataTypes.StringType</td></tr><tr><td>DATE</td><td>DataTypes.DateType</td></tr><tr><td>DATETIME</td><td>DataTypes.TimestampType</td></tr><tr><td>ARRAY</td><td>Unsupported datatype</td></tr><tr><td>HLL</td><td>Unsupported datatype</td></tr><tr><td>BITMAP</td><td>Unsupported datatype</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="spark-connector-100-1">Spark connector 1.0.0<a href="#spark-connector-100-1" class="hash-link" aria-label="Direct link to Spark connector 1.0.0" title="Direct link to Spark connector 1.0.0">​</a></h3>
<table><thead><tr><th>StarRocks data type</th><th>Spark data type</th></tr></thead><tbody><tr><td>BOOLEAN</td><td>DataTypes.BooleanType</td></tr><tr><td>TINYINT</td><td>DataTypes.ByteType</td></tr><tr><td>SMALLINT</td><td>DataTypes.ShortType</td></tr><tr><td>INT</td><td>DataTypes.IntegerType</td></tr><tr><td>BIGINT</td><td>DataTypes.LongType</td></tr><tr><td>LARGEINT</td><td>DataTypes.StringType</td></tr><tr><td>FLOAT</td><td>DataTypes.FloatType</td></tr><tr><td>DOUBLE</td><td>DataTypes.DoubleType</td></tr><tr><td>DECIMAL</td><td>DecimalType</td></tr><tr><td>CHAR</td><td>DataTypes.StringType</td></tr><tr><td>VARCHAR</td><td>DataTypes.StringType</td></tr><tr><td>DATE</td><td>DataTypes.StringType</td></tr><tr><td>DATETIME</td><td>DataTypes.StringType</td></tr><tr><td>ARRAY</td><td>Unsupported datatype</td></tr><tr><td>HLL</td><td>Unsupported datatype</td></tr><tr><td>BITMAP</td><td>Unsupported datatype</td></tr></tbody></table>
<p>The processing logic of the underlying storage engine used by StarRocks cannot cover an expected time range when DATE and DATETIME data types are directly used. Therefore, the Spark connector maps the DATE and DATETIME data types from StarRocks to the STRING data type from Spark, and generates readable string texts matching the date and time data read from StarRocks.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-spark-connector">Upgrade Spark connector<a href="#upgrade-spark-connector" class="hash-link" aria-label="Direct link to Upgrade Spark connector" title="Direct link to Upgrade Spark connector">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-from-version-100-to-version-110">Upgrade from version 1.0.0 to version 1.1.0<a href="#upgrade-from-version-100-to-version-110" class="hash-link" aria-label="Direct link to Upgrade from version 1.0.0 to version 1.1.0" title="Direct link to Upgrade from version 1.0.0 to version 1.1.0">​</a></h3>
<ul>
<li>
<p>Since 1.1.1, the Spark connector does not provide <code>mysql-connector-java</code> which is the official JDBC driver for MySQL, because of the limitations of the GPL license used by <code>mysql-connector-java</code>.
However, the Spark connector still needs the <code>mysql-connector-java</code> to connect to StarRocks for the table metadata, so you need to add the driver to the Spark classpath manually. You can find the
driver on <a href="https://dev.mysql.com/downloads/connector/j/" target="_blank" rel="noopener noreferrer">MySQL site</a> or <a href="https://repo1.maven.org/maven2/mysql/mysql-connector-java/" target="_blank" rel="noopener noreferrer">Maven Central</a>.</p>
</li>
<li>
<p>In version 1.1.0, the Spark connector uses JDBC to access StarRocks to obtain more detailed table information. Therefore, you must configure <code>starrocks.fe.jdbc.url</code>.</p>
</li>
<li>
<p>In version 1.1.0, some parameters are renamed. Both the old and new parameters are retained for now. For each pair of equivalent parameters, you only need to configure one of them, but we recommend that you use the new one because the old one may be deprecated.</p>
<ul>
<li><code>starrocks.fenodes</code> is renamed as <code>starrocks.fe.http.url</code>.</li>
<li><code>user</code> is renamed as <code>starrocks.user</code>.</li>
<li><code>password</code> is renamed as <code>starrocks.password</code>.</li>
</ul>
</li>
<li>
<p>In version 1.1.0, the mappings of some data types are adjusted based on Spark 3.x:</p>
<ul>
<li><code>DATE</code> in StarRocks is mapped to <code>DataTypes.DateType</code> (originally <code>DataTypes.StringType</code>) in Spark.</li>
<li><code>DATETIME</code> in StarRocks is mapped to <code>DataTypes.TimestampType</code> (originally <code>DataTypes.StringType</code>) in Spark.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2>
<p>The following examples assume you have created a database named <code>test</code> in your StarRocks cluster and you have the permissions of user <code>root</code>. The parameter settings in the examples are based on Spark Connector 1.1.0.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-example">Data example<a href="#data-example" class="hash-link" aria-label="Direct link to Data example" title="Direct link to Data example">​</a></h3>
<p>Do as follows to prepare a sample table:</p>
<ol>
<li>
<p>Go to the <code>test</code> database and create a table named <code>score_board</code>.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">score_board</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">name</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">65533</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">score</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ENGINE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">OLAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OLAP&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Insert data into the <code>score_board</code> table.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> score_board</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Bob&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Stan&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Sam&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Tony&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Alice&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Lucy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Polly&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Tom&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Rose&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Jerry&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Jason&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Lily&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Stephen&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;David&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Eddie&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Kate&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">17</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Cathy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Judy&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Julia&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Robert&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Jack&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the <code>score_board</code> table.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> score_board</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+---------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> id   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> name    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> score </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+---------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Bob     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Stan    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Sam     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Tony    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Alice   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Lucy    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Polly   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Tom     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Rose    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Jerry   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Jason   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Lily    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Stephen </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> David   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Eddie   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Kate    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Cathy   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Judy    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Julia   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Robert  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Jack    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+---------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="read-data-using-spark-sql">Read data using Spark SQL<a href="#read-data-using-spark-sql" class="hash-link" aria-label="Direct link to Read data using Spark SQL" title="Direct link to Read data using Spark SQL">​</a></h3>
<ol>
<li>
<p>Run the following command in the Spark directory to start Spark SQL:</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh spark-sql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run the following command to create a temporary view named <code>spark_starrocks</code> on the <code>score_board</code> table which belongs to the <code>test</code> database:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spark</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">sql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TEMPORARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VIEW</span><span class="token plain"> spark_starrocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> starrocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           OPTIONS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&quot;starrocks.table.identifier&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test.score_board&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&quot;starrocks.fe.http.url&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&quot;starrocks.fe.jdbc.url&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jdbc:mysql://&lt;fe_host&gt;:&lt;fe_query_port&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&quot;starrocks.user&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token string" style="color:#e3116c">&quot;starrocks.password&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run the following command to read data from the temporary view:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spark</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">sql</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> spark_starrocks</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spark returns the following data:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1</span><span class="token plain">        Bob        </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain">        Stan        </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain">        Sam        </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain">        Tony        </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5</span><span class="token plain">        Alice        </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">6</span><span class="token plain">        Lucy        </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">7</span><span class="token plain">        Polly        </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">8</span><span class="token plain">        Tom        </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9</span><span class="token plain">        Rose        </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10</span><span class="token plain">        Jerry        </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">11</span><span class="token plain">        Jason        </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">12</span><span class="token plain">        Lily        </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">13</span><span class="token plain">        Stephen        </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">14</span><span class="token plain">        David        </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">15</span><span class="token plain">        Eddie        </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">16</span><span class="token plain">        Kate        </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">17</span><span class="token plain">        Cathy        </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">18</span><span class="token plain">        Judy        </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">19</span><span class="token plain">        Julia        </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">20</span><span class="token plain">        Robert        </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">21</span><span class="token plain">        Jack        </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">Time</span><span class="token plain"> taken: </span><span class="token number" style="color:#36acaa">1.883</span><span class="token plain"> seconds</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Fetched </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">09</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">29</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">36</span><span class="token plain"> INFO thriftserver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SparkSQLCLIDriver: </span><span class="token keyword" style="color:#00009f">Time</span><span class="token plain"> taken: </span><span class="token number" style="color:#36acaa">1.883</span><span class="token plain"> seconds</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Fetched </span><span class="token number" style="color:#36acaa">21</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="read-data-using-spark-dataframe">Read data using Spark DataFrame<a href="#read-data-using-spark-dataframe" class="hash-link" aria-label="Direct link to Read data using Spark DataFrame" title="Direct link to Read data using Spark DataFrame">  ​</a></h3>
<ol>
<li>
<p>Run the following command in the Spark directory to start Spark Shell:</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh spark-shell</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run the following command to create a DataFrame named <code>starrocksSparkDF</code> on the <code>score_board</code> table which belongs to the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; val starrocksSparkDF = spark.read.format(&quot;starrocks&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .option(&quot;starrocks.table.identifier&quot;, s&quot;test.score_board&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .option(&quot;starrocks.fe.http.url&quot;, s&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .option(&quot;starrocks.fe.jdbc.url&quot;, s&quot;jdbc:mysql://&lt;fe_host&gt;:&lt;fe_query_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .option(&quot;starrocks.user&quot;, s&quot;root&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .option(&quot;starrocks.password&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           .load()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Read data from the DataFrame. For example, if you want to read the first 10 rows, run the following command:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; starrocksSparkDF.show(10)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spark returns the following data:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+---+-----+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| id| name|score|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---+-----+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  1|  Bob|   21|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  2| Stan|   21|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  3|  Sam|   22|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  4| Tony|   22|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  5|Alice|   22|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  6| Lucy|   23|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  7|Polly|   23|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  8|  Tom|   23|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  9| Rose|   24|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10|Jerry|   24|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---+-----+-----+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">only showing top 10 rows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>NOTE</strong></p>
<p>By default, if you do not specify the number of rows you want to read, Spark returns the first 20 rows.</p>
</blockquote>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="read-data-using-spark-rdd">Read data using Spark RDD<a href="#read-data-using-spark-rdd" class="hash-link" aria-label="Direct link to Read data using Spark RDD" title="Direct link to Read data using Spark RDD">​</a></h3>
<ol>
<li>
<p>Run the following command in the Spark directory to start Spark Shell:</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh spark-shell</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run the following command to create an RDD named <code>starrocksSparkRDD</code> on the <code>score_board</code> table which belongs to the <code>test</code> database.</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; import com.starrocks.connector.spark._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; val starrocksSparkRDD = sc.starrocksRDD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           tableIdentifier = Some(&quot;test.score_board&quot;),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           cfg = Some(Map(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               &quot;starrocks.fenodes&quot; -&gt; &quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               &quot;starrocks.request.auth.user&quot; -&gt; &quot;root&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               &quot;starrocks.request.auth.password&quot; -&gt; &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Read data from the RDD. For example, if you want to read the first 10 elements, run the following command:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; starrocksSparkRDD.take(10)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spark returns the following data:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">res0: Array[AnyRef] = Array([1, Bob, 21], [2, Stan, 21], [3, Sam, 22], [4, Tony, 22], [5, Alice, 22], [6, Lucy, 23], [7, Polly, 23], [8, Tom, 23], [9, Rose, 24], [10, Jerry, 24])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To read the entire RDD, run the following command:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; starrocksSparkRDD.collect()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Spark returns the following data:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">res1: Array[AnyRef] = Array([1, Bob, 21], [2, Stan, 21], [3, Sam, 22], [4, Tony, 22], [5, Alice, 22], [6, Lucy, 23], [7, Polly, 23], [8, Tom, 23], [9, Rose, 24], [10, Jerry, 24], [11, Jason, 24], [12, Lily, 25], [13, Stephen, 25], [14, David, 25], [15, Eddie, 26], [16, Kate, 27], [17, Cathy, 27], [18, Judy, 27], [19, Julia, 28], [20, Robert, 28], [21, Jack, 29])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best practices" title="Direct link to Best practices">​</a></h2>
<p>When you read data from StarRocks using the Spark connector, you can use the <code>starrocks.filter.query</code> parameter to specify filter conditions based on which Spark prunes partitions, buckets, and prefix indexes to reduce the cost of data pulling. This section uses Spark DataFrame as an example to show how this is achieved.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-setup">Environment setup<a href="#environment-setup" class="hash-link" aria-label="Direct link to Environment setup" title="Direct link to Environment setup">​</a></h3>
<table><thead><tr><th>Component</th><th>Version</th></tr></thead><tbody><tr><td>Spark</td><td>Spark 2.4.4 and Scala 2.11.12 (OpenJDK 64-Bit Server VM, Java 1.8.0_302)</td></tr><tr><td>StarRocks</td><td>2.2.0</td></tr><tr><td>Spark connector</td><td>starrocks-spark2_2.11-1.0.0.jar</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-example-1">Data example<a href="#data-example-1" class="hash-link" aria-label="Direct link to Data example" title="Direct link to Data example">​</a></h3>
<p>Do as follows to prepare a sample table:</p>
<ol>
<li>
<p>Go to the <code>test</code> database and create a table named  <code>mytable</code>.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">mytable</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;bucket&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">b</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">datetime</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">v</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ENGINE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">OLAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DUPLICATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">b</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OLAP&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> RANGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p202201 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2022-01-01 00:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2022-02-01 00:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p202202 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2022-02-01 00:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2022-03-01 00:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> p202203 </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2022-03-01 00:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;2022-04-01 00:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Insert data into <code>mytable</code>.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> mytable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2022-01-02 08:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">111</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2022-02-02 08:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">222</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2022-03-02 08:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">333</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the <code>mytable</code> table.</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mytable</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+------+---------------------+------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> k    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> b    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> dt                  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> v    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+------+---------------------+------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">08</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">111</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">08</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">222</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">33</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">02</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">08</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">333</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+------+---------------------+------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-table-scan">Full table scan<a href="#full-table-scan" class="hash-link" aria-label="Direct link to Full table scan" title="Direct link to Full table scan">​</a></h3>
<ol>
<li>
<p>Run the following command in the Spark directory to create a DataFrame named <code>df</code> on <code>mytable</code> table which belongs to the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt;  val df = spark.read.format(&quot;starrocks&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .option(&quot;starrocks.table.identifier&quot;, s&quot;test.mytable&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .option(&quot;starrocks.fenodes&quot;, s&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .option(&quot;user&quot;, s&quot;root&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .option(&quot;password&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .load()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>View the FE log file <strong>fe.log</strong> of your StarRocks cluster, and find the SQL statement executed to read data. Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">09</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">57</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">091</span><span class="token plain"> INFO </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nioEventLoopGroup</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token operator" style="color:#393A34">|</span><span class="token number" style="color:#36acaa">196</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">TableQueryPlanAction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeWithoutPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">126</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> receive </span><span class="token keyword" style="color:#00009f">SQL</span><span class="token plain"> statement </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">b</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">v</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">test</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">mytable</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> external service </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">database</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mytable</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In the <code>test</code> database, use EXPLAIN to obtain the execution plan of the SELECT <code>k</code>,<code>b</code>,<code>dt</code>,<code>v</code> from <code>test</code>.<code>mytable</code> statement:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL [test]&gt; EXPLAIN select `k`,`b`,`dt`,`v` from `test`.`mytable`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Explain String                                                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 0                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:1: k | 2: b | 3: dt | 4: v                              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: UNPARTITIONED                                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   RESULT SINK                                                         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   1:EXCHANGE                                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 1                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:                                                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: RANDOM                                                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   STREAM DATA SINK                                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     EXCHANGE ID: 01                                                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     UNPARTITIONED                                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   0:OlapScanNode                                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      TABLE: mytable                                                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREAGGREGATION: ON                                               |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      partitions=3/3                                                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      rollup: mytable                                                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletRatio=9/9                                                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletList=41297,41299,41301,41303,41305,41307,41309,41311,41313 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      cardinality=3                                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      avgRowSize=4.0                                                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      numNodes=0                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">26 rows in set (0.00 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>In this example, no pruning is performed. Therefore, Spark scans all of the three partitions (as suggested by <code>partitions=3/3</code>) that hold data, and scans all of the 9 tablets (as suggested by <code>tabletRatio=9/9</code>) in those three partitions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="partition-pruning">Partition pruning<a href="#partition-pruning" class="hash-link" aria-label="Direct link to Partition pruning" title="Direct link to Partition pruning">​</a></h3>
<ol>
<li>
<p>Run the following command, in which you use the <code>starrocks.filter.query</code> parameter to specify a filter condition <code>dt=&#x27;2022-01-02 08:00:00</code> for partition pruning, in the Spark directory to create a DataFrame named <code>df</code> on the <code>mytable</code> table which belongs to the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; val df = spark.read.format(&quot;starrocks&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.table.identifier&quot;, s&quot;test.mytable&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.fenodes&quot;, s&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;user&quot;, s&quot;root&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;password&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.filter.query&quot;, &quot;dt=&#x27;2022-01-02 08:00:00&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .load()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>View the FE log file <strong>fe.log</strong> of your StarRocks cluster, and find the SQL statement executed to read data. Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">09</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">02</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">253</span><span class="token plain"> INFO </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nioEventLoopGroup</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">14</span><span class="token operator" style="color:#393A34">|</span><span class="token number" style="color:#36acaa">204</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">TableQueryPlanAction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeWithoutPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">126</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> receive </span><span class="token keyword" style="color:#00009f">SQL</span><span class="token plain"> statement </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">b</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">v</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">test</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">mytable</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> dt</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;2022-01-02 08:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> external service </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">database</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mytable</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In the <code>test</code> database, use EXPLAIN to obtain the execution plan of the SELECT <code>k</code>,<code>b</code>,<code>dt</code>,<code>v</code> from <code>test</code>.<code>mytable</code> where dt=&#x27;2022-01-02 08:00:00&#x27; statement:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL [test]&gt; EXPLAIN select `k`,`b`,`dt`,`v` from `test`.`mytable` where dt=&#x27;2022-01-02 08:00:00&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Explain String                                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 0                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:1: k | 2: b | 3: dt | 4: v       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: UNPARTITIONED                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   RESULT SINK                                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   1:EXCHANGE                                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 1                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:                                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: RANDOM                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   STREAM DATA SINK                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     EXCHANGE ID: 01                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     UNPARTITIONED                              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   0:OlapScanNode                               |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      TABLE: mytable                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREAGGREGATION: ON                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREDICATES: 3: dt = &#x27;2022-01-02 08:00:00&#x27; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      partitions=1/3                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      rollup: mytable                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletRatio=3/3                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletList=41297,41299,41301              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      cardinality=1                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      avgRowSize=20.0                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      numNodes=0                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">27 rows in set (0.01 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>In this example, only partition pruning is performed, whereas bucket pruning is not. Therefore, Spark scans one of the three partitions (as suggested by <code>partitions=1/3</code>) and all of the tablets (as suggested by <code>tabletRatio=3/3</code>) in that partition.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bucket-pruning">Bucket pruning<a href="#bucket-pruning" class="hash-link" aria-label="Direct link to Bucket pruning" title="Direct link to Bucket pruning">​</a></h3>
<ol>
<li>
<p>Run the following command, in which you use the <code>starrocks.filter.query</code> parameter to specify a filter condition <code>k=1</code> for bucket pruning, in the Spark directory to create a DataFrame named <code>df</code> on the <code>mytable</code> table which belongs to the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; val df = spark.read.format(&quot;starrocks&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.table.identifier&quot;, s&quot;test.mytable&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.fenodes&quot;, s&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;user&quot;, s&quot;root&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;password&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.filter.query&quot;, &quot;k=1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .load()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>View the FE log file  <strong>fe.log</strong> of your StarRocks cluster, and find the SQL statement executed to read data. Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">09</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">04</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">44</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">479</span><span class="token plain"> INFO </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nioEventLoopGroup</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">16</span><span class="token operator" style="color:#393A34">|</span><span class="token number" style="color:#36acaa">208</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">TableQueryPlanAction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeWithoutPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">126</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> receive </span><span class="token keyword" style="color:#00009f">SQL</span><span class="token plain"> statement </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">b</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">v</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">test</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">mytable</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> external service </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">database</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mytable</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In the <code>test</code> database, use EXPLAIN to obtain the execution plan of the SELECT <code>k</code>,<code>b</code>,<code>dt</code>,<code>v</code> from <code>test</code>.<code>mytable</code> where k=1 statement:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL [test]&gt; EXPLAIN select `k`,`b`,`dt`,`v` from `test`.`mytable` where k=1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Explain String                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 0                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:1: k | 2: b | 3: dt | 4: v |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: UNPARTITIONED               |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   RESULT SINK                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   1:EXCHANGE                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 1                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: RANDOM                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   STREAM DATA SINK                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     EXCHANGE ID: 01                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     UNPARTITIONED                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   0:OlapScanNode                         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      TABLE: mytable                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREAGGREGATION: ON                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREDICATES: 1: k = 1                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      partitions=3/3                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      rollup: mytable                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletRatio=3/9                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletList=41299,41305,41311        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      cardinality=1                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      avgRowSize=20.0                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      numNodes=0                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">27 rows in set (0.01 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>In this example, only bucket pruning is performed, whereas partition pruning is not. Therefore, Spark scans all of the three partitions (as suggested by <code>partitions=3/3</code>) that hold data, and scans all of the three tablets (as suggested by <code>tabletRatio=3/9</code>) to retrieve Hash values that meet the <code>k = 1</code> filter condition within those three partitions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="partition-pruning-and-bucket-pruning">Partition pruning and bucket pruning<a href="#partition-pruning-and-bucket-pruning" class="hash-link" aria-label="Direct link to Partition pruning and bucket pruning" title="Direct link to Partition pruning and bucket pruning">​</a></h3>
<ol>
<li>
<p>Run the following command, in which you use the <code>starrocks.filter.query</code> parameter to specify two filter conditions <code>k=7</code> and <code>dt=&#x27;2022-01-02 08:00:00&#x27;</code> for bucket pruning and partition pruning, in the Spark directory to create a DataFrame named <code>df</code> on the <code>mytable</code> table on the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; val df = spark.read.format(&quot;starrocks&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.table.identifier&quot;, s&quot;test.mytable&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.fenodes&quot;, s&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;user&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;password&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.filter.query&quot;, &quot;k=7 and dt=&#x27;2022-01-02 08:00:00&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .load()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>View the FE log file <strong>fe.log</strong> of your StarRocks cluster, and find the SQL statement executed to read data. Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">09</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">06</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">34</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">939</span><span class="token plain"> INFO </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nioEventLoopGroup</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token operator" style="color:#393A34">|</span><span class="token number" style="color:#36acaa">212</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">TableQueryPlanAction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">executeWithoutPassword</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">126</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> receive </span><span class="token keyword" style="color:#00009f">SQL</span><span class="token plain"> statement </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">k</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">b</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">v</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">test</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">.</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">mytable</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> k</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> dt</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;2022-01-02 08:00:00&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> external service </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">database</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">able </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mytable</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In the <code>test</code> database, use EXPLAIN to obtain the execution plan of the SELECT <code>k</code>,<code>b</code>,<code>dt</code>,<code>v</code> from <code>test</code>.<code>mytable</code> where k=7 and dt=&#x27;2022-01-02 08:00:00&#x27; statement:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL [test]&gt; EXPLAIN select `k`,`b`,`dt`,`v` from `test`.`mytable` where k=7 and dt=&#x27;2022-01-02 08:00:00&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Explain String                                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PLAN FRAGMENT 0                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  OUTPUT EXPRS:1: k | 2: b | 3: dt | 4: v                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   PARTITION: RANDOM                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   RESULT SINK                                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   0:OlapScanNode                                         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      TABLE: mytable                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREAGGREGATION: ON                                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      PREDICATES: 1: k = 7, 3: dt = &#x27;2022-01-02 08:00:00&#x27; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      partitions=1/3                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      rollup: mytable                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletRatio=1/3                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      tabletList=41301                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      cardinality=1                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      avgRowSize=20.0                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      numNodes=0                                          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">17 rows in set (0.00 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>In this example, both partition pruning and bucket pruning are performed. Therefore, Spark scans only one of the three partitions (as suggested by <code>partitions=1/3</code>) and only one tablet (as suggested by <code>tabletRatio=1/3</code>) in that partition.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prefix-index-filtering">Prefix index filtering<a href="#prefix-index-filtering" class="hash-link" aria-label="Direct link to Prefix index filtering" title="Direct link to Prefix index filtering">​</a></h3>
<ol>
<li>
<p>Insert more data records into a partition of the <code>mytable</code> table which belongs to the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL [test]&gt; INSERT INTO mytable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VALUES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (1, 11, &quot;2022-01-02 08:00:00&quot;, 111), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (3, 33, &quot;2022-01-02 08:00:00&quot;, 333), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (3, 33, &quot;2022-01-02 08:00:00&quot;, 333), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (3, 33, &quot;2022-01-02 08:00:00&quot;, 333);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the <code>mytable</code> table:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL [test]&gt; SELECT * FROM mytable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+------+---------------------+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| k    | b    | dt                  | v    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+------+---------------------+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    1 |   11 | 2022-01-02 08:00:00 |  111 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    1 |   11 | 2022-01-02 08:00:00 |  111 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    3 |   33 | 2022-01-02 08:00:00 |  333 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    3 |   33 | 2022-01-02 08:00:00 |  333 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    3 |   33 | 2022-01-02 08:00:00 |  333 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    2 |   22 | 2022-02-02 08:00:00 |  222 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|    3 |   33 | 2022-03-02 08:00:00 |  333 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+------+---------------------+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7 rows in set (0.01 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run the following command, in which you use the <code>starrocks.filter.query</code> parameter to specify a filter condition <code>k=1</code> for prefix index filtering, in the Spark directory to create a DataFrame named <code>df</code> on the <code>mytable</code> table which belongs to the <code>test</code> database:</p>
<div class="language-Scala language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">scala&gt; val df = spark.read.format(&quot;starrocks&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.table.identifier&quot;, s&quot;test.mytable&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.fenodes&quot;, s&quot;&lt;fe_host&gt;:&lt;fe_http_port&gt;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;user&quot;, s&quot;root&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;password&quot;, s&quot;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .option(&quot;starrocks.filter.query&quot;, &quot;k=1&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .load()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>In the <code>test</code> database, set <code>is_report_success</code> to <code>true</code> to enable profile reporting:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> is_report_success </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query OK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Use a browser to open the <code>http://&lt;fe_host&gt;:&lt;http_http_port&gt;/query</code> page, and view the profile of the SELECT * FROM mytable where k=1 statement. Example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OLAP_SCAN </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan_node_id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CommonMetrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> CloseTime: </span><span class="token number" style="color:#36acaa">1.255</span><span class="token plain">ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> OperatorTotalTime: </span><span class="token number" style="color:#36acaa">1.404</span><span class="token plain">ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PeakMemoryUsage: </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PullChunkNum: </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PullRowNum: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_PullRowNum: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_PullRowNum: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PullTotalTime: </span><span class="token number" style="color:#36acaa">148.60</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PushChunkNum: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PushRowNum: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PushTotalTime: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> SetFinishedTime: </span><span class="token number" style="color:#36acaa">136</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> SetFinishingTime: </span><span class="token number" style="color:#36acaa">129</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UniqueMetrics:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Predicates: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> Rollup: mytable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Table</span><span class="token plain">: mytable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BytesRead: </span><span class="token number" style="color:#36acaa">88.00</span><span class="token plain"> B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_BytesRead: </span><span class="token number" style="color:#36acaa">88.00</span><span class="token plain"> B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_BytesRead: </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> CachedPagesNum: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> CompressedBytesRead: </span><span class="token number" style="color:#36acaa">844.00</span><span class="token plain"> B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_CompressedBytesRead: </span><span class="token number" style="color:#36acaa">844.00</span><span class="token plain"> B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_CompressedBytesRead: </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> CreateSegmentIter: </span><span class="token number" style="color:#36acaa">18.582</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> IOTime: </span><span class="token number" style="color:#36acaa">4.425</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> LateMaterialize: </span><span class="token number" style="color:#36acaa">17.385</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PushdownPredicates: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> RawRowsRead: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_RawRowsRead: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_RawRowsRead: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> ReadPagesNum: </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_ReadPagesNum: </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_ReadPagesNum: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> RowsRead: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_RowsRead: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_RowsRead: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> ScanTime: </span><span class="token number" style="color:#36acaa">154.367</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> SegmentInit: </span><span class="token number" style="color:#36acaa">95.903</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BitmapIndexFilter: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BitmapIndexFilterRows: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BloomFilterFilterRows: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> ShortKeyFilterRows: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_ShortKeyFilterRows: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_ShortKeyFilterRows: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> ZoneMapIndexFilterRows: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> SegmentRead: </span><span class="token number" style="color:#36acaa">2.559</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BlockFetch: </span><span class="token number" style="color:#36acaa">2.187</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BlockFetchCount: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_BlockFetchCount: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_BlockFetchCount: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BlockSeek: </span><span class="token number" style="color:#36acaa">7.789</span><span class="token plain">us</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> BlockSeekCount: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_BlockSeekCount: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_BlockSeekCount: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> ChunkCopy: </span><span class="token number" style="color:#36acaa">25</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> DecompressT: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> DelVecFilterRows: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> IndexLoad: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PredFilter: </span><span class="token number" style="color:#36acaa">353</span><span class="token plain">ns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> PredFilterRows: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> RowsetsReadCount: </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> SegmentsReadCount: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_SegmentsReadCount: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_SegmentsReadCount: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> TotalColumnsDataPageCount: </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_TotalColumnsDataPageCount: </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_TotalColumnsDataPageCount: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> UncompressedBytesRead: </span><span class="token number" style="color:#36acaa">508.00</span><span class="token plain"> B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MAX_OF_UncompressedBytesRead: </span><span class="token number" style="color:#36acaa">508.00</span><span class="token plain"> B</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> __MIN_OF_UncompressedBytesRead: </span><span class="token number" style="color:#36acaa">0.00</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>In this example, the filter condition <code>k = 1</code> can hit the prefix index. Therefore, Spark can filter out three rows (as suggested by <code>ShortKeyFilterRows: 3</code>).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/StarRocks/starrocks/edit/main/docs/unloading/Spark_connector.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc/docs/unloading/Export"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Export data using EXPORT</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/doc/docs/unloading/Flink_connector"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Read data from StarRocks using Flink connector</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#usage-notes" class="table-of-contents__link toc-highlight">Usage notes</a></li><li><a href="#version-requirements" class="table-of-contents__link toc-highlight">Version requirements</a></li><li><a href="#obtain-spark-connector" class="table-of-contents__link toc-highlight">Obtain Spark connector</a><ul><li><a href="#spark-connector-110-and-later" class="table-of-contents__link toc-highlight">Spark connector 1.1.0 and later</a></li><li><a href="#spark-connector-100" class="table-of-contents__link toc-highlight">Spark connector 1.0.0</a></li></ul></li><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a><ul><li><a href="#common-parameters" class="table-of-contents__link toc-highlight">Common parameters</a></li><li><a href="#parameters-for-spark-sql-and-spark-dataframe" class="table-of-contents__link toc-highlight">Parameters for Spark SQL and Spark DataFrame</a></li><li><a href="#parameters-for-spark-rdd" class="table-of-contents__link toc-highlight">Parameters for Spark RDD</a></li></ul></li><li><a href="#data-type-mapping-between-starrocks-and-spark" class="table-of-contents__link toc-highlight">Data type mapping between StarRocks and Spark</a><ul><li><a href="#spark-connector-110-and-later-1" class="table-of-contents__link toc-highlight">Spark connector 1.1.0 and later</a></li><li><a href="#spark-connector-100-1" class="table-of-contents__link toc-highlight">Spark connector 1.0.0</a></li></ul></li><li><a href="#upgrade-spark-connector" class="table-of-contents__link toc-highlight">Upgrade Spark connector</a><ul><li><a href="#upgrade-from-version-100-to-version-110" class="table-of-contents__link toc-highlight">Upgrade from version 1.0.0 to version 1.1.0</a></li></ul></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href="#data-example" class="table-of-contents__link toc-highlight">Data example</a></li><li><a href="#read-data-using-spark-sql" class="table-of-contents__link toc-highlight">Read data using Spark SQL</a></li><li><a href="#read-data-using-spark-dataframe" class="table-of-contents__link toc-highlight">Read data using Spark DataFrame</a></li><li><a href="#read-data-using-spark-rdd" class="table-of-contents__link toc-highlight">Read data using Spark RDD</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best practices</a><ul><li><a href="#environment-setup" class="table-of-contents__link toc-highlight">Environment setup</a></li><li><a href="#data-example-1" class="table-of-contents__link toc-highlight">Data example</a></li><li><a href="#full-table-scan" class="table-of-contents__link toc-highlight">Full table scan</a></li><li><a href="#partition-pruning" class="table-of-contents__link toc-highlight">Partition pruning</a></li><li><a href="#bucket-pruning" class="table-of-contents__link toc-highlight">Bucket pruning</a></li><li><a href="#partition-pruning-and-bucket-pruning" class="table-of-contents__link toc-highlight">Partition pruning and bucket pruning</a></li><li><a href="#prefix-index-filtering" class="table-of-contents__link toc-highlight">Prefix index filtering</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc/docs/introduction/StarRocks_intro">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 StarRocks, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>