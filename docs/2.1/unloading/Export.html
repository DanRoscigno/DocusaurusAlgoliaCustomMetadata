<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-2.1 docs-doc-page docs-doc-id-unloading/Export" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-beta.0">
<title data-rh="true">Export Overview | StarRocks</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://danroscigno.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://danroscigno.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://danroscigno.github.io/docs/2.1/unloading/Export"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="2.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.1"><meta data-rh="true" name="docsearch:version" content="2.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.1"><meta data-rh="true" property="og:title" content="Export Overview | StarRocks"><meta data-rh="true" name="description" content="Data Export is a feature to export and store data to other storage media. It can export data from user-specified tables or partitions in text format to remote storage such as HDFS/AliCloud OSS/AWS S3 (or S3 protocol-compatible object storage) via Broker."><meta data-rh="true" property="og:description" content="Data Export is a feature to export and store data to other storage media. It can export data from user-specified tables or partitions in text format to remote storage such as HDFS/AliCloud OSS/AWS S3 (or S3 protocol-compatible object storage) via Broker."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danroscigno.github.io/docs/2.1/unloading/Export"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/docs/2.1/unloading/Export" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/zh/docs/2.1/unloading/Export" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/docs/2.1/unloading/Export" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ER08SJMRY1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="StarRocks" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.62f01ed5.css">
<script src="/assets/js/runtime~main.3ec76a3f.js" defer="defer"></script>
<script src="/assets/js/main.bda7b85e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.starrocks.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">StarRocks</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/2.1/administration/Authentication">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/2.1/administration/Authentication">2.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/examples/introduction">Next</a></li><li><a class="dropdown__link" href="/docs/unloading/Export">Latest-3.1</a></li><li><a class="dropdown__link" href="/docs/3.0/unloading/Export">3.0</a></li><li><a class="dropdown__link" href="/docs/2.5/unloading/Export">Stable-2.5</a></li><li><a class="dropdown__link" href="/docs/2.3/unloading/Export">2.3</a></li><li><a class="dropdown__link" href="/docs/2.2/unloading/Export">2.2</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2.1/unloading/Export">2.1</a></li><li><a class="dropdown__link" href="/docs/2.0/unloading/Export">2.0</a></li><li><a class="dropdown__link" href="/docs/1.19/development/Build_in_docker">1.19</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/2.1/unloading/Export" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li><li><a href="/zh/docs/2.1/unloading/Export" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/StarRocks/starrocks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/administration/Authentication">administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/benchmarking/SSB_Benchmarking">benchmarking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/faq/Deploy_faq">faq</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/introduction/StarRocks_intro">introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/loading/BrokerLoad">loading</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/2.1/quick_start">quick_start</a><button aria-label="Expand sidebar category &#x27;quick_start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/reference/Error_code">reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/release_notes/release-1.19">release_notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/sql-reference/sql-functions/How_to_Write_Functions_Documentation">sql-reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/2.1/table_design">Introduction</a><button aria-label="Expand sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/2.1/unloading/Export">unloading</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2.1/unloading/Export">Export Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.1/unloading/Flink_connector">Use Flink connector to read data from StarRocks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.1/unloading/Spark_connector">Spark StarRocks Connector</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/2.1/using_starrocks/Array">using_starrocks</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">unloading</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Export Overview</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Export Overview</h1>
<p>Data Export is a feature to export and store data to other storage media. It can export data from user-specified tables or partitions in <strong>text</strong> format to remote storage such as HDFS/AliCloud OSS/AWS S3 (or S3 protocol-compatible object storage) via Broker.</p>
<p>This chapter introduces the basic principles, usage, best practices and considerations of StarRocks data export.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-of-terms">Explanation of Terms<a href="#explanation-of-terms" class="hash-link" aria-label="Direct link to Explanation of Terms" title="Direct link to Explanation of Terms">​</a></h2>
<ul>
<li><strong>Broker</strong>: StarRocks can perform file operations on remote storage via Broker.</li>
<li><strong>Tablet</strong>: Data partitioning. A table will be divided into one or more partitions, and each partition will be divided into multiple data shards.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="principle">Principle<a href="#principle" class="hash-link" aria-label="Direct link to Principle" title="Direct link to Principle">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="export-job-execution-process">Export Job Execution Process<a href="#export-job-execution-process" class="hash-link" aria-label="Direct link to Export Job Execution Process" title="Direct link to Export Job Execution Process">​</a></h3>
<p>After a user submits an <strong>export job</strong>, StarRocks counts all the Tablets involved in the job and then <strong>groups</strong> the Tablets. Each group generates a special query plan that reads and writes the data to the path specified by the remote storage via Broker.</p>
<p>The overall processing flow of the export job is as follows:</p>
<p><img loading="lazy" alt="asset" src="/assets/images/5.3.1-1-682b6dbafbc8c86e423ff8729cb10a88.png" width="1738" height="924" class="img_ev3q"></p>
<p>The processing flow described in the above diagram consists of the following steps:</p>
<ol>
<li>
<p>The user submits an export job to the FE.</p>
</li>
<li>
<p>The FE&#x27;s export scheduler executes the export job in two stages.</p>
<p>a. PENDING: The FE generates <strong>one</strong> ExportPendingTask, sends a snapshot command to the BE, takes a snapshot of all the involved tablets, and generates <strong>multiple</strong> query plans.</p>
</li>
</ol>
<p>b. EXPORTING: The FE generates <strong>one</strong> ExportExportingTask and starts executing <strong>one</strong> query plan.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-plan-splitting">Query Plan Splitting<a href="#query-plan-splitting" class="hash-link" aria-label="Direct link to Query Plan Splitting" title="Direct link to Query Plan Splitting">​</a></h3>
<p>The Export job generates multiple query plans, each of which is responsible for scanning a portion of the Tablet. The amount of data scanned by each BE is calculated by the <code>export_max_bytes_per_be_per_task</code> parameter(256M by default). Each BE has at least one tablet to scan, and the maximum amount of exported data does not exceed the value of <code>export_max_bytes_per_be_per_task</code>.</p>
<p>Multiple query plans for a job <strong>execute in parallel</strong>. The size of the job thread pool is configured via the <code>export_task_pool_size</code> parameter (defaults to 5).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-plan-execution">Query Plan Execution<a href="#query-plan-execution" class="hash-link" aria-label="Direct link to Query Plan Execution" title="Direct link to Query Plan Execution">​</a></h3>
<p>When executed, a query plan scans multiple tablets, reads data into batches each of which contains 1024 rows, and then calls the broker to write it to the remote storage.</p>
<p>A query plan will automatically retry three times when encountering an error. If it still fails after three retries, the entire job fails.</p>
<p>StarRocks will first create a temporary directory named <code>__starrocks_export_tmp_921d8f80-7c9d-11eb-9342-acde48001122</code> in the specified remote storage path (where <code>921d8f80-7c9d-11eb-9342- acde48001122</code> is the query id of the job). The exported data is first written to this temporary directory. Each query plan will generate a file (see example below):</p>
<p><code>lineorder_921d8f80-7c9d-11eb-9342-acde48001122_1_2_0.csv.1615471540361</code></p>
<p>where :</p>
<ul>
<li><code>lineorder_</code>: The prefix of the export file, specified by the user, with a default value of <code>data_</code>.</li>
<li><code>921d8f80-7c9d-11eb-9342-acde48001122</code>: The query id of the job, which is included by default, and can be excluded by setting <code>include_query_id = false</code>.</li>
<li><code>1_2_0</code>: The first part is the serial number of the <strong>query plan</strong> corresponding to the job, the second part is the serial number of the <strong>instance</strong> in the job, and the third part is the serial number of the <strong>generated file</strong> in the instance.</li>
<li><code>csv</code>: The export file format. Currently, only the csv format is supported.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="broker-parameters">Broker Parameters<a href="#broker-parameters" class="hash-link" aria-label="Direct link to Broker Parameters" title="Direct link to Broker Parameters">​</a></h4>
<p>The export job needs to access the remote storage via Broker. Each Broker needs different parameters, see the Broker documentation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-examples">Usage Examples<a href="#usage-examples" class="hash-link" aria-label="Direct link to Usage Examples" title="Direct link to Usage Examples">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="submit-an-export-job">Submit an Export Job<a href="#submit-an-export-job" class="hash-link" aria-label="Direct link to Submit an Export Job" title="Direct link to Submit an Export Job">​</a></h4>
<p>Example:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">EXPORT </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> db1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tbl1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">PARTITION</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">p2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hdfs://host/path/to/export/lineorder_&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;column_separator&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;exec_mem_limit&quot;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;2147483648&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;timeout&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3600&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WITH</span><span class="token plain"> BROKER </span><span class="token string" style="color:#e3116c">&quot;hdfs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;username&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;password&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;passwd&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the export path is specified to a directory, you need to specify the last <code>/</code>, otherwise the last part will be used as the prefix of the export file. The default is <code>data_</code> if no prefix is specified.
The export file in the example will be generated to the export directory with the prefix <code>lineorder_</code>.</p>
<p>PROPERTIES are as follows:</p>
<ul>
<li><code>column_separator</code>: Column separator, defaults to <code>\t</code>.</li>
<li><code>line_delimiter</code>: Row separator, defaults to <code>\n</code>.</li>
<li><code>exec_mem_limit</code>: Indicate the memory usage limit for <strong>a query plan</strong> on <strong>a single BE</strong> in an Export job. Default to 2GB, in bytes.</li>
<li><code>timeout</code>: Job timeout time. Default to 2 hours, in seconds.</li>
<li><code>include_query_id</code>: Whether to include the query id in the export file name. Default to true.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-export-job-query-id">Get Export Job Query ID<a href="#get-export-job-query-id" class="hash-link" aria-label="Direct link to Get Export Job Query ID" title="Direct link to Get Export Job Query ID">​</a></h3>
<p>After submitting a job, you can get the query id of the exported job by <code>SELECT LAST_QUERY_ID()</code>, and you can view or cancel the job using the query id.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="view-export-job-status">View Export Job Status<a href="#view-export-job-status" class="hash-link" aria-label="Direct link to View Export Job Status" title="Direct link to View Export Job Status">​</a></h3>
<p>After submitting a job, you can view the job status by <code>SHOW EXPORT</code>.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> EXPORT </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> queryid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;921d8f80-7c9d-11eb-9342-acde48001122&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The export results are as follows:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     JobId: </span><span class="token number" style="color:#36acaa">14008</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     State: FINISHED</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Progress: </span><span class="token number" style="color:#36acaa">100</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TaskInfo: {</span><span class="token string" style="color:#e3116c">&quot;partitions&quot;</span><span class="token plain">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;exec mem limit&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">2147483648</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;column separator&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;line delimiter&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;tablet num&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;broker&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;hdfs&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;coord num&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;db&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;default_cluster:db1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;tbl&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;tbl3&quot;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Path: oss:</span><span class="token comment" style="color:#999988;font-style:italic">//bj-test/export/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CreateTime: </span><span class="token number" style="color:#36acaa">2019</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">06</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">08</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> StartTime: </span><span class="token number" style="color:#36acaa">2019</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">06</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">08</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">28</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FinishTime: </span><span class="token number" style="color:#36acaa">2019</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">06</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">08</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">34</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Timeout: </span><span class="token number" style="color:#36acaa">3600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ErrorMsg: N</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>JobId: the unique ID of the job</p>
</li>
<li>
<p>State: the status of the job.</p>
<ul>
<li>PENDING: Job is pending</li>
<li>EXPORTING: data export in progress</li>
<li>FINISHED: Job succeeded</li>
<li>CANCELLED: Job failed</li>
</ul>
</li>
<li>
<p>PROGRESS: The progress of the job. The progress is measured in query plans. Suppose there are 10 query plans, and 3 have been completed, then the progress is 30%.</p>
</li>
<li>
<p>TaskInfo: Job information in JSON format.</p>
<ul>
<li>db: Database name</li>
<li>tbl: Table name</li>
<li>partitions: The partitions to export. <code>*</code> means all partitions.</li>
<li>exec mem limit: The memory usage limit of the query, in bytes.</li>
<li>column separator: The column separator of the export file.</li>
<li>line delimiter: The line separator of the exported file.</li>
<li>tablet num: The total number of tablets involved.</li>
<li>broker: The name of the broker used.</li>
<li>coord num: The number of query plans.</li>
</ul>
</li>
<li>
<p>Path: Path of the export on the remote storage.</p>
</li>
<li>
<p>CreateTime/StartTime/FinishTime: The creation time, start time, and end time of the job.</p>
</li>
<li>
<p>Timeout: Timeout time of the job, in seconds. This time is calculated from CreateTime.</p>
</li>
<li>
<p>ErrorMsg: If the job has an error, the reason for the error is displayed here.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cancellation-of-jobs">Cancellation of Jobs<a href="#cancellation-of-jobs" class="hash-link" aria-label="Direct link to Cancellation of Jobs" title="Direct link to Cancellation of Jobs">​</a></h4>
<p>Examples:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CANCEL EXPORT </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> queryid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;921d8f80-7c9d-11eb-9342-acde48001122&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-plan-splitting-1">Query Plan Splitting<a href="#query-plan-splitting-1" class="hash-link" aria-label="Direct link to Query Plan Splitting" title="Direct link to Query Plan Splitting">​</a></h4>
<p>The number of query plans that need to be executed for an Export job depends on the total number of tablets and the maximum amount of data a query plan can handle.
Jobs are retried according to query plans. If a query plan handles a larger amount of data, retry costs due to query plan errors (e.g., failed RPC calls to Broker, jitter in remote storage, etc.) are higher. Each query plan has at least one tablet per BE, and the amount of exported data cannot exceed the <code>export_max_bytes_per_be_per_task</code> parameter being configured.</p>
<p>Multiple query plans for a job are executed in parallel, and the size of the job thread pool is configured via the <code>export_task_pool_size</code> parameter, which defaults to 5.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="exec_mem_limit">exec_mem_limit<a href="#exec_mem_limit" class="hash-link" aria-label="Direct link to exec_mem_limit" title="Direct link to exec_mem_limit">​</a></h4>
<p>Usually the query plan of an export job has only two parts – <code>scan</code> and <code>export</code>, which does not involve much memory-intensive computation logic. Therefore  the default memory limit of 2GB can mostly meet the demand. However, in some scenarios, such as when a query plan requires too many scanned tablets on the same BE or too many data versions of the tablets, it may lead to insufficient memory. In that case, you need to modify this parameter to set a larger memory, such as 4GB, 8GB, etc.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="notes">Notes<a href="#notes" class="hash-link" aria-label="Direct link to Notes" title="Direct link to Notes">​</a></h3>
<ul>
<li>It is not recommended to export a large amount of data at once. The recommended export size for an export job is tens of GB, and oversized exports can result in an increase in junk files and retry costs.</li>
<li>If the table data volume is too large, it is recommended to export by partition.</li>
<li>If the FE reboots or changes the leader while the export job is running, the export job will fail and require the user to resubmit.</li>
<li>The <code>__starrocks_export_tmp_xxx</code> temporary directory generated by the export job will be deleted automatically after the job fails or succeeds.</li>
<li>After the export run completes (successfully or unsuccessfully) and the FE reboots or changes the leader, some job information displayed by <code>SHOW EXPORT</code> will be lost.</li>
<li>The export job will only export data from the base table, not from the Rollup Index.</li>
<li>The export job scans the data and consumes IO resources, which may affect the query latency of the system.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="related-configurations">Related configurations<a href="#related-configurations" class="hash-link" aria-label="Direct link to Related configurations" title="Direct link to Related configurations">​</a></h3>
<p>Mainly describes the related configurations in FE.</p>
<ul>
<li><code>export_checker_interval_second</code>: The scheduling interval of the export job scheduler, default to 5 seconds. To set this parameter, you need to restart the FE.</li>
<li><code>export_running_job_num_limit</code>: The limit number of running export jobs. If exceeded, the job will wait and be in the PENDING state. Defaults to 5. Can be adjusted at runtime.</li>
<li><code>export_task_default_timeout_second</code>: Default timeout for export jobs. Defaults to 2 hours. Can be adjusted at runtime.</li>
<li><code>export_max_bytes_per_be_per_task</code>: Maximum amount of data exported per export job on each BE. This parameter is used to split export jobs for parallel processing, and is calculated based on compressed data volume with a default value of 256M.</li>
<li><code>export_task_pool_size</code>: The size of the export job thread pool. Defaults to 5.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/StarRocks/starrocks/edit/main/docs/unloading/Export.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/2.1/table_design/StarRocks_table_design"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Table Design</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/2.1/unloading/Flink_connector"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Use Flink connector to read data from StarRocks</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#explanation-of-terms" class="table-of-contents__link toc-highlight">Explanation of Terms</a></li><li><a href="#principle" class="table-of-contents__link toc-highlight">Principle</a><ul><li><a href="#export-job-execution-process" class="table-of-contents__link toc-highlight">Export Job Execution Process</a></li><li><a href="#query-plan-splitting" class="table-of-contents__link toc-highlight">Query Plan Splitting</a></li><li><a href="#query-plan-execution" class="table-of-contents__link toc-highlight">Query Plan Execution</a></li><li><a href="#usage-examples" class="table-of-contents__link toc-highlight">Usage Examples</a></li><li><a href="#get-export-job-query-id" class="table-of-contents__link toc-highlight">Get Export Job Query ID</a></li><li><a href="#view-export-job-status" class="table-of-contents__link toc-highlight">View Export Job Status</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li><li><a href="#notes" class="table-of-contents__link toc-highlight">Notes</a></li><li><a href="#related-configurations" class="table-of-contents__link toc-highlight">Related configurations</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/StarRocks_intro">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 StarRocks, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>