"use strict";(self.webpackChunkstarrocks=self.webpackChunkstarrocks||[]).push([[43845],{82870:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>o});var t=i(85893),a=i(11151);const s={displayed_sidebar:"English"},l="Bitmap Indexing",r={id:"table_design/Bitmap_index",title:"Bitmap Indexing",description:"StarRocks supports bitmap-based indexing that significantly speeds up queries.",source:"@site/versioned_docs/version-2.0/table_design/Bitmap_index.md",sourceDirName:"table_design",slug:"/table_design/Bitmap_index",permalink:"/docs/2.0/table_design/Bitmap_index",draft:!1,unlisted:!1,editUrl:"https://github.com/StarRocks/starrocks/edit/main/docs/table_design/Bitmap_index.md",tags:[],version:"2.0",frontMatter:{displayed_sidebar:"English"},sidebar:"English",previous:{title:"Introduction",permalink:"/docs/2.0/table_design/"},next:{title:"Bloom Filter Indexing",permalink:"/docs/2.0/table_design/Bloomfilter_index"}},d={},o=[{value:"Principle",id:"principle",level:2},{value:"What is  Bitmap",id:"what-is--bitmap",level:3},{value:"What is  Bitmap index",id:"what-is--bitmap-index",level:3},{value:"Suitable scenarios",id:"suitable-scenarios",level:2},{value:"Non-prefix filtering",id:"non-prefix-filtering",level:3},{value:"Multi-Column Filtering",id:"multi-column-filtering",level:3},{value:"How to use",id:"how-to-use",level:2},{value:"Create an Index",id:"create-an-index",level:3},{value:"View an index",id:"view-an-index",level:3},{value:"Delete an index",id:"delete-an-index",level:3},{value:"Notes",id:"notes",level:2}];function c(e){const n=Object.assign({h1:"h1",p:"p",h2:"h2",h3:"h3",ul:"ul",li:"li",img:"img",code:"code",a:"a",pre:"pre",ol:"ol"},(0,a.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"bitmap-indexing",children:"Bitmap Indexing"}),"\n",(0,t.jsx)(n.p,{children:"StarRocks supports bitmap-based indexing that significantly speeds up queries."}),"\n",(0,t.jsx)(n.h2,{id:"principle",children:"Principle"}),"\n",(0,t.jsx)(n.h3,{id:"what-is--bitmap",children:"What is  Bitmap"}),"\n",(0,t.jsx)(n.p,{children:"Bitmap is an array of one-bit elements with 0 and 1 value. Those elements can be set and cleared. Bitmap can be used in the following scenarios:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use two long types to represent the gender of 16 students. 0 represents female and 1 represents male."}),"\n",(0,t.jsx)(n.li,{children:"A bitmap indicates whether there is a null value in a set of data, where 0 represents the element is not null and 1 represents null."}),"\n",(0,t.jsx)(n.li,{children:"A bitmap indicates quarters (Q1, Q2, Q3, Q4), where 1 represents Q4 and 0 represents the other quarters."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-is--bitmap-index",children:"What is  Bitmap index"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Bitmap Index",src:i(66569).Z+"",width:"2486",height:"1000"})}),"\n",(0,t.jsx)(n.p,{children:"Bitmap can only represent an array of columns with two values. When the values of the columns are of multiple enumeration types, such as quarters (Q1, Q2, Q3, Q4) and system platforms (Linux, Windows, FreeBSD, MacOS), it is not possible to encode them in a single Bitmap. In this case, you can create a Bitmap for each value and a dictionary of the actual enumerated values."}),"\n",(0,t.jsxs)(n.p,{children:["As shown above, there are 4 rows of data in the ",(0,t.jsx)(n.code,{children:"platform"})," column, and the possible values are ",(0,t.jsx)(n.code,{children:"Android"})," and ",(0,t.jsx)(n.code,{children:"iOS"}),". StarRocks will first build a dictionary for the ",(0,t.jsx)(n.code,{children:"platform"})," column, and then map ",(0,t.jsx)(n.code,{children:"Android"})," and ",(0,t.jsx)(n.code,{children:"iOS"})," to int. ",(0,t.jsx)(n.code,{children:"Android"})," and ",(0,t.jsx)(n.code,{children:"iOS"})," are encoded as 0 and 1 respectively.Since ",(0,t.jsx)(n.code,{children:"Android"})," appears in rows 1, 2 and 3, the bitmap is 0111; ",(0,t.jsx)(n.code,{children:"iOS"})," appears in row 4, the bitmap is 1000."]}),"\n",(0,t.jsxs)(n.p,{children:["If there is a SQL query against the table containing the ",(0,t.jsx)(n.code,{children:"platform"})," column, e.g. ",(0,t.jsx)(n.code,{children:"select xxx from table where Platform = iOS"}),", StarRocks will first look up the dictionary to find the ",(0,t.jsx)(n.code,{children:"iOS"})," whose encoding value is 1, and then go to the bitmap index to find out that 1 corresponds to a bitmap of 1000. As a result, StarRocks will only read the 4th row of data as it meets the query condition."]}),"\n",(0,t.jsx)(n.h2,{id:"suitable-scenarios",children:"Suitable scenarios"}),"\n",(0,t.jsx)(n.h3,{id:"non-prefix-filtering",children:"Non-prefix filtering"}),"\n",(0,t.jsxs)(n.p,{children:["Referring to ",(0,t.jsx)(n.a,{href:"/docs/2.0/table_design/Sort_key",children:"shortkey index"}),", StarRocks can quickly filter the first few columns by shortkey indexing. However, for the columns that are in the middle or the end, shortkey indexing doesn\u2019t work. Instead, users can create a bitmap index for filtering."]}),"\n",(0,t.jsx)(n.h3,{id:"multi-column-filtering",children:"Multi-Column Filtering"}),"\n",(0,t.jsx)(n.p,{children:"Since Bitmap can perform bitwise operations quickly, users can consider creating a bitmap index for each column in a multi-column filtering scenario."}),"\n",(0,t.jsx)(n.h2,{id:"how-to-use",children:"How to use"}),"\n",(0,t.jsx)(n.h3,{id:"create-an-index",children:"Create an Index"}),"\n",(0,t.jsxs)(n.p,{children:["Create a bitmap index for the ",(0,t.jsx)(n.code,{children:"site_id"})," column on table1."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"CREATE INDEX index_name ON table1 (site_id) USING BITMAP COMMENT 'balabala';\n"})}),"\n",(0,t.jsx)(n.h3,{id:"view-an-index",children:"View an index"}),"\n",(0,t.jsxs)(n.p,{children:["Show the index under the specified ",(0,t.jsx)(n.code,{children:"table_name"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"SHOW INDEX FROM example_db.table_name;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"delete-an-index",children:"Delete an index"}),"\n",(0,t.jsx)(n.p,{children:"Delete an index with the specified name from a table."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"DROP INDEX index_name ON [db_name.]table_name;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"For the duplicate model, all columns can be bitmap indexed; for the aggregate model, only the key column can be Bitmap indexed."}),"\n",(0,t.jsx)(n.li,{children:"Bitmap indexes should be created on columns that have enumerated values, a large number of duplicate values, and a low base. These columns are used for equivalence queries or can be converted to equivalence queries."}),"\n",(0,t.jsx)(n.li,{children:"Bitmap indexes are not supported for Float, Double, or Decimal type columns."}),"\n",(0,t.jsx)(n.li,{children:"To see whether a query hits the Bitmap index, check the its profile information."}),"\n"]})]})}const h=function(e={}){const{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(c,e)})):c(e)}},66569:(e,n,i)=>{i.d(n,{Z:()=>t});const t=i.p+"assets/images/3.6.1-1-1c641752a39d82ec7ff8d7a384db15f4.png"},11151:(e,n,i)=>{i.d(n,{Zo:()=>r,ah:()=>s});var t=i(67294);const a=t.createContext({});function s(e){const n=t.useContext(a);return t.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const l={};function r({components:e,children:n,disableParentContext:i}){let r;return r=i?"function"==typeof e?e({}):e||l:s(e),t.createElement(a.Provider,{value:r},n)}}}]);