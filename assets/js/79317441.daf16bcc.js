"use strict";(self.webpackChunkstarrocks=self.webpackChunkstarrocks||[]).push([[17249],{90302:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var o=n(85893),s=n(11151);const a={displayed_sidebar:"English"},t="Deploy Broker",i={id:"administration/deploy_broker",title:"Deploy Broker",description:"This topic describes how to deploy Broker. With Broker, StarRocks can read data from source such as HDFS and S3, and pre-process, load, and backup the data with its own computing resources.",source:"@site/versioned_docs/version-2.3/administration/deploy_broker.md",sourceDirName:"administration",slug:"/administration/deploy_broker",permalink:"/docs/2.3/administration/deploy_broker",draft:!1,unlisted:!1,editUrl:"https://github.com/StarRocks/starrocks/edit/main/docs/administration/deploy_broker.md",tags:[],version:"2.3",frontMatter:{displayed_sidebar:"English"},sidebar:"English",previous:{title:"Manage audit logs within StarRocks via Audit Loader",permalink:"/docs/2.3/administration/audit_loader"},next:{title:"Deploy a Compute Node [Preview]",permalink:"/docs/2.3/administration/deploy_cn"}},d={},l=[{value:"Download and decompress the installer",id:"download-and-decompress-the-installer",level:2},{value:"Configure a Broker",id:"configure-a-broker",level:2},{value:"Start a Broker",id:"start-a-broker",level:2},{value:"Add a Broker to cluster",id:"add-a-broker-to-cluster",level:2},{value:"verify if Broker starts",id:"verify-if-broker-starts",level:2},{value:"Stop a Broker",id:"stop-a-broker",level:2}];function c(e){const r=Object.assign({h1:"h1",p:"p",h2:"h2",a:"a",pre:"pre",code:"code",blockquote:"blockquote",strong:"strong",ul:"ul",li:"li"},(0,s.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.h1,{id:"deploy-broker",children:"Deploy Broker"}),"\n",(0,o.jsx)(r.p,{children:"This topic describes how to deploy Broker. With Broker, StarRocks can read data from source such as HDFS and S3, and pre-process, load, and backup the data with its own computing resources."}),"\n",(0,o.jsx)(r.h2,{id:"download-and-decompress-the-installer",children:"Download and decompress the installer"}),"\n",(0,o.jsxs)(r.p,{children:[(0,o.jsx)(r.a,{href:"https://www.starrocks.io/download/community",children:"Download"})," and decompress StarRocks installer."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"tar -xzvf StarRocks-x.x.x.tar.gz\n"})}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"CAUTION"})}),"\n",(0,o.jsx)(r.p,{children:"Replace the file name in the command as the real file name you downloaded."}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"configure-a-broker",children:"Configure a Broker"}),"\n",(0,o.jsxs)(r.p,{children:["Navigate to ",(0,o.jsx)(r.strong,{children:"StarRocks-x.x.x/apache_hdfs_broker"}),"."]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"cd StarRocks-x.x.x/apache_hdfs_broker\n"})}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"CAUTION"})}),"\n",(0,o.jsxs)(r.p,{children:["Replace the file name in the command as the real file name you downloaded.\nSpecify the Broker configuration file ",(0,o.jsx)(r.strong,{children:"conf/apache_hdfs_broker.conf"}),". Because the default configuration can be used directly, no configuration item is changed in the following example. You can copy your own HDFS cluster configuration file and paste it under ",(0,o.jsx)(r.strong,{children:"conf"})," directory."]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"start-a-broker",children:"Start a Broker"}),"\n",(0,o.jsx)(r.p,{children:"Run the following command to start Broker."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"./apache_hdfs_broker/bin/start_broker.sh --daemon\n"})}),"\n",(0,o.jsx)(r.h2,{id:"add-a-broker-to-cluster",children:"Add a Broker to cluster"}),"\n",(0,o.jsx)(r.p,{children:"Run the following command to add the Broker to cluster."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-sql",children:'ALTER SYSTEM ADD BROKER broker_name "broker_ip:broker_port";\n'})}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.strong,{children:"NOTE"})}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsxs)(r.li,{children:["By default, the port for Broker is ",(0,o.jsx)(r.code,{children:"8000"}),"."]}),"\n",(0,o.jsxs)(r.li,{children:["When multiple Brokers are added to a cluster at the same time, they share the same ",(0,o.jsx)(r.code,{children:"broker_name"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(r.h2,{id:"verify-if-broker-starts",children:"verify if Broker starts"}),"\n",(0,o.jsx)(r.p,{children:"You can verify if the BE node is started properly via MySQL client."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-sql",children:'SHOW PROC "/brokers"\\G\n'})}),"\n",(0,o.jsx)(r.p,{children:"Example:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plain",metastring:"text",children:'MySQL [(none)]> SHOW PROC "/brokers"\\G\n*************************** 1. row ***************************\n          Name: broker1\n            IP: x.x.x.x\n          Port: 8000\n         Alive: true\n LastStartTime: 2022-05-19 11:21:36\nLastUpdateTime: 2022-05-19 11:28:31\n        ErrMsg:\n1 row in set (0.00 sec)\n'})}),"\n",(0,o.jsxs)(r.p,{children:["When the field ",(0,o.jsx)(r.code,{children:"Alive"})," is ",(0,o.jsx)(r.code,{children:"true"}),", the Broker is properly started and added to the cluster."]}),"\n",(0,o.jsx)(r.h2,{id:"stop-a-broker",children:"Stop a Broker"}),"\n",(0,o.jsx)(r.p,{children:"Run the following command to stop a Broker."}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"./bin/stop_broker.sh --daemon\n"})})]})}const h=function(e={}){const{wrapper:r}=Object.assign({},(0,s.ah)(),e.components);return r?(0,o.jsx)(r,Object.assign({},e,{children:(0,o.jsx)(c,e)})):c(e)}},11151:(e,r,n)=>{n.d(r,{Zo:()=>i,ah:()=>a});var o=n(67294);const s=o.createContext({});function a(e){const r=o.useContext(s);return o.useMemo((()=>"function"==typeof e?e(r):{...r,...e}),[r,e])}const t={};function i({components:e,children:r,disableParentContext:n}){let i;return i=n?"function"==typeof e?e({}):e||t:a(e),o.createElement(s.Provider,{value:i},r)}}}]);