"use strict";(self.webpackChunkstarrocks=self.webpackChunkstarrocks||[]).push([[17200],{89309:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>d,toc:()=>c});var t=r(85893),a=r(11151);const i={},s="TPC-H \u57fa\u51c6\u6d4b\u8bd5",d={id:"benchmarking/TPC-H_Benchmark",title:"TPC-H \u57fa\u51c6\u6d4b\u8bd5",description:"TPC-H \u662f\u7f8e\u56fd\u4ea4\u6613\u5904\u7406\u6548\u80fd\u59d4\u5458\u4f1a TPC\uff08Transaction Processing Performance Council\uff09\u7ec4\u7ec7\u5236\u5b9a\u7684\u7528\u6765\u6a21\u62df\u51b3\u7b56\u652f\u6301\u7c7b\u5e94\u7528\u7684\u6d4b\u8bd5\u96c6\u3002\u5b83\u5305\u62ec\u4e00\u6574\u5957\u9762\u5411\u4e1a\u52a1\u7684 ad-hoc \u67e5\u8be2\u548c\u5e76\u53d1\u6570\u636e\u4fee\u6539\u3002",source:"@site/chinese_versioned_docs/version-2.5/benchmarking/TPC-H_Benchmark.md",sourceDirName:"benchmarking",slug:"/benchmarking/TPC-H_Benchmark",permalink:"/doc/zh/2.5/benchmarking/TPC-H_Benchmark",draft:!1,unlisted:!1,editUrl:"https://github.com/StarRocks/docs.zh-cn/edit/main/benchmarking/TPC-H_Benchmark.md",tags:[],version:"2.5",frontMatter:{},sidebar:"documentation",previous:{title:"SSB Flat Table \u6027\u80fd\u6d4b\u8bd5",permalink:"/doc/zh/2.5/benchmarking/SSB_Benchmarking"},next:{title:"(To be deprecated) \u5916\u90e8\u8868",permalink:"/doc/zh/2.5/data_source/External_table"}},o={},c=[{value:"1. \u6d4b\u8bd5\u7ed3\u8bba",id:"1-\u6d4b\u8bd5\u7ed3\u8bba",level:2},{value:"2. \u6d4b\u8bd5\u51c6\u5907",id:"2-\u6d4b\u8bd5\u51c6\u5907",level:2},{value:"2.1 \u786c\u4ef6\u73af\u5883\u4e0e\u6210\u672c",id:"21-\u786c\u4ef6\u73af\u5883\u4e0e\u6210\u672c",level:3},{value:"2.2 \u8f6f\u4ef6\u73af\u5883",id:"22-\u8f6f\u4ef6\u73af\u5883",level:3},{value:"3 \u6d4b\u8bd5\u6570\u636e\u4e0e\u7ed3\u679c",id:"3-\u6d4b\u8bd5\u6570\u636e\u4e0e\u7ed3\u679c",level:2},{value:"3.1 \u6d4b\u8bd5\u6570\u636e",id:"31-\u6d4b\u8bd5\u6570\u636e",level:3},{value:"3.2 \u6d4b\u8bd5\u7ed3\u679c",id:"32-\u6d4b\u8bd5\u7ed3\u679c",level:3},{value:"4. \u6d4b\u8bd5\u6d41\u7a0b",id:"4-\u6d4b\u8bd5\u6d41\u7a0b",level:2},{value:"4.1 StarRocks \u672c\u5730\u8868\u6d4b\u8bd5\u6d41\u7a0b",id:"41-starrocks-\u672c\u5730\u8868\u6d4b\u8bd5\u6d41\u7a0b",level:3},{value:"4.1.1 \u751f\u6210\u6570\u636e",id:"411-\u751f\u6210\u6570\u636e",level:4},{value:"4.1.2 \u521b\u5efa\u8868\u7ed3\u6784",id:"412-\u521b\u5efa\u8868\u7ed3\u6784",level:4},{value:"4.1.3 \u5bfc\u5165\u6570\u636e",id:"413-\u5bfc\u5165\u6570\u636e",level:4},{value:"4.1.4 \u67e5\u8be2\u6570\u636e",id:"414-\u67e5\u8be2\u6570\u636e",level:4},{value:"4.2 StarRocks Hive \u5916\u8868\u6d4b\u8bd5\u6d41\u7a0b",id:"42-starrocks-hive-\u5916\u8868\u6d4b\u8bd5\u6d41\u7a0b",level:3},{value:"4.2.1 \u521b\u5efa\u8868\u7ed3\u6784",id:"421-\u521b\u5efa\u8868\u7ed3\u6784",level:4},{value:"4.2.2 \u5bfc\u5165\u6570\u636e",id:"422-\u5bfc\u5165\u6570\u636e",level:4},{value:"4.2.3 \u67e5\u8be2\u6570\u636e",id:"423-\u67e5\u8be2\u6570\u636e",level:4},{value:"5. \u67e5\u8be2 SQL \u548c\u5efa\u8868\u8bed\u53e5",id:"5-\u67e5\u8be2-sql-\u548c\u5efa\u8868\u8bed\u53e5",level:2},{value:"5.1 TPC-H \u67e5\u8be2 SQL",id:"51-tpc-h-\u67e5\u8be2-sql",level:3},{value:"5.2 StarRocks Native \u5efa\u8868",id:"52-starrocks-native-\u5efa\u8868",level:3},{value:"5.3 Hive \u5916\u90e8\u8868\u5efa\u8868\uff08ORC \u5b58\u50a8\u683c\u5f0f\uff09",id:"53-hive-\u5916\u90e8\u8868\u5efa\u8868orc-\u5b58\u50a8\u683c\u5f0f",level:3},{value:"5.4 Hive \u5916\u90e8\u8868\u5efa\u8868\uff08CSV \u5b58\u50a8\u683c\u5f0f\uff09",id:"54-hive-\u5916\u90e8\u8868\u5efa\u8868csv-\u5b58\u50a8\u683c\u5f0f",level:3}];function l(n){const e=Object.assign({h1:"h1",p:"p",h2:"h2",img:"img",h3:"h3",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",ul:"ul",li:"li",blockquote:"blockquote",h4:"h4",code:"code",pre:"pre",a:"a"},(0,a.ah)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:"tpc-h-\u57fa\u51c6\u6d4b\u8bd5",children:"TPC-H \u57fa\u51c6\u6d4b\u8bd5"}),"\n",(0,t.jsx)(e.p,{children:"TPC-H \u662f\u7f8e\u56fd\u4ea4\u6613\u5904\u7406\u6548\u80fd\u59d4\u5458\u4f1a TPC\uff08Transaction Processing Performance Council\uff09\u7ec4\u7ec7\u5236\u5b9a\u7684\u7528\u6765\u6a21\u62df\u51b3\u7b56\u652f\u6301\u7c7b\u5e94\u7528\u7684\u6d4b\u8bd5\u96c6\u3002\u5b83\u5305\u62ec\u4e00\u6574\u5957\u9762\u5411\u4e1a\u52a1\u7684 ad-hoc \u67e5\u8be2\u548c\u5e76\u53d1\u6570\u636e\u4fee\u6539\u3002"}),"\n",(0,t.jsx)(e.p,{children:"TPC-H \u6839\u636e\u771f\u5b9e\u7684\u751f\u4ea7\u8fd0\u884c\u73af\u5883\u6765\u5efa\u6a21\uff0c\u6a21\u62df\u4e86\u4e00\u5957\u9500\u552e\u7cfb\u7edf\u7684\u6570\u636e\u4ed3\u5e93\u3002\u8be5\u6d4b\u8bd5\u5171\u5305\u542b 8 \u5f20\u8868\uff0c\u6570\u636e\u91cf\u53ef\u8bbe\u5b9a\u4ece 1 GB~3 TB\u4e0d\u7b49\u3002\u5176\u57fa\u51c6\u6d4b\u8bd5\u5171\u5305\u542b\u4e86 22 \u4e2a\u67e5\u8be2\uff0c\u4e3b\u8981\u8bc4\u4ef7\u6307\u6807\u4e3a\u5404\u4e2a\u67e5\u8be2\u7684\u54cd\u5e94\u65f6\u95f4\uff0c\u5373\u4ece\u63d0\u4ea4\u67e5\u8be2\u5230\u7ed3\u679c\u8fd4\u56de\u6240\u9700\u65f6\u95f4\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"1-\u6d4b\u8bd5\u7ed3\u8bba",children:"1. \u6d4b\u8bd5\u7ed3\u8bba"}),"\n",(0,t.jsx)(e.p,{children:"\u5728 TPC-H 100G \u89c4\u6a21\u7684\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\u5bf9\u6bd4\u6d4b\u8bd5\uff0c\u5171 22 \u4e2a\u67e5\u8be2\uff0c\u7ed3\u679c\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"TPCH 100G\u7ed3\u679c",src:r(71629).Z+"",width:"1141",height:"475"})}),"\n",(0,t.jsx)(e.p,{children:"StarRocks \u6d4b\u8bd5\u4e86\u4f7f\u7528\u672c\u5730\u5b58\u50a8\u67e5\u8be2\u548c Hive \u5916\u8868\u67e5\u8be2\u4e24\u79cd\u65b9\u5f0f\uff0c\u5176\u4e2d StarRocks Hive \u5916\u8868\u548c Trino \u67e5\u8be2\u7684\u662f\u540c\u4e00\u4efd\u6570\u636e\uff0c\u6570\u636e\u91c7\u7528 ORC \u683c\u5f0f\u5b58\u50a8\uff0czlib \u683c\u5f0f\u538b\u7f29\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6700\u7ec8\uff0cStarRocks \u672c\u5730\u5b58\u50a8\u67e5\u8be2\u603b\u8017\u65f6\u4e3a 17s\uff0cStarRocks Hive \u5916\u8868\u67e5\u8be2\u603b\u8017\u65f6\u4e3a 92s\uff0cTrino \u67e5\u8be2\u603b\u8017\u65f6\u4e3a187s\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"2-\u6d4b\u8bd5\u51c6\u5907",children:"2. \u6d4b\u8bd5\u51c6\u5907"}),"\n",(0,t.jsx)(e.h3,{id:"21-\u786c\u4ef6\u73af\u5883\u4e0e\u6210\u672c",children:"2.1 \u786c\u4ef6\u73af\u5883\u4e0e\u6210\u672c"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u673a\u5668"}),(0,t.jsx)(e.th,{children:"3\u53f0 \u963f\u91cc\u4e91\u4e3b\u673a"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"CPU"}),(0,t.jsx)(e.td,{children:"16core Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u5185\u5b58"}),(0,t.jsx)(e.td,{children:"64 GB"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u7f51\u7edc\u5e26\u5bbd"}),(0,t.jsx)(e.td,{children:"5 Gbits/s"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u78c1\u76d8"}),(0,t.jsx)(e.td,{children:"ESSD \u4e91\u76d8"})]})]})]}),"\n",(0,t.jsx)(e.h3,{id:"22-\u8f6f\u4ef6\u73af\u5883",children:"2.2 \u8f6f\u4ef6\u73af\u5883"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5185\u6838\u7248\u672c\uff1aLinux 3.10.0-1127.13.1.el7.x86_64"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\uff1aCentOS Linux release 7.8.2003"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u8f6f\u4ef6\u7248\u672c\uff1aStarRocks \u793e\u533a\u7248 3.0\uff0cTrino-419\uff0cHive-2.3.9"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"3-\u6d4b\u8bd5\u6570\u636e\u4e0e\u7ed3\u679c",children:"3 \u6d4b\u8bd5\u6570\u636e\u4e0e\u7ed3\u679c"}),"\n",(0,t.jsx)(e.h3,{id:"31-\u6d4b\u8bd5\u6570\u636e",children:"3.1 \u6d4b\u8bd5\u6570\u636e"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u8868"}),(0,t.jsx)(e.th,{children:"\u884c\u6570"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"customer"}),(0,t.jsx)(e.td,{children:"1500\u4e07"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"lineitem"}),(0,t.jsx)(e.td,{children:"6\u4ebf"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"nation"}),(0,t.jsx)(e.td,{children:"25"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"orders"}),(0,t.jsx)(e.td,{children:"1.5\u4ebf"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"part"}),(0,t.jsx)(e.td,{children:"2000\u4e07"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"partsupp"}),(0,t.jsx)(e.td,{children:"8000\u4e07"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"region"}),(0,t.jsx)(e.td,{children:"5"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"supplier"}),(0,t.jsx)(e.td,{children:"100\u4e07"})]})]})]}),"\n",(0,t.jsx)(e.h3,{id:"32-\u6d4b\u8bd5\u7ed3\u679c",children:"3.2 \u6d4b\u8bd5\u7ed3\u679c"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u67e5\u8be2\u7ed3\u679c\u7684\u5355\u4f4d\u662f ms\u3002"}),"\n"]}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"Query"}),(0,t.jsx)(e.th,{children:"StarRocks-native-3.0"}),(0,t.jsx)(e.th,{children:"StarRocks-3.0-Hive external"}),(0,t.jsx)(e.th,{children:"Trino-419"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q1"}),(0,t.jsx)(e.td,{children:"1540"}),(0,t.jsx)(e.td,{children:"5660"}),(0,t.jsx)(e.td,{children:"8811"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q2"}),(0,t.jsx)(e.td,{children:"100"}),(0,t.jsx)(e.td,{children:"1593"}),(0,t.jsx)(e.td,{children:"3009"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q3"}),(0,t.jsx)(e.td,{children:"700"}),(0,t.jsx)(e.td,{children:"5286"}),(0,t.jsx)(e.td,{children:"7891"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q4"}),(0,t.jsx)(e.td,{children:"423"}),(0,t.jsx)(e.td,{children:"2110"}),(0,t.jsx)(e.td,{children:"5760"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q5"}),(0,t.jsx)(e.td,{children:"1180"}),(0,t.jsx)(e.td,{children:"4453"}),(0,t.jsx)(e.td,{children:"9181"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q6"}),(0,t.jsx)(e.td,{children:"56"}),(0,t.jsx)(e.td,{children:"2806"}),(0,t.jsx)(e.td,{children:"4029"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q7"}),(0,t.jsx)(e.td,{children:"903"}),(0,t.jsx)(e.td,{children:"4910"}),(0,t.jsx)(e.td,{children:"7158"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q8"}),(0,t.jsx)(e.td,{children:"546"}),(0,t.jsx)(e.td,{children:"4766"}),(0,t.jsx)(e.td,{children:"8014"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q9"}),(0,t.jsx)(e.td,{children:"2553"}),(0,t.jsx)(e.td,{children:"8010"}),(0,t.jsx)(e.td,{children:"18460"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q10"}),(0,t.jsx)(e.td,{children:"776"}),(0,t.jsx)(e.td,{children:"8190"}),(0,t.jsx)(e.td,{children:"9997"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q11"}),(0,t.jsx)(e.td,{children:"206"}),(0,t.jsx)(e.td,{children:"920"}),(0,t.jsx)(e.td,{children:"2088"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q12"}),(0,t.jsx)(e.td,{children:"166"}),(0,t.jsx)(e.td,{children:"2916"}),(0,t.jsx)(e.td,{children:"4852"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q13"}),(0,t.jsx)(e.td,{children:"1663"}),(0,t.jsx)(e.td,{children:"3420"}),(0,t.jsx)(e.td,{children:"7203"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q14"}),(0,t.jsx)(e.td,{children:"146"}),(0,t.jsx)(e.td,{children:"3286"}),(0,t.jsx)(e.td,{children:"4995"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q15"}),(0,t.jsx)(e.td,{children:"123"}),(0,t.jsx)(e.td,{children:"4173"}),(0,t.jsx)(e.td,{children:"9688"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q16"}),(0,t.jsx)(e.td,{children:"353"}),(0,t.jsx)(e.td,{children:"1126"}),(0,t.jsx)(e.td,{children:"2545"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q17"}),(0,t.jsx)(e.td,{children:"296"}),(0,t.jsx)(e.td,{children:"3426"}),(0,t.jsx)(e.td,{children:"18970"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q18"}),(0,t.jsx)(e.td,{children:"2713"}),(0,t.jsx)(e.td,{children:"7960"}),(0,t.jsx)(e.td,{children:"21763"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q19"}),(0,t.jsx)(e.td,{children:"246"}),(0,t.jsx)(e.td,{children:"4406"}),(0,t.jsx)(e.td,{children:"6586"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q20"}),(0,t.jsx)(e.td,{children:"176"}),(0,t.jsx)(e.td,{children:"3280"}),(0,t.jsx)(e.td,{children:"6632"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q21"}),(0,t.jsx)(e.td,{children:"1410"}),(0,t.jsx)(e.td,{children:"7933"}),(0,t.jsx)(e.td,{children:"16873"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Q22"}),(0,t.jsx)(e.td,{children:"350"}),(0,t.jsx)(e.td,{children:"1190"}),(0,t.jsx)(e.td,{children:"2788"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"SUM"}),(0,t.jsx)(e.td,{children:"16625"}),(0,t.jsx)(e.td,{children:"91820"}),(0,t.jsx)(e.td,{children:"187293"})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"4-\u6d4b\u8bd5\u6d41\u7a0b",children:"4. \u6d4b\u8bd5\u6d41\u7a0b"}),"\n",(0,t.jsx)(e.h3,{id:"41-starrocks-\u672c\u5730\u8868\u6d4b\u8bd5\u6d41\u7a0b",children:"4.1 StarRocks \u672c\u5730\u8868\u6d4b\u8bd5\u6d41\u7a0b"}),"\n",(0,t.jsx)(e.h4,{id:"411-\u751f\u6210\u6570\u636e",children:"4.1.1 \u751f\u6210\u6570\u636e"}),"\n",(0,t.jsxs)(e.p,{children:["\u4e0b\u8f7d tpch-poc \u5de5\u5177\u5305\u751f\u6210 TPC-H \u6807\u51c6\u6d4b\u8bd5\u96c6 ",(0,t.jsx)(e.code,{children:"scale factor=100"})," \u7684\u6570\u636e\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-Bash",children:"wget https://starrocks-public.oss-cn-zhangjiakou.aliyuncs.com/tpch-poc-1.0.zip\nunzip tpch-poc-1.0\ncd tpch-poc-1.0\n\nsh bin/gen_data/gen-tpch.sh 100 data_100\n"})}),"\n",(0,t.jsx)(e.h4,{id:"412-\u521b\u5efa\u8868\u7ed3\u6784",children:"4.1.2 \u521b\u5efa\u8868\u7ed3\u6784"}),"\n",(0,t.jsxs)(e.p,{children:["\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 ",(0,t.jsx)(e.code,{children:"conf/starrocks.conf"}),"\uff0c\u6307\u5b9a\u811a\u672c\u64cd\u4f5c\u7684\u96c6\u7fa4\u5730\u5740\uff0c\u91cd\u70b9\u5173\u6ce8 ",(0,t.jsx)(e.code,{children:"mysql_host"})," \u548c ",(0,t.jsx)(e.code,{children:"mysql_port"}),"\uff0c\u7136\u540e\u6267\u884c\u5efa\u8868\u64cd\u4f5c\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-SQL",children:"sh bin/create_db_table.sh ddl_100\n"})}),"\n",(0,t.jsx)(e.h4,{id:"413-\u5bfc\u5165\u6570\u636e",children:"4.1.3 \u5bfc\u5165\u6570\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-Python",children:"sh bin/stream_load.sh data_100\n"})}),"\n",(0,t.jsx)(e.h4,{id:"414-\u67e5\u8be2\u6570\u636e",children:"4.1.4 \u67e5\u8be2\u6570\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-Python",children:"sh bin/benchmark.sh\n"})}),"\n",(0,t.jsx)(e.h3,{id:"42-starrocks-hive-\u5916\u8868\u6d4b\u8bd5\u6d41\u7a0b",children:"4.2 StarRocks Hive \u5916\u8868\u6d4b\u8bd5\u6d41\u7a0b"}),"\n",(0,t.jsx)(e.h4,{id:"421-\u521b\u5efa\u8868\u7ed3\u6784",children:"4.2.1 \u521b\u5efa\u8868\u7ed3\u6784"}),"\n",(0,t.jsxs)(e.p,{children:["\u5728 Hive \u4e2d\u521b\u5efa\u5916\u90e8\u8868\uff0c\u5916\u90e8\u8868\u5b58\u50a8\u683c\u5f0f\u662f ORC\uff0c\u538b\u7f29\u683c\u5f0f\u662f zlib\uff0c\u8be6\u7ec6\u5efa\u8868\u8bed\u53e5\u89c1 ",(0,t.jsx)(e.a,{href:"#53-hive-%E5%A4%96%E9%83%A8%E8%A1%A8%E5%BB%BA%E8%A1%A8orc-%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F",children:"5.3"}),"\uff0c\u8fd9\u4e2a Hive \u5916\u90e8\u8868\u5c31\u662fStarRocks \u548c Trino \u5bf9\u6bd4\u6d4b\u8bd5\u67e5\u8be2\u7684\u8868\u3002"]}),"\n",(0,t.jsx)(e.h4,{id:"422-\u5bfc\u5165\u6570\u636e",children:"4.2.2 \u5bfc\u5165\u6570\u636e"}),"\n",(0,t.jsxs)(e.p,{children:["\u5c06\u6b65\u9aa4 ",(0,t.jsx)(e.a,{href:"#411-%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE",children:"4.1.1"})," \u4e2d\u751f\u6210\u7684 TPC-H CSV \u539f\u59cb\u6570\u636e\u4e0a\u4f20\u5230 HDFS \u6307\u5b9a\u8def\u5f84\u4e0a\uff0c\u672c\u6587\u4ee5\u8def\u5f84 /user/tmp/csv/ \u4e3e\u4f8b\uff0c\u7136\u540e\u5728 Hive \u4e2d\u521b\u5efa\u5916\u90e8\u8868\uff0c\u8be6\u7ec6\u5efa\u8868\u8bed\u53e5\u89c1 ",(0,t.jsx)(e.a,{href:"#54-hive-%E5%A4%96%E9%83%A8%E8%A1%A8%E5%BB%BA%E8%A1%A8csv-%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F",children:"5.4"}),"\u3002\u8fd9\u4e2a Hive \u5916\u90e8\u8868\u5b58\u50a8\u683c\u5f0f\u4e3a CSV\uff0c\u5b58\u50a8\u8def\u5f84\u4e3a CSV \u539f\u59cb\u6570\u636e\u4e0a\u4f20\u7684\u8def\u5f84 /user/tmp/csv/\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7 insert into \u5c06 CSV \u683c\u5f0f\u5916\u90e8\u8868\u7684\u6570\u636e\u5bfc\u5165\u5230 ORC \u683c\u5f0f\u7684\u5916\u90e8\u8868\u4e2d\uff0c\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u5b58\u50a8\u683c\u5f0f\u4e3a ORC\uff0c\u538b\u7f29\u683c\u5f0f\u4e3a zlib \u7684\u6570\u636e\uff0c\u5bfc\u5165\u547d\u4ee4\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-SQL",children:"use tpch_hive_csv\uff1b\n\ninsert into tpch_hive_orc.customer  select * from customer;\ninsert into tpch_hive_orc.lineitem  select * from lineitem;\ninsert into tpch_hive_orc.nation  select * from nation;\ninsert into tpch_hive_orc.orders  select * from orders;\ninsert into tpch_hive_orc.part  select * from part;\ninsert into tpch_hive_orc.partsupp  select * from partsupp;\ninsert into tpch_hive_orc.region  select * from region;\ninsert into tpch_hive_orc.supplier  select * from supplier;\n"})}),"\n",(0,t.jsx)(e.h4,{id:"423-\u67e5\u8be2\u6570\u636e",children:"4.2.3 \u67e5\u8be2\u6570\u636e"}),"\n",(0,t.jsxs)(e.p,{children:["StarRocks \u4f7f\u7528 Catalog \u529f\u80fd\u67e5\u8be2 Hive \u5916\u8868\u6570\u636e\uff0c\u8be6\u7ec6\u64cd\u4f5c\u89c1 ",(0,t.jsx)(e.a,{href:"/doc/zh/2.5/data_source/catalog/hive_catalog",children:"Hive catalog"}),"\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"5-\u67e5\u8be2-sql-\u548c\u5efa\u8868\u8bed\u53e5",children:"5. \u67e5\u8be2 SQL \u548c\u5efa\u8868\u8bed\u53e5"}),"\n",(0,t.jsx)(e.h3,{id:"51-tpc-h-\u67e5\u8be2-sql",children:"5.1 TPC-H \u67e5\u8be2 SQL"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-SQL",children:"--Q1\nselect\n  l_returnflag,\n  l_linestatus,\n  sum(l_quantity) as sum_qty,\n  sum(l_extendedprice) as sum_base_price,\n  sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n  sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n  avg(l_quantity) as avg_qty,\n  avg(l_extendedprice) as avg_price,\n  avg(l_discount) as avg_disc,\n  count(*) as count_order\nfrom\n  lineitem\nwhere\n  l_shipdate <= date '1998-12-01' - interval '90' day\ngroup by\n  l_returnflag,\n  l_linestatus\norder by\n  l_returnflag,\n  l_linestatus;\n\n--Q2\nselect\n  s_acctbal,\n  s_name,\n  n_name,\n  p_partkey,\n  p_mfgr,\n  s_address,\n  s_phone,\n  s_comment\nfrom\n  part,\n  supplier,\n  partsupp,\n  nation,\n  region\nwhere\n  p_partkey = ps_partkey\n  and s_suppkey = ps_suppkey\n  and p_size = 15\n  and p_type like '%BRASS'\n  and s_nationkey = n_nationkey\n  and n_regionkey = r_regionkey\n  and r_name = 'EUROPE'\n  and ps_supplycost = ( \n    select\n      min(ps_supplycost)\n    from\n      partsupp,\n      supplier,\n      nation,\n      region\n    where\n      p_partkey = ps_partkey\n      and s_suppkey = ps_suppkey\n      and s_nationkey = n_nationkey\n      and n_regionkey = r_regionkey\n      and r_name = 'EUROPE'\n  )\norder by\n  s_acctbal desc,\n  n_name,\n  s_name,\n  p_partkey\nlimit 100;\n\n--Q3\nselect\n  l_orderkey,\n  sum(l_extendedprice * (1 - l_discount)) as revenue,\n  o_orderdate,\n  o_shippriority\nfrom\n  customer,\n  orders,\n  lineitem\nwhere\n  c_mktsegment = 'BUILDING'\n  and c_custkey = o_custkey\n  and l_orderkey = o_orderkey\n  and o_orderdate < date '1995-03-15'\n  and l_shipdate > date '1995-03-15'\ngroup by\n  l_orderkey,\n  o_orderdate,\n  o_shippriority\norder by\n  revenue desc,\n  o_orderdate\nlimit 10;\n\n--Q4\nselect\n  o_orderpriority,\n  count(*) as order_count\nfrom\n  orders\nwhere\n  o_orderdate >= date '1993-07-01'\n  and o_orderdate < date '1993-07-01' + interval '3' month\n  and exists (\n    select\n      *   \n    from\n      lineitem\n    where\n      l_orderkey = o_orderkey\n      and l_commitdate < l_receiptdate\n  )\ngroup by\n  o_orderpriority\norder by\n  o_orderpriority;\n\n--Q5\nselect\n  n_name,\n  sum(l_extendedprice * (1 - l_discount)) as revenue\nfrom\n  customer,\n  orders,\n  lineitem,\n  supplier,\n  nation,\n  region\nwhere\n  c_custkey = o_custkey\n  and l_orderkey = o_orderkey\n  and l_suppkey = s_suppkey\n  and c_nationkey = s_nationkey\n  and s_nationkey = n_nationkey\n  and n_regionkey = r_regionkey\n  and r_name = 'ASIA'\n  and o_orderdate >= date '1994-01-01'\n  and o_orderdate < date '1994-01-01' + interval '1' year\ngroup by\n  n_name\norder by\n  revenue desc;\n\n--Q6\nselect\n  sum(l_extendedprice * l_discount) as revenue\nfrom\n  lineitem\nwhere\n  l_shipdate >= date '1994-01-01'\n  and l_shipdate < date '1994-01-01' + interval '1' year\n  and l_discount between .06 - 0.01 and .06 + 0.01\n  and l_quantity < 24;\n\n--Q7\nselect\n  supp_nation,\n  cust_nation,\n  l_year,\n  sum(volume) as revenue\nfrom\n  (\n    select\n      n1.n_name as supp_nation,\n      n2.n_name as cust_nation,\n      extract(year from l_shipdate) as l_year,\n      l_extendedprice * (1 - l_discount) as volume\n    from\n      supplier,\n      lineitem,\n      orders,\n      customer,\n      nation n1, \n      nation n2\n    where\n      s_suppkey = l_suppkey\n      and o_orderkey = l_orderkey\n      and c_custkey = o_custkey\n      and s_nationkey = n1.n_nationkey\n      and c_nationkey = n2.n_nationkey\n      and (\n        (n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY')\n        or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')\n      )   \n      and l_shipdate between date '1995-01-01' and date '1996-12-31'\n  ) as shipping\ngroup by\n  supp_nation,\n  cust_nation,\n  l_year\norder by\n  supp_nation,\n  cust_nation,\n  l_year;\n\n--Q8\nselect\n  o_year,\n  sum(case\n    when nation = 'BRAZIL' then volume\n    else 0\n  end) / sum(volume) as mkt_share\nfrom\n  (\n    select\n      extract(year from o_orderdate) as o_year,\n      l_extendedprice * (1 - l_discount) as volume,\n      n2.n_name as nation\n    from\n      part,\n      supplier,\n      lineitem,\n      orders,\n      customer,\n      nation n1, \n      nation n2, \n      region\n    where\n      p_partkey = l_partkey\n      and s_suppkey = l_suppkey\n      and l_orderkey = o_orderkey\n      and o_custkey = c_custkey\n      and c_nationkey = n1.n_nationkey\n      and n1.n_regionkey = r_regionkey\n      and r_name = 'AMERICA'\n      and s_nationkey = n2.n_nationkey\n      and o_orderdate between date '1995-01-01' and date '1996-12-31'\n      and p_type = 'ECONOMY ANODIZED STEEL'\n  ) as all_nations\ngroup by\n  o_year\norder by\n  o_year;\n\n--Q9\nselect\n  nation,\n  o_year,\n  sum(amount) as sum_profit\nfrom\n  (\n    select\n      n_name as nation,\n      extract(year from o_orderdate) as o_year,\n      l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount\n    from\n      part,\n      supplier,\n      lineitem,\n      partsupp,\n      orders,\n      nation\n    where\n      s_suppkey = l_suppkey\n      and ps_suppkey = l_suppkey\n      and ps_partkey = l_partkey\n      and p_partkey = l_partkey\n      and o_orderkey = l_orderkey\n      and s_nationkey = n_nationkey\n      and p_name like '%green%'\n  ) as profit\ngroup by\n  nation,\n  o_year\norder by\n  nation,\n  o_year desc;\n\n--Q10\nselect\n      c_custkey,\n      c_name,\n      sum(l_extendedprice * (1 - l_discount)) as revenue,\n      c_acctbal,\n      n_name,\n      c_address,\n      c_phone,\n      c_comment\n    from\n      customer,\n      orders,\n      lineitem,\n      nation\n    where\n      c_custkey = o_custkey\n      and l_orderkey = o_orderkey\n      and o_orderdate >= date '1993-10-01'\n      and o_orderdate < date '1993-10-01' + interval '3' month\n      and l_returnflag = 'R' \n      and c_nationkey = n_nationkey\n    group by\n      c_custkey,\n      c_name,\n      c_acctbal,\n      c_phone,\n      n_name,\n      c_address,\n      c_comment\n    order by\n      revenue desc\nlimit 20;\n\n--Q11\nselect\n  ps_partkey,\n  sum(ps_supplycost * ps_availqty) as value\nfrom\n  partsupp,\n  supplier,\n  nation\nwhere\n  ps_suppkey = s_suppkey\n  and s_nationkey = n_nationkey\n  and n_name = 'GERMANY'\ngroup by\n  ps_partkey having\n    sum(ps_supplycost * ps_availqty) > ( \n      select\n        sum(ps_supplycost * ps_availqty) * 0.000001\n      from\n        partsupp,\n        supplier,\n        nation\n      where\n        ps_suppkey = s_suppkey\n        and s_nationkey = n_nationkey\n        and n_name = 'GERMANY'\n    )   \norder by\n  value desc;\n\n--Q12\nselect\n  l_shipmode,\n  sum(case\n    when o_orderpriority = '1-URGENT'\n      or o_orderpriority = '2-HIGH'\n      then 1\n    else 0\n  end) as high_line_count,\n  sum(case\n    when o_orderpriority <> '1-URGENT'\n      and o_orderpriority <> '2-HIGH'\n      then 1\n    else 0\n  end) as low_line_count\nfrom\n  orders,\n  lineitem\nwhere\n  o_orderkey = l_orderkey\n  and l_shipmode in ('MAIL', 'SHIP')\n  and l_commitdate < l_receiptdate\n  and l_shipdate < l_commitdate\n  and l_receiptdate >= date '1994-01-01'\n  and l_receiptdate < date '1994-01-01' + interval '1' year\ngroup by\n  l_shipmode\norder by\n  l_shipmode;\n\n--Q13\nselect  c_count, count(*) as custdist\nfrom (\n    select \n        c_custkey,\n        count(o_orderkey) as c_count\n    from \n        customer left outer join orders on \n            c_custkey = o_custkey \n            and o_comment not like '%special%requests%'\n    group by  \n        c_custkey\n    ) as c_orders\ngroup by  \n    c_count \norder by \n    custdist desc, \n    c_count desc;\n\n--Q14\nselect\n  100.00 * sum(case\n    when p_type like 'PROMO%'\n      then l_extendedprice * (1 - l_discount)\n    else 0\n  end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue\nfrom\n  lineitem,\n  part\nwhere\n  l_partkey = p_partkey\n  and l_shipdate >= date '1995-09-01'\n  and l_shipdate < date '1995-09-01' + interval '1' month;\n\n--Q15\nselect\n  s_suppkey,\n  s_name,\n  s_address,\n  s_phone,\n  total_revenue\nfrom\n  supplier,\n  revenue0\nwhere\n  s_suppkey = supplier_no\n  and total_revenue = ( \n    select\n      max(total_revenue)\n    from\n      revenue0\n  )\norder by\n  s_suppkey;\n\n--Q16\nselect\n  p_brand,\n  p_type,\n  p_size,\n  count(distinct ps_suppkey) as supplier_cnt\nfrom\n  partsupp,\n  part\nwhere\n  p_partkey = ps_partkey\n  and p_brand <> 'Brand#45'\n  and p_type not like 'MEDIUM POLISHED%'\n  and p_size in (49, 14, 23, 45, 19, 3, 36, 9)\n  and ps_suppkey not in (\n    select\n      s_suppkey\n    from\n      supplier\n    where\n      s_comment like '%Customer%Complaints%'\n  )\ngroup by\n  p_brand,\n  p_type,\n  p_size\norder by\n  supplier_cnt desc,\n  p_brand,\n  p_type,\n  p_size;\n\n--Q17\nselect\n  sum(l_extendedprice) / 7.0 as avg_yearly\nfrom\n  lineitem,\n  part\nwhere\n  p_partkey = l_partkey\n  and p_brand = 'Brand#23'\n  and p_container = 'MED BOX'\n  and l_quantity < ( \n    select\n      0.2 * avg(l_quantity)\n    from\n      lineitem\n    where\n      l_partkey = p_partkey\n  );\n\n--Q18\nselect\n  c_name,\n  c_custkey,\n  o_orderkey,\n  o_orderdate,\n  o_totalprice,\n  sum(l_quantity)\nfrom\n  customer,\n  orders,\n  lineitem\nwhere\n  o_orderkey in (\n    select\n      l_orderkey\n    from\n      lineitem\n    group by\n      l_orderkey having\n        sum(l_quantity) > 300 \n  )\n  and c_custkey = o_custkey\n  and o_orderkey = l_orderkey\ngroup by\n  c_name,\n  c_custkey,\n  o_orderkey,\n  o_orderdate,\n  o_totalprice\norder by\n  o_totalprice desc,\n  o_orderdate\nlimit 100;\n\n--Q19\nselect\n  sum(l_extendedprice* (1 - l_discount)) as revenue\nfrom\n  lineitem,\n  part\nwhere\n  (\n    p_partkey = l_partkey\n    and p_brand = 'Brand#12'\n    and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')\n    and l_quantity >= 1 and l_quantity <= 1 + 10\n    and p_size between 1 and 5\n    and l_shipmode in ('AIR', 'AIR REG')\n    and l_shipinstruct = 'DELIVER IN PERSON'\n  )\n  or  \n  (\n    p_partkey = l_partkey\n    and p_brand = 'Brand#23'\n    and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')\n    and l_quantity >= 10 and l_quantity <= 10 + 10\n    and p_size between 1 and 10\n    and l_shipmode in ('AIR', 'AIR REG')\n    and l_shipinstruct = 'DELIVER IN PERSON'\n  )\n  or  \n  (\n    p_partkey = l_partkey\n    and p_brand = 'Brand#34'\n    and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')\n    and l_quantity >= 20 and l_quantity <= 20 + 10\n    and p_size between 1 and 15\n    and l_shipmode in ('AIR', 'AIR REG')\n    and l_shipinstruct = 'DELIVER IN PERSON'\n  );\n\n--Q20\nselect\n  s_name,\n  s_address\nfrom\n  supplier,\n  nation\nwhere\n  s_suppkey in (\n    select\n      ps_suppkey\n    from\n      partsupp\n    where\n      ps_partkey in (\n        select\n          p_partkey\n        from\n          part\n        where\n          p_name like 'forest%'\n      )   \n      and ps_availqty > ( \n        select\n          0.5 * sum(l_quantity)\n        from\n          lineitem\n        where\n          l_partkey = ps_partkey\n          and l_suppkey = ps_suppkey\n          and l_shipdate >= date '1994-01-01'\n          and l_shipdate < date '1994-01-01' + interval '1' year\n      )   \n  )\n  and s_nationkey = n_nationkey\n  and n_name = 'CANADA'\norder by\n  s_name;\n\n--Q21\nselect\n        s_name,\n        count(*) as numwait\nfrom\n        supplier,\n        lineitem l1,\n        orders,\n        nation\nwhere\n        s_suppkey = l1.l_suppkey\n        and o_orderkey = l1.l_orderkey\n        and o_orderstatus = 'F'\n        and l1.l_receiptdate > l1.l_commitdate\n        and exists (\n                select\n                        *\n                from\n                        lineitem l2\n                where\n                        l2.l_orderkey = l1.l_orderkey\n                        and l2.l_suppkey <> l1.l_suppkey\n        )\n        and not exists (\n                select\n                        *\n                from\n                        lineitem l3\n                where\n                        l3.l_orderkey = l1.l_orderkey\n                        and l3.l_suppkey <> l1.l_suppkey\n                        and l3.l_receiptdate > l3.l_commitdate\n        )\n        and s_nationkey = n_nationkey\n        and n_name = 'SAUDI ARABIA'\ngroup by\n        s_name\norder by\n        numwait desc,\n        s_name\nlimit 100;\n\n\n--Q22\nselect\n  cntrycode,\n  count(*) as numcust,\n  sum(c_acctbal) as totacctbal\nfrom\n  (\n    select\n      substring(c_phone, 1, 2) as cntrycode,\n      c_acctbal\n    from\n      customer\n    where\n      substring(c_phone, 1, 2) in\n        ('13', '31', '23', '29', '30', '18', '17')\n      and c_acctbal > ( \n        select\n          avg(c_acctbal)\n        from\n          customer\n        where\n          c_acctbal > 0.00\n          and substring(c_phone, 1, 2) in\n            ('13', '31', '23', '29', '30', '18', '17')\n      )   \n      and not exists (\n        select\n          *\n        from\n          orders\n        where\n          o_custkey = c_custkey\n      )   \n  ) as custsale\ngroup by\n  cntrycode\norder by\n  cntrycode;\n"})}),"\n",(0,t.jsx)(e.h3,{id:"52-starrocks-native-\u5efa\u8868",children:"5.2 StarRocks Native \u5efa\u8868"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-SQL",children:'# \u521b\u5efa\u8868 customer\ndrop table if exists customer;\nCREATE TABLE customer (\n    c_custkey     int NOT NULL,\n    c_name        VARCHAR(25) NOT NULL,\n    c_address     VARCHAR(40) NOT NULL,\n    c_nationkey   int NOT NULL,\n    c_phone       VARCHAR(15) NOT NULL,\n    c_acctbal     decimal(15, 2)   NOT NULL,\n    c_mktsegment  VARCHAR(10) NOT NULL,\n    c_comment     VARCHAR(117) NOT NULL\n)ENGINE=OLAP\nDUPLICATE KEY(`c_custkey`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`c_custkey`) BUCKETS 24\nPROPERTIES (\n    "replication_num" = "1"\n);\n\n# \u521b\u5efa\u8868 lineitem\ndrop table if exists lineitem;\nCREATE TABLE lineitem ( \n    l_shipdate    DATE NOT NULL,\n    l_orderkey    int NOT NULL,\n    l_linenumber  int not null,\n    l_partkey     int NOT NULL,\n    l_suppkey     int not null,\n    l_quantity    decimal(15, 2) NOT NULL,\n    l_extendedprice  decimal(15, 2) NOT NULL,\n    l_discount    decimal(15, 2) NOT NULL,\n    l_tax         decimal(15, 2) NOT NULL,\n    l_returnflag  VARCHAR(1) NOT NULL,\n    l_linestatus  VARCHAR(1) NOT NULL,\n    l_commitdate  DATE NOT NULL,\n    l_receiptdate DATE NOT NULL,\n    l_shipinstruct VARCHAR(25) NOT NULL,\n    l_shipmode     VARCHAR(10) NOT NULL,\n    l_comment      VARCHAR(44) NOT NULL\n)ENGINE=OLAP\nDUPLICATE KEY(`l_shipdate`, `l_orderkey`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`l_orderkey`) BUCKETS 96\nPROPERTIES (\n    "replication_num" = "1",\n    "colocate_with" = "tpch2"\n);\n\n# \u521b\u5efa\u8868 nation\ndrop table if exists nation;\nCREATE TABLE `nation` (\n  `n_nationkey` int(11) NOT NULL,\n  `n_name`      varchar(25) NOT NULL,\n  `n_regionkey` int(11) NOT NULL,\n  `n_comment`   varchar(152) NULL\n) ENGINE=OLAP\nDUPLICATE KEY(`N_NATIONKEY`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`N_NATIONKEY`) BUCKETS 1\nPROPERTIES (\n    "replication_num" = "3"\n);\n\n# \u521b\u5efa\u8868 orders\ndrop table if exists orders;\nCREATE TABLE orders  (\n    o_orderkey       int NOT NULL,\n    o_orderdate      DATE NOT NULL,\n    o_custkey        int NOT NULL,\n    o_orderstatus    VARCHAR(1) NOT NULL,\n    o_totalprice     decimal(15, 2) NOT NULL,\n    o_orderpriority  VARCHAR(15) NOT NULL,\n    o_clerk          VARCHAR(15) NOT NULL,\n    o_shippriority   int NOT NULL,\n    o_comment        VARCHAR(79) NOT NULL\n)ENGINE=OLAP\nDUPLICATE KEY(`o_orderkey`, `o_orderdate`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`o_orderkey`) BUCKETS 96\nPROPERTIES (\n    "replication_num" = "1",\n    "colocate_with" = "tpch2"\n);\n\n# \u521b\u5efa\u8868 part\ndrop table if exists part;\nCREATE TABLE part (\n    p_partkey          int NOT NULL,\n    p_name        VARCHAR(55) NOT NULL,\n    p_mfgr        VARCHAR(25) NOT NULL,\n    p_brand       VARCHAR(10) NOT NULL,\n    p_type        VARCHAR(25) NOT NULL,\n    p_size        int NOT NULL,\n    p_container   VARCHAR(10) NOT NULL,\n    p_retailprice decimal(15, 2) NOT NULL,\n    p_comment     VARCHAR(23) NOT NULL\n)ENGINE=OLAP\nDUPLICATE KEY(`p_partkey`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`p_partkey`) BUCKETS 24\nPROPERTIES (\n    "replication_num" = "1",\n    "colocate_with" = "tpch2p"\n);\n\n# \u521b\u5efa\u8868 partsupp\ndrop table if exists partsupp;\nCREATE TABLE partsupp ( \n    ps_partkey          int NOT NULL,\n    ps_suppkey     int NOT NULL,\n    ps_availqty    int NOT NULL,\n    ps_supplycost  decimal(15, 2)  NOT NULL,\n    ps_comment     VARCHAR(199) NOT NULL\n)ENGINE=OLAP\nDUPLICATE KEY(`ps_partkey`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`ps_partkey`) BUCKETS 24\nPROPERTIES (\n    "replication_num" = "1",\n    "colocate_with" = "tpch2p"\n);\n\n# \u521b\u5efa\u8868 region\ndrop table if exists region;\nCREATE TABLE region  ( \n    r_regionkey      int NOT NULL,\n    r_name       VARCHAR(25) NOT NULL,\n    r_comment    VARCHAR(152)\n)ENGINE=OLAP\nDUPLICATE KEY(`r_regionkey`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`r_regionkey`) BUCKETS 1\nPROPERTIES (\n    "replication_num" = "3"\n);\n\n# \u521b\u5efa\u8868 supplier\ndrop table if exists supplier;\nCREATE TABLE supplier (  \n    s_suppkey       int NOT NULL,\n    s_name        VARCHAR(25) NOT NULL,\n    s_address     VARCHAR(40) NOT NULL,\n    s_nationkey   int NOT NULL,\n    s_phone       VARCHAR(15) NOT NULL,\n    s_acctbal     decimal(15, 2) NOT NULL,\n    s_comment     VARCHAR(101) NOT NULL\n)ENGINE=OLAP\nDUPLICATE KEY(`s_suppkey`)\nCOMMENT "OLAP"\nDISTRIBUTED BY HASH(`s_suppkey`) BUCKETS 12\nPROPERTIES (\n    "replication_num" = "1"\n);\n\n\ndrop view if exists revenue0;\ncreate view revenue0 (supplier_no, total_revenue) as\nselect\n    l_suppkey,\n    sum(l_extendedprice * (1 - l_discount))\nfrom\n    lineitem\nwhere\n    l_shipdate >= date \'1996-01-01\'\n    and l_shipdate < date \'1996-01-01\' + interval \'3\' month\ngroup by\n    l_suppkey;\n'})}),"\n",(0,t.jsx)(e.h3,{id:"53-hive-\u5916\u90e8\u8868\u5efa\u8868orc-\u5b58\u50a8\u683c\u5f0f",children:"5.3 Hive \u5916\u90e8\u8868\u5efa\u8868\uff08ORC \u5b58\u50a8\u683c\u5f0f\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-SQL",children:"create database tpch_hive_orc;\nuse tpch_hive_orc;\n\n-- \u521b\u5efa\u8868 customer\nCREATE TABLE `customer`(\n  `c_custkey` int, \n  `c_name` varchar(25), \n  `c_address` varchar(40), \n  `c_nationkey` int, \n  `c_phone` varchar(15), \n  `c_acctbal` decimal(15,2), \n  `c_mktsegment` varchar(10), \n  `c_comment` varchar(117))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/customer';\n\n-- \u521b\u5efa\u8868 lineitem\n  CREATE TABLE `lineitem`(\n  `l_orderkey` bigint, \n  `l_partkey` int, \n  `l_suppkey` int, \n  `l_linenumber` int, \n  `l_quantity` decimal(15,2), \n  `l_extendedprice` decimal(15,2), \n  `l_discount` decimal(15,2), \n  `l_tax` decimal(15,2), \n  `l_returnflag` varchar(1), \n  `l_linestatus` varchar(1), \n  `l_shipdate` date, \n  `l_commitdate` date, \n  `l_receiptdate` date, \n  `l_shipinstruct` varchar(25), \n  `l_shipmode` varchar(10), \n  `l_comment` varchar(44))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/lineitem';\n\n-- \u521b\u5efa\u8868 nation\nCREATE TABLE `nation`(\n  `n_nationkey` int, \n  `n_name` varchar(25), \n  `n_regionkey` int, \n  `n_comment` varchar(152))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/nation';\n\n-- \u521b\u5efa\u8868 orders\nCREATE TABLE `orders`(\n  `o_orderkey` bigint, \n  `o_custkey` int, \n  `o_orderstatus` varchar(1), \n  `o_totalprice` decimal(15,2), \n  `o_orderdate` date, \n  `o_orderpriority` varchar(15), \n  `o_clerk` varchar(15), \n  `o_shippriority` int, \n  `o_comment` varchar(79))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/orders';\n\n-- \u521b\u5efa\u8868 part\nCREATE TABLE `part`(\n  `p_partkey` int, \n  `p_name` varchar(55), \n  `p_mfgr` varchar(25), \n  `p_brand` varchar(10), \n  `p_type` varchar(25), \n  `p_size` int, \n  `p_container` varchar(10), \n  `p_retailprice` decimal(15,2), \n  `p_comment` varchar(23))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/part';\n\n-- \u521b\u5efa\u8868 partsupp\nCREATE TABLE `partsupp`(\n  `ps_partkey` int, \n  `ps_suppkey` int, \n  `ps_availqty` int, \n  `ps_supplycost` decimal(15,2), \n  `ps_comment` varchar(199))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/partsupp';\n\n-- \u521b\u5efa\u8868 region\nCREATE TABLE `region`(\n  `r_regionkey` int, \n  `r_name` varchar(25), \n  `r_comment` varchar(152))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/region';\n\n-- \u521b\u5efa\u8868 supplier\nCREATE TABLE `supplier`(\n  `s_suppkey` int, \n  `s_name` varchar(25), \n  `s_address` varchar(40), \n  `s_nationkey` int, \n  `s_phone` varchar(15), \n  `s_acctbal` decimal(15,2), \n  `s_comment` varchar(101))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.ql.io.orc.OrcSerde' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/hive/warehouse/tpch_hive_orc.db/supplier';\n"})}),"\n",(0,t.jsx)(e.h3,{id:"54-hive-\u5916\u90e8\u8868\u5efa\u8868csv-\u5b58\u50a8\u683c\u5f0f",children:"5.4 Hive \u5916\u90e8\u8868\u5efa\u8868\uff08CSV \u5b58\u50a8\u683c\u5f0f\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-SQL",children:"create database tpch_hive_csv;\nuse tpch_hive_csv;\n\n-- \u521b\u5efa customer \u5916\u8868\nCREATE EXTERNAL TABLE `customer`(\n  `c_custkey` int, \n  `c_name` varchar(25), \n  `c_address` varchar(40), \n  `c_nationkey` int, \n  `c_phone` varchar(15), \n  `c_acctbal` double, \n  `c_mktsegment` varchar(10), \n  `c_comment` varchar(117))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/customer_csv';\n \n-- \u521b\u5efa lineitem \u5916\u8868\nCREATE EXTERNAL TABLE `lineitem`(\n  `l_orderkey` int, \n  `l_partkey` int, \n  `l_suppkey` int, \n  `l_linenumber` int, \n  `l_quantity` double, \n  `l_extendedprice` double, \n  `l_discount` double, \n  `l_tax` double, \n  `l_returnflag` varchar(1), \n  `l_linestatus` varchar(1), \n  `l_shipdate` date, \n  `l_commitdate` date, \n  `l_receiptdate` date, \n  `l_shipinstruct` varchar(25), \n  `l_shipmode` varchar(10), \n  `l_comment` varchar(44))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/lineitem_csv';\n \n\n-- \u521b\u5efa nation \u5916\u8868\nCREATE EXTERNAL TABLE `nation`(\n  `n_nationkey` int, \n  `n_name` varchar(25), \n  `n_regionkey` int, \n  `n_comment` varchar(152))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/nation_csv';\n  \n-- \u521b\u5efa orders \u5916\u8868\nCREATE EXTERNAL TABLE `orders`(\n  `o_orderkey` int, \n  `o_custkey` int, \n  `o_orderstatus` varchar(1), \n  `o_totalprice` double, \n  `o_orderdate` date, \n  `o_orderpriority` varchar(15), \n  `o_clerk` varchar(15), \n  `o_shippriority` int, \n  `o_comment` varchar(79))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/orders_csv';\n  \n-- \u521b\u5efa part \u5916\u8868\nCREATE EXTERNAL TABLE `part`(\n  `p_partkey` int, \n  `p_name` varchar(55), \n  `p_mfgr` varchar(25), \n  `p_brand` varchar(10), \n  `p_type` varchar(25), \n  `p_size` int, \n  `p_container` varchar(10), \n  `p_retailprice` double, \n  `p_comment` varchar(23))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/part_csv';\n  \n-- \u521b\u5efa partsupp \u5916\u8868\nCREATE EXTERNAL TABLE `partsupp`(\n  `ps_partkey` int, \n  `ps_suppkey` int, \n  `ps_availqty` int, \n  `ps_supplycost` double, \n  `ps_comment` varchar(199))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/partsupp_csv';\n  \n-- \u521b\u5efa region \u5916\u8868\nCREATE EXTERNAL TABLE `region`(\n  `r_regionkey` int, \n  `r_name` varchar(25), \n  `r_comment` varchar(152))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/region_csv';\n  \n-- \u521b\u5efa supplier \u5916\u8868\nCREATE EXTERNAL TABLE `supplier`(\n  `s_suppkey` int, \n  `s_name` varchar(25), \n  `s_address` varchar(40), \n  `s_nationkey` int, \n  `s_phone` varchar(15), \n  `s_acctbal` double, \n  `s_comment` varchar(101))\nROW FORMAT SERDE \n  'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' \nWITH SERDEPROPERTIES ( \n  'field.delim'='|', \n  'serialization.format'='|') \nSTORED AS INPUTFORMAT \n  'org.apache.hadoop.mapred.TextInputFormat' \nOUTPUTFORMAT \n  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'\nLOCATION\n  'hdfs://emr-header-1.cluster-49146:9000/user/tmp/csv/supplier_csv';\n"})})]})}const p=function(n={}){const{wrapper:e}=Object.assign({},(0,a.ah)(),n.components);return e?(0,t.jsx)(e,Object.assign({},n,{children:(0,t.jsx)(l,n)})):l(n)}},71629:(n,e,r)=>{r.d(e,{Z:()=>t});const t=r.p+"assets/images/tpch-c2ac4e648428201f0083970d29fb34ad.png"},11151:(n,e,r)=>{r.d(e,{Zo:()=>d,ah:()=>i});var t=r(67294);const a=t.createContext({});function i(n){const e=t.useContext(a);return t.useMemo((()=>"function"==typeof n?n(e):{...e,...n}),[e,n])}const s={};function d({components:n,children:e,disableParentContext:r}){let d;return d=r?"function"==typeof n?n({}):n||s:i(n),t.createElement(a.Provider,{value:d},e)}}}]);