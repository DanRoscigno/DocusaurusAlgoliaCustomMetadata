"use strict";(self.webpackChunkstarrocks=self.webpackChunkstarrocks||[]).push([[6399],{91865:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>_,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});var t=r(85893),s=r(11151);const c={},_="TPC-DS Benchmarking",i={id:"benchmarking/TPC_DS_Benchmark",title:"TPC-DS Benchmarking",description:"TPC-DS is a decision support benchmark developed by the Transaction Processing Performance Council (TPC). It uses more comprehensive test datasets and complex SQL queries than TPC-H.",source:"@site/versioned_docs/version-3.0/benchmarking/TPC_DS_Benchmark.md",sourceDirName:"benchmarking",slug:"/benchmarking/TPC_DS_Benchmark",permalink:"/doc/docs/3.0/benchmarking/TPC_DS_Benchmark",draft:!1,unlisted:!1,editUrl:"https://github.com/StarRocks/starrocks/tree/main/versioned_docs/version-3.0/benchmarking/TPC_DS_Benchmark.md",tags:[],version:"3.0",frontMatter:{},sidebar:"documentation",previous:{title:"TPC-H Benchmarking",permalink:"/doc/docs/3.0/benchmarking/TPC-H_Benchmarking"},next:{title:"TPC-DS test SQL",permalink:"/doc/docs/3.0/benchmarking/tpc_ds_99_sql"}},a={},d=[{value:"1. Test Conclusion",id:"1-test-conclusion",level:2},{value:"2. Test Preparation",id:"2-test-preparation",level:2},{value:"2.1 Hardware Environment",id:"21-hardware-environment",level:3},{value:"2.2 Software Environment",id:"22-software-environment",level:3},{value:"3. Test Data and Results",id:"3-test-data-and-results",level:2},{value:"3.1 Test Data",id:"31-test-data",level:3},{value:"3.2 Test Results",id:"32-test-results",level:3},{value:"4. Test Procedure",id:"4-test-procedure",level:2},{value:"4.1 Query StarRocks Native Table",id:"41-query-starrocks-native-table",level:3},{value:"4.1.1 Generate Data",id:"411-generate-data",level:4},{value:"4.1.2 Create Table Schema",id:"412-create-table-schema",level:4},{value:"4.1.3 Load Data",id:"413-load-data",level:4},{value:"4.1.4 Query Data",id:"414-query-data",level:4},{value:"4.2 Query Hive External Tables",id:"42-query-hive-external-tables",level:3},{value:"4.2.1 Create Table Schema",id:"421-create-table-schema",level:4},{value:"4.2.2 Load Data",id:"422-load-data",level:4},{value:"4.2.3 Collect Statistics",id:"423-collect-statistics",level:4},{value:"4.2.4 Query Data",id:"424-query-data",level:4},{value:"5. Query statements and CREATE TABLE statements",id:"5-query-statements-and-create-table-statements",level:2},{value:"5.1 TPC-DS SQL queries",id:"51-tpc-ds-sql-queries",level:3},{value:"5.2 Create a StarRocks native table",id:"52-create-a-starrocks-native-table",level:3},{value:"5.3 Create Hive external tables\uff08Parquet)",id:"53-create-hive-external-tablesparquet",level:3},{value:"5.4 Create Hive external tables\uff08CSV\uff09",id:"54-create-hive-external-tablescsv",level:3}];function l(e){const n=Object.assign({h1:"h1",p:"p",h2:"h2",img:"img",strong:"strong",h3:"h3",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",ul:"ul",li:"li",blockquote:"blockquote",code:"code",h4:"h4",pre:"pre",a:"a"},(0,s.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"tpc-ds-benchmarking",children:"TPC-DS Benchmarking"}),"\n",(0,t.jsx)(n.p,{children:"TPC-DS is a decision support benchmark developed by the Transaction Processing Performance Council (TPC). It uses more comprehensive test datasets and complex SQL queries than TPC-H."}),"\n",(0,t.jsx)(n.p,{children:"TPC-DS models several generally applicable aspects of a decision support system, including queries and data maintenance. TPC-DS aims to provide a comprehensive and realistic workload for testing and evaluating the performance of database systems in a retail environment. The TPC-DS benchmark simulates the sales and return data of three sales channels (stores, Internet, and catalog) in a retail enterprise. In addition to creating tables for sales and return data models, it also includes a simple inventory system and a promotion system."}),"\n",(0,t.jsx)(n.p,{children:"This benchmark tests a total of 99 complex SQL queries against 24 tables whose data size ranges from 1 GB to 3 GB. The main performance metric is the response time of each query, which is the duration between the time a query is submitted to the time the result is returned."}),"\n",(0,t.jsx)(n.h2,{id:"1-test-conclusion",children:"1. Test Conclusion"}),"\n",(0,t.jsxs)(n.p,{children:["We perform a test on 99 queries against a TPC-DS 100 GB dataset. The following figure shows the test result.\n",(0,t.jsx)(n.img,{alt:"tpc-ds",src:r(36121).Z+"",width:"1280",height:"585"})]}),"\n",(0,t.jsx)(n.p,{children:"In the test, StarRocks queries data from both its native storage and Hive external tables. StarRocks and Trino query the same copy of data from Hive external tables. Data is LZ4-compressed and stored in the Parquet format."}),"\n",(0,t.jsxs)(n.p,{children:["The latency for StarRocks to query data from its native storage is ",(0,t.jsx)(n.strong,{children:"174s"}),", that for StarRocks to query Hive external tables is ",(0,t.jsx)(n.strong,{children:"239s"}),", that for StarRocks to query Hive external tables with the Data Cache feature enabled is ",(0,t.jsx)(n.strong,{children:"176s"}),", and that for Trino to query Hive external tables is ",(0,t.jsx)(n.strong,{children:"892s"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"2-test-preparation",children:"2. Test Preparation"}),"\n",(0,t.jsx)(n.h3,{id:"21-hardware-environment",children:"2.1 Hardware Environment"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Machine"}),(0,t.jsx)(n.th,{children:"4 cloud hosts"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"CPU"}),(0,t.jsx)(n.td,{children:"8core Intel(R) Xeon(R) Platinum 8269CY CPU @ 2.50GHz"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Memory"}),(0,t.jsx)(n.td,{children:"32 GB"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Network bandwidth"}),(0,t.jsx)(n.td,{children:"5 Gbit/s"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Disk"}),(0,t.jsx)(n.td,{children:"ESSD"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"22-software-environment",children:"2.2 Software Environment"}),"\n",(0,t.jsx)(n.p,{children:"StarRocks and Trino are deployed on machines with the same configuration. StarRocks has 1 FE and 3 BEs deployed. Trino has 1 Coordinator and 3 Workers deployed."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Kernel version: Linux 3.10.0-1127.13.1.el7.x86_64"}),"\n",(0,t.jsx)(n.li,{children:"OS version: CentOS Linux released 7.8.2003"}),"\n",(0,t.jsx)(n.li,{children:"Software version: StarRocks Community Edition 3.1, Trino-419, Hive-3.1.2"}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"The StarRocks FE can be separately deployed or hybrid deployed with BEs, which does not affect the test results."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"3-test-data-and-results",children:"3. Test Data and Results"}),"\n",(0,t.jsx)(n.h3,{id:"31-test-data",children:"3.1 Test Data"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Table"}),(0,t.jsx)(n.th,{children:"Records"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"call_center"}),(0,t.jsx)(n.td,{children:"30"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"catalog_page"}),(0,t.jsx)(n.td,{children:"20400"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"catalog_returns"}),(0,t.jsx)(n.td,{children:"14404374"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"catalog_sales"}),(0,t.jsx)(n.td,{children:"143997065"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"customer_address"}),(0,t.jsx)(n.td,{children:"1000000"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"customer_demographics"}),(0,t.jsx)(n.td,{children:"1920800"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"customer"}),(0,t.jsx)(n.td,{children:"2000000"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"date_dim"}),(0,t.jsx)(n.td,{children:"73049"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"household_demographics"}),(0,t.jsx)(n.td,{children:"7200"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"income_band"}),(0,t.jsx)(n.td,{children:"20"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"inventory"}),(0,t.jsx)(n.td,{children:"399330000"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"item"}),(0,t.jsx)(n.td,{children:"204000"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"promotion"}),(0,t.jsx)(n.td,{children:"1000"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"reason"}),(0,t.jsx)(n.td,{children:"55"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"ship_mode"}),(0,t.jsx)(n.td,{children:"20"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"store"}),(0,t.jsx)(n.td,{children:"402"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"store_returns"}),(0,t.jsx)(n.td,{children:"28795080"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"store_sales"}),(0,t.jsx)(n.td,{children:"287997024"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"time_dim"}),(0,t.jsx)(n.td,{children:"86400"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"warehouse"}),(0,t.jsx)(n.td,{children:"15"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"web_page"}),(0,t.jsx)(n.td,{children:"2040"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"web_returns"}),(0,t.jsx)(n.td,{children:"7197670"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"web_sales"}),(0,t.jsx)(n.td,{children:"72001237"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"web_site"}),(0,t.jsx)(n.td,{children:"24"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"32-test-results",children:"3.2 Test Results"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"NOTE"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The unit of query latency in the following table is ms."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"StarRocks-3.0.5-native"})," indicates StarRocks native storage, ",(0,t.jsx)(n.code,{children:"StarRocks-3.0-Hive external"})," indicates StarRocks queries Hive external tables through Hive Catalog, ",(0,t.jsx)(n.code,{children:"StarRocks-3.0-Hive external-Cache"})," indicates StarRocks queries Hive external tables through Hive Catalog with Data Cache enabled."]}),"\n",(0,t.jsxs)(n.li,{children:["Aggregate pushdown is enabled for StarRocks (",(0,t.jsx)(n.code,{children:"SET global cbo_push_down_aggregate_mode = 0"}),")."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Query"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"StarRocks-3.0.5-native"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"StarRocks-3.0-Hive external"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"StarRocks-3.0-Hive external-Cache"})}),(0,t.jsx)(n.th,{children:(0,t.jsx)(n.strong,{children:"Trino-419"})})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"SUM"}),(0,t.jsx)(n.td,{children:"174157"}),(0,t.jsx)(n.td,{children:"238590"}),(0,t.jsx)(n.td,{children:"175970"}),(0,t.jsx)(n.td,{children:"891892"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q1"}),(0,t.jsx)(n.td,{children:"274"}),(0,t.jsx)(n.td,{children:"780"}),(0,t.jsx)(n.td,{children:"254"}),(0,t.jsx)(n.td,{children:"1681"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q2"}),(0,t.jsx)(n.td,{children:"338"}),(0,t.jsx)(n.td,{children:"676"}),(0,t.jsx)(n.td,{children:"397"}),(0,t.jsx)(n.td,{children:"10200"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q3"}),(0,t.jsx)(n.td,{children:"455"}),(0,t.jsx)(n.td,{children:"1156"}),(0,t.jsx)(n.td,{children:"628"}),(0,t.jsx)(n.td,{children:"3156"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q4"}),(0,t.jsx)(n.td,{children:"16180"}),(0,t.jsx)(n.td,{children:"13229"}),(0,t.jsx)(n.td,{children:"12623"}),(0,t.jsx)(n.td,{children:"48176"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q5"}),(0,t.jsx)(n.td,{children:"1162"}),(0,t.jsx)(n.td,{children:"773"}),(0,t.jsx)(n.td,{children:"506"}),(0,t.jsx)(n.td,{children:"4490"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q6"}),(0,t.jsx)(n.td,{children:"397"}),(0,t.jsx)(n.td,{children:"606"}),(0,t.jsx)(n.td,{children:"165"}),(0,t.jsx)(n.td,{children:"1349"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q7"}),(0,t.jsx)(n.td,{children:"898"}),(0,t.jsx)(n.td,{children:"1707"}),(0,t.jsx)(n.td,{children:"724"}),(0,t.jsx)(n.td,{children:"2300"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q8"}),(0,t.jsx)(n.td,{children:"532"}),(0,t.jsx)(n.td,{children:"447"}),(0,t.jsx)(n.td,{children:"141"}),(0,t.jsx)(n.td,{children:"2330"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q9"}),(0,t.jsx)(n.td,{children:"2113"}),(0,t.jsx)(n.td,{children:"7998"}),(0,t.jsx)(n.td,{children:"6336"}),(0,t.jsx)(n.td,{children:"17734"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q10"}),(0,t.jsx)(n.td,{children:"588"}),(0,t.jsx)(n.td,{children:"847"}),(0,t.jsx)(n.td,{children:"285"}),(0,t.jsx)(n.td,{children:"2498"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q11"}),(0,t.jsx)(n.td,{children:"6465"}),(0,t.jsx)(n.td,{children:"5086"}),(0,t.jsx)(n.td,{children:"4665"}),(0,t.jsx)(n.td,{children:"31333"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q12"}),(0,t.jsx)(n.td,{children:"149"}),(0,t.jsx)(n.td,{children:"302"}),(0,t.jsx)(n.td,{children:"135"}),(0,t.jsx)(n.td,{children:"728"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q13"}),(0,t.jsx)(n.td,{children:"1573"}),(0,t.jsx)(n.td,{children:"2661"}),(0,t.jsx)(n.td,{children:"1349"}),(0,t.jsx)(n.td,{children:"4370"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q14"}),(0,t.jsx)(n.td,{children:"7928"}),(0,t.jsx)(n.td,{children:"7811"}),(0,t.jsx)(n.td,{children:"5955"}),(0,t.jsx)(n.td,{children:"69729"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q15"}),(0,t.jsx)(n.td,{children:"323"}),(0,t.jsx)(n.td,{children:"461"}),(0,t.jsx)(n.td,{children:"199"}),(0,t.jsx)(n.td,{children:"1522"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q16"}),(0,t.jsx)(n.td,{children:"639"}),(0,t.jsx)(n.td,{children:"1278"}),(0,t.jsx)(n.td,{children:"661"}),(0,t.jsx)(n.td,{children:"3282"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q17"}),(0,t.jsx)(n.td,{children:"1157"}),(0,t.jsx)(n.td,{children:"898"}),(0,t.jsx)(n.td,{children:"682"}),(0,t.jsx)(n.td,{children:"4102"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q18"}),(0,t.jsx)(n.td,{children:"540"}),(0,t.jsx)(n.td,{children:"1746"}),(0,t.jsx)(n.td,{children:"521"}),(0,t.jsx)(n.td,{children:"2471"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q19"}),(0,t.jsx)(n.td,{children:"667"}),(0,t.jsx)(n.td,{children:"639"}),(0,t.jsx)(n.td,{children:"230"}),(0,t.jsx)(n.td,{children:"1701"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q20"}),(0,t.jsx)(n.td,{children:"209"}),(0,t.jsx)(n.td,{children:"369"}),(0,t.jsx)(n.td,{children:"144"}),(0,t.jsx)(n.td,{children:"849"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q21"}),(0,t.jsx)(n.td,{children:"466"}),(0,t.jsx)(n.td,{children:"586"}),(0,t.jsx)(n.td,{children:"306"}),(0,t.jsx)(n.td,{children:"1591"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q22"}),(0,t.jsx)(n.td,{children:"3876"}),(0,t.jsx)(n.td,{children:"4704"}),(0,t.jsx)(n.td,{children:"4536"}),(0,t.jsx)(n.td,{children:"17422"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q23"}),(0,t.jsx)(n.td,{children:"24500"}),(0,t.jsx)(n.td,{children:"24746"}),(0,t.jsx)(n.td,{children:"21707"}),(0,t.jsx)(n.td,{children:"145850"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q24"}),(0,t.jsx)(n.td,{children:"1256"}),(0,t.jsx)(n.td,{children:"5220"}),(0,t.jsx)(n.td,{children:"3219"}),(0,t.jsx)(n.td,{children:"21234"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q25"}),(0,t.jsx)(n.td,{children:"1037"}),(0,t.jsx)(n.td,{children:"792"}),(0,t.jsx)(n.td,{children:"542"}),(0,t.jsx)(n.td,{children:"3702"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q26"}),(0,t.jsx)(n.td,{children:"393"}),(0,t.jsx)(n.td,{children:"834"}),(0,t.jsx)(n.td,{children:"360"}),(0,t.jsx)(n.td,{children:"1737"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q27"}),(0,t.jsx)(n.td,{children:"742"}),(0,t.jsx)(n.td,{children:"1303"}),(0,t.jsx)(n.td,{children:"696"}),(0,t.jsx)(n.td,{children:"2396"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q28"}),(0,t.jsx)(n.td,{children:"1864"}),(0,t.jsx)(n.td,{children:"8600"}),(0,t.jsx)(n.td,{children:"6564"}),(0,t.jsx)(n.td,{children:"15837"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q29"}),(0,t.jsx)(n.td,{children:"1097"}),(0,t.jsx)(n.td,{children:"1134"}),(0,t.jsx)(n.td,{children:"888"}),(0,t.jsx)(n.td,{children:"4024"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q30"}),(0,t.jsx)(n.td,{children:"194"}),(0,t.jsx)(n.td,{children:"669"}),(0,t.jsx)(n.td,{children:"242"}),(0,t.jsx)(n.td,{children:"1922"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q31"}),(0,t.jsx)(n.td,{children:"1149"}),(0,t.jsx)(n.td,{children:"1070"}),(0,t.jsx)(n.td,{children:"834"}),(0,t.jsx)(n.td,{children:"5431"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q32"}),(0,t.jsx)(n.td,{children:"222"}),(0,t.jsx)(n.td,{children:"718"}),(0,t.jsx)(n.td,{children:"104"}),(0,t.jsx)(n.td,{children:"1706"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q33"}),(0,t.jsx)(n.td,{children:"922"}),(0,t.jsx)(n.td,{children:"735"}),(0,t.jsx)(n.td,{children:"327"}),(0,t.jsx)(n.td,{children:"2048"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q34"}),(0,t.jsx)(n.td,{children:"544"}),(0,t.jsx)(n.td,{children:"1392"}),(0,t.jsx)(n.td,{children:"576"}),(0,t.jsx)(n.td,{children:"3185"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q35"}),(0,t.jsx)(n.td,{children:"974"}),(0,t.jsx)(n.td,{children:"897"}),(0,t.jsx)(n.td,{children:"574"}),(0,t.jsx)(n.td,{children:"3050"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q36"}),(0,t.jsx)(n.td,{children:"630"}),(0,t.jsx)(n.td,{children:"1009"}),(0,t.jsx)(n.td,{children:"464"}),(0,t.jsx)(n.td,{children:"3056"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q37"}),(0,t.jsx)(n.td,{children:"246"}),(0,t.jsx)(n.td,{children:"791"}),(0,t.jsx)(n.td,{children:"273"}),(0,t.jsx)(n.td,{children:"3258"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q38"}),(0,t.jsx)(n.td,{children:"2831"}),(0,t.jsx)(n.td,{children:"2017"}),(0,t.jsx)(n.td,{children:"1695"}),(0,t.jsx)(n.td,{children:"10913"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q39"}),(0,t.jsx)(n.td,{children:"1057"}),(0,t.jsx)(n.td,{children:"2312"}),(0,t.jsx)(n.td,{children:"1324"}),(0,t.jsx)(n.td,{children:"10665"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q40"}),(0,t.jsx)(n.td,{children:"331"}),(0,t.jsx)(n.td,{children:"560"}),(0,t.jsx)(n.td,{children:"209"}),(0,t.jsx)(n.td,{children:"2678"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q41"}),(0,t.jsx)(n.td,{children:"57"}),(0,t.jsx)(n.td,{children:"148"}),(0,t.jsx)(n.td,{children:"79"}),(0,t.jsx)(n.td,{children:"776"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q42"}),(0,t.jsx)(n.td,{children:"463"}),(0,t.jsx)(n.td,{children:"559"}),(0,t.jsx)(n.td,{children:"106"}),(0,t.jsx)(n.td,{children:"1213"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q43"}),(0,t.jsx)(n.td,{children:"885"}),(0,t.jsx)(n.td,{children:"602"}),(0,t.jsx)(n.td,{children:"342"}),(0,t.jsx)(n.td,{children:"2914"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q44"}),(0,t.jsx)(n.td,{children:"506"}),(0,t.jsx)(n.td,{children:"3783"}),(0,t.jsx)(n.td,{children:"2306"}),(0,t.jsx)(n.td,{children:"9705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q45"}),(0,t.jsx)(n.td,{children:"439"}),(0,t.jsx)(n.td,{children:"777"}),(0,t.jsx)(n.td,{children:"309"}),(0,t.jsx)(n.td,{children:"1012"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q46"}),(0,t.jsx)(n.td,{children:"868"}),(0,t.jsx)(n.td,{children:"1746"}),(0,t.jsx)(n.td,{children:"1037"}),(0,t.jsx)(n.td,{children:"4766"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q47"}),(0,t.jsx)(n.td,{children:"1816"}),(0,t.jsx)(n.td,{children:"2979"}),(0,t.jsx)(n.td,{children:"2684"}),(0,t.jsx)(n.td,{children:"19111"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q48"}),(0,t.jsx)(n.td,{children:"635"}),(0,t.jsx)(n.td,{children:"2038"}),(0,t.jsx)(n.td,{children:"1202"}),(0,t.jsx)(n.td,{children:"3635"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q49"}),(0,t.jsx)(n.td,{children:"1440"}),(0,t.jsx)(n.td,{children:"2754"}),(0,t.jsx)(n.td,{children:"1168"}),(0,t.jsx)(n.td,{children:"3435"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q50"}),(0,t.jsx)(n.td,{children:"836"}),(0,t.jsx)(n.td,{children:"2053"}),(0,t.jsx)(n.td,{children:"1305"}),(0,t.jsx)(n.td,{children:"4375"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q51"}),(0,t.jsx)(n.td,{children:"3966"}),(0,t.jsx)(n.td,{children:"5258"}),(0,t.jsx)(n.td,{children:"4466"}),(0,t.jsx)(n.td,{children:"14283"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q52"}),(0,t.jsx)(n.td,{children:"483"}),(0,t.jsx)(n.td,{children:"436"}),(0,t.jsx)(n.td,{children:"100"}),(0,t.jsx)(n.td,{children:"1126"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q53"}),(0,t.jsx)(n.td,{children:"698"}),(0,t.jsx)(n.td,{children:"802"}),(0,t.jsx)(n.td,{children:"391"}),(0,t.jsx)(n.td,{children:"1648"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q54"}),(0,t.jsx)(n.td,{children:"794"}),(0,t.jsx)(n.td,{children:"970"}),(0,t.jsx)(n.td,{children:"534"}),(0,t.jsx)(n.td,{children:"5146"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q55"}),(0,t.jsx)(n.td,{children:"463"}),(0,t.jsx)(n.td,{children:"540"}),(0,t.jsx)(n.td,{children:"97"}),(0,t.jsx)(n.td,{children:"963"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q56"}),(0,t.jsx)(n.td,{children:"874"}),(0,t.jsx)(n.td,{children:"695"}),(0,t.jsx)(n.td,{children:"240"}),(0,t.jsx)(n.td,{children:"2110"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q57"}),(0,t.jsx)(n.td,{children:"1717"}),(0,t.jsx)(n.td,{children:"2723"}),(0,t.jsx)(n.td,{children:"2372"}),(0,t.jsx)(n.td,{children:"10203"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q58"}),(0,t.jsx)(n.td,{children:"554"}),(0,t.jsx)(n.td,{children:"727"}),(0,t.jsx)(n.td,{children:"242"}),(0,t.jsx)(n.td,{children:"2053"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q59"}),(0,t.jsx)(n.td,{children:"2764"}),(0,t.jsx)(n.td,{children:"1581"}),(0,t.jsx)(n.td,{children:"1368"}),(0,t.jsx)(n.td,{children:"15697"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q60"}),(0,t.jsx)(n.td,{children:"1053"}),(0,t.jsx)(n.td,{children:"557"}),(0,t.jsx)(n.td,{children:"389"}),(0,t.jsx)(n.td,{children:"2421"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q61"}),(0,t.jsx)(n.td,{children:"1353"}),(0,t.jsx)(n.td,{children:"1026"}),(0,t.jsx)(n.td,{children:"439"}),(0,t.jsx)(n.td,{children:"2334"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q62"}),(0,t.jsx)(n.td,{children:"453"}),(0,t.jsx)(n.td,{children:"659"}),(0,t.jsx)(n.td,{children:"427"}),(0,t.jsx)(n.td,{children:"2422"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q63"}),(0,t.jsx)(n.td,{children:"709"}),(0,t.jsx)(n.td,{children:"943"}),(0,t.jsx)(n.td,{children:"374"}),(0,t.jsx)(n.td,{children:"1624"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q64"}),(0,t.jsx)(n.td,{children:"3209"}),(0,t.jsx)(n.td,{children:"6968"}),(0,t.jsx)(n.td,{children:"6175"}),(0,t.jsx)(n.td,{children:"31994"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q65"}),(0,t.jsx)(n.td,{children:"2147"}),(0,t.jsx)(n.td,{children:"3043"}),(0,t.jsx)(n.td,{children:"2451"}),(0,t.jsx)(n.td,{children:"9334"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q66"}),(0,t.jsx)(n.td,{children:"688"}),(0,t.jsx)(n.td,{children:"805"}),(0,t.jsx)(n.td,{children:"437"}),(0,t.jsx)(n.td,{children:"2598"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q67"}),(0,t.jsx)(n.td,{children:"15486"}),(0,t.jsx)(n.td,{children:"23743"}),(0,t.jsx)(n.td,{children:"21975"}),(0,t.jsx)(n.td,{children:"58091"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q68"}),(0,t.jsx)(n.td,{children:"965"}),(0,t.jsx)(n.td,{children:"1702"}),(0,t.jsx)(n.td,{children:"776"}),(0,t.jsx)(n.td,{children:"2710"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q69"}),(0,t.jsx)(n.td,{children:"600"}),(0,t.jsx)(n.td,{children:"703"}),(0,t.jsx)(n.td,{children:"263"}),(0,t.jsx)(n.td,{children:"2872"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q70"}),(0,t.jsx)(n.td,{children:"2376"}),(0,t.jsx)(n.td,{children:"2217"}),(0,t.jsx)(n.td,{children:"1588"}),(0,t.jsx)(n.td,{children:"10272"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q71"}),(0,t.jsx)(n.td,{children:"702"}),(0,t.jsx)(n.td,{children:"691"}),(0,t.jsx)(n.td,{children:"348"}),(0,t.jsx)(n.td,{children:"3074"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q72"}),(0,t.jsx)(n.td,{children:"1764"}),(0,t.jsx)(n.td,{children:"2733"}),(0,t.jsx)(n.td,{children:"2305"}),(0,t.jsx)(n.td,{children:"13973"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q73"}),(0,t.jsx)(n.td,{children:"576"}),(0,t.jsx)(n.td,{children:"1145"}),(0,t.jsx)(n.td,{children:"484"}),(0,t.jsx)(n.td,{children:"1899"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q74"}),(0,t.jsx)(n.td,{children:"4615"}),(0,t.jsx)(n.td,{children:"3884"}),(0,t.jsx)(n.td,{children:"3776"}),(0,t.jsx)(n.td,{children:"18749"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q75"}),(0,t.jsx)(n.td,{children:"2661"}),(0,t.jsx)(n.td,{children:"3479"}),(0,t.jsx)(n.td,{children:"3137"}),(0,t.jsx)(n.td,{children:"10858"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q76"}),(0,t.jsx)(n.td,{children:"450"}),(0,t.jsx)(n.td,{children:"2001"}),(0,t.jsx)(n.td,{children:"1014"}),(0,t.jsx)(n.td,{children:"5297"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q77"}),(0,t.jsx)(n.td,{children:"1109"}),(0,t.jsx)(n.td,{children:"743"}),(0,t.jsx)(n.td,{children:"317"}),(0,t.jsx)(n.td,{children:"2810"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q78"}),(0,t.jsx)(n.td,{children:"6540"}),(0,t.jsx)(n.td,{children:"7198"}),(0,t.jsx)(n.td,{children:"5890"}),(0,t.jsx)(n.td,{children:"19671"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q79"}),(0,t.jsx)(n.td,{children:"1116"}),(0,t.jsx)(n.td,{children:"1953"}),(0,t.jsx)(n.td,{children:"1121"}),(0,t.jsx)(n.td,{children:"4406"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q80"}),(0,t.jsx)(n.td,{children:"2290"}),(0,t.jsx)(n.td,{children:"1973"}),(0,t.jsx)(n.td,{children:"1480"}),(0,t.jsx)(n.td,{children:"5865"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q81"}),(0,t.jsx)(n.td,{children:"247"}),(0,t.jsx)(n.td,{children:"1024"}),(0,t.jsx)(n.td,{children:"317"}),(0,t.jsx)(n.td,{children:"1729"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q82"}),(0,t.jsx)(n.td,{children:"392"}),(0,t.jsx)(n.td,{children:"929"}),(0,t.jsx)(n.td,{children:"407"}),(0,t.jsx)(n.td,{children:"3605"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q83"}),(0,t.jsx)(n.td,{children:"134"}),(0,t.jsx)(n.td,{children:"313"}),(0,t.jsx)(n.td,{children:"158"}),(0,t.jsx)(n.td,{children:"1209"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q84"}),(0,t.jsx)(n.td,{children:"107"}),(0,t.jsx)(n.td,{children:"820"}),(0,t.jsx)(n.td,{children:"228"}),(0,t.jsx)(n.td,{children:"2448"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q85"}),(0,t.jsx)(n.td,{children:"460"}),(0,t.jsx)(n.td,{children:"2045"}),(0,t.jsx)(n.td,{children:"621"}),(0,t.jsx)(n.td,{children:"4311"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q86"}),(0,t.jsx)(n.td,{children:"433"}),(0,t.jsx)(n.td,{children:"999"}),(0,t.jsx)(n.td,{children:"387"}),(0,t.jsx)(n.td,{children:"1693"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q87"}),(0,t.jsx)(n.td,{children:"2873"}),(0,t.jsx)(n.td,{children:"2159"}),(0,t.jsx)(n.td,{children:"1779"}),(0,t.jsx)(n.td,{children:"10709"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q88"}),(0,t.jsx)(n.td,{children:"3616"}),(0,t.jsx)(n.td,{children:"7076"}),(0,t.jsx)(n.td,{children:"5432"}),(0,t.jsx)(n.td,{children:"26002"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q89"}),(0,t.jsx)(n.td,{children:"735"}),(0,t.jsx)(n.td,{children:"785"}),(0,t.jsx)(n.td,{children:"454"}),(0,t.jsx)(n.td,{children:"1997"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q90"}),(0,t.jsx)(n.td,{children:"174"}),(0,t.jsx)(n.td,{children:"898"}),(0,t.jsx)(n.td,{children:"232"}),(0,t.jsx)(n.td,{children:"2585"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q91"}),(0,t.jsx)(n.td,{children:"113"}),(0,t.jsx)(n.td,{children:"495"}),(0,t.jsx)(n.td,{children:"139"}),(0,t.jsx)(n.td,{children:"1745"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q92"}),(0,t.jsx)(n.td,{children:"203"}),(0,t.jsx)(n.td,{children:"627"}),(0,t.jsx)(n.td,{children:"91"}),(0,t.jsx)(n.td,{children:"1016"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q93"}),(0,t.jsx)(n.td,{children:"529"}),(0,t.jsx)(n.td,{children:"2508"}),(0,t.jsx)(n.td,{children:"1422"}),(0,t.jsx)(n.td,{children:"12265"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q94"}),(0,t.jsx)(n.td,{children:"475"}),(0,t.jsx)(n.td,{children:"811"}),(0,t.jsx)(n.td,{children:"598"}),(0,t.jsx)(n.td,{children:"2153"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q95"}),(0,t.jsx)(n.td,{children:"1059"}),(0,t.jsx)(n.td,{children:"1993"}),(0,t.jsx)(n.td,{children:"1526"}),(0,t.jsx)(n.td,{children:"8058"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q96"}),(0,t.jsx)(n.td,{children:"395"}),(0,t.jsx)(n.td,{children:"1197"}),(0,t.jsx)(n.td,{children:"681"}),(0,t.jsx)(n.td,{children:"3976"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q97"}),(0,t.jsx)(n.td,{children:"3000"}),(0,t.jsx)(n.td,{children:"3459"}),(0,t.jsx)(n.td,{children:"2860"}),(0,t.jsx)(n.td,{children:"6818"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q98"}),(0,t.jsx)(n.td,{children:"419"}),(0,t.jsx)(n.td,{children:"486"}),(0,t.jsx)(n.td,{children:"344"}),(0,t.jsx)(n.td,{children:"2090"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Q99"}),(0,t.jsx)(n.td,{children:"755"}),(0,t.jsx)(n.td,{children:"1070"}),(0,t.jsx)(n.td,{children:"740"}),(0,t.jsx)(n.td,{children:"4332"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"4-test-procedure",children:"4. Test Procedure"}),"\n",(0,t.jsx)(n.h3,{id:"41-query-starrocks-native-table",children:"4.1 Query StarRocks Native Table"}),"\n",(0,t.jsx)(n.h4,{id:"411-generate-data",children:"4.1.1 Generate Data"}),"\n",(0,t.jsxs)(n.p,{children:["Download the tpcds-poc toolkit and generate the standard TPC-DS test dataset ",(0,t.jsx)(n.code,{children:"scale factor=100"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Bash",children:"wget https://starrocks-public.oss-cn-zhangjiakou.aliyuncs.com/tpcds-poc-1.0.zip\nunzip tpcds-poc-1.0\ncd tpcds-poc-1.0\n\nsh bin/gen_data/gen-tpcds.sh 100 data_100\n"})}),"\n",(0,t.jsx)(n.h4,{id:"412-create-table-schema",children:"4.1.2 Create Table Schema"}),"\n",(0,t.jsxs)(n.p,{children:["Modify the configuration file ",(0,t.jsx)(n.code,{children:"conf/starrocks.conf"})," and specify the cluster address. Pay attention to ",(0,t.jsx)(n.code,{children:"mysql_host"})," and ",(0,t.jsx)(n.code,{children:"mysql_port"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Bash",children:"sh bin/create_db_table.sh ddl_100\n"})}),"\n",(0,t.jsx)(n.h4,{id:"413-load-data",children:"4.1.3 Load Data"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Bash",children:"sh bin/stream_load.sh data_100\n"})}),"\n",(0,t.jsx)(n.h4,{id:"414-query-data",children:"4.1.4 Query Data"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-Bash",children:"sh bin/benchmark.sh -p -d tpcds\n"})}),"\n",(0,t.jsx)(n.h3,{id:"42-query-hive-external-tables",children:"4.2 Query Hive External Tables"}),"\n",(0,t.jsx)(n.h4,{id:"421-create-table-schema",children:"4.2.1 Create Table Schema"}),"\n",(0,t.jsxs)(n.p,{children:["Create external tables in Hive, whose storage format is Parquet and compression format is LZ4. For detailed CREATE TABLE statements, see ",(0,t.jsx)(n.a,{href:"#53-create-a-hive-external-tableparquet",children:"Create Parquet Hive external tables"}),". StarRocks and Trino query data from these external tables."]}),"\n",(0,t.jsx)(n.h4,{id:"422-load-data",children:"4.2.2 Load Data"}),"\n",(0,t.jsxs)(n.p,{children:["Load the CSV data generated in ",(0,t.jsx)(n.a,{href:"#411-generate-data",children:"4.1.1"})," to the specified HDFS path of Hive. This example uses ",(0,t.jsx)(n.code,{children:"/user/tmp/csv/"})," as the HDFS path. Create CSV Hive external tables in Hive and store the tables in ",(0,t.jsx)(n.code,{children:"/user/tmp/csv/"}),". For detailed CREATE TABLE statements, see ",(0,t.jsx)(n.a,{href:"#54-create-a-hive-external-tablecsv",children:"Create CSV Hive external tables"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Use INSERT INTO to load data from CSV external tables to Parquet external tables. This generates LZ4-compressed Parquet data."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"use tpcds_100g_parquet_lz4;\n\ninsert into call_center select * from tpcds_100g_csv.call_center order by cc_call_center_sk;\ninsert into catalog_page select * from tpcds_100g_csv.catalog_page order by cp_catalog_page_sk;\ninsert into catalog_returns select * from tpcds_100g_csv.catalog_returns order by cr_returned_date_sk, cr_item_sk;\ninsert into date_dim select * from tpcds_100g_csv.date_dim order by D_DATE_SK;\ninsert into household_demographics select * from tpcds_100g_csv.household_demographics order by HD_DEMO_SK;\ninsert into income_band select * from tpcds_100g_csv.income_band order by IB_INCOME_BAND_SK;\ninsert into item select * from tpcds_100g_csv.item order by I_ITEM_SK;\ninsert into promotion select * from tpcds_100g_csv.promotion  order by P_PROMO_SK;\ninsert into reason select * from tpcds_100g_csv.reason a order by a.R_REASON_SK;\ninsert into ship_mode select * from tpcds_100g_csv.ship_mode order by SM_SHIP_MODE_SK;\ninsert into store select * from tpcds_100g_csv.store order by S_STORE_SK;\ninsert into time_dim select * from tpcds_100g_csv.time_dim order by T_TIME_SK;\ninsert into warehouse select * from tpcds_100g_csv.warehouse order by W_WAREHOUSE_SK;\ninsert into web_page select * from tpcds_100g_csv.web_page order by WP_WEB_PAGE_SK;\ninsert into web_site select * from tpcds_100g_csv.web_site order by WEB_SITE_SK;\ninsert into customer_demographics select * from tpcds_100g_csv.customer_demographics order by CD_DEMO_SK;\ninsert into customer select * from tpcds_100g_csv.customer order by C_CUSTOMER_SK;\ninsert into customer_address select * from tpcds_100g_csv.customer_address order by CA_ADDRESS_SK;\ninsert into web_sales select * from tpcds_100g_csv.web_sales order by WS_SOLD_DATE_SK, WS_ITEM_SK;\ninsert into web_returns select * from tpcds_100g_csv.web_returns order by WR_RETURNED_DATE_SK, WR_ITEM_SK;\ninsert into inventory select * from tpcds_100g_csv.inventory order by INV_DATE_SK, INV_ITEM_SK;\ninsert into catalog_sales select * from tpcds_100g_csv.catalog_sales order by CS_SOLD_DATE_SK, CS_ITEM_SK;\ninsert into store_returns select * from tpcds_100g_csv.store_returns order by SR_RETURNED_DATE_SK, SR_ITEM_SK;\ninsert into store_sales select * from tpcds_100g_csv.store_sales order by SS_SOLD_DATE_SK, SS_ITEM_SK;\n"})}),"\n",(0,t.jsx)(n.h4,{id:"423-collect-statistics",children:"4.2.3 Collect Statistics"}),"\n",(0,t.jsx)(n.p,{children:"StarRocks v3.0 does not support collecting statistics from external tables. Therefore, we use Hive to collect column-level statistics."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"use tpcds_100g_parquet_lz4;\n\nanalyze table call_center compute statistics FOR COLUMNS;\nanalyze table catalog_page compute statistics FOR COLUMNS;\nanalyze table catalog_returns compute statistics FOR COLUMNS;\nanalyze table catalog_sales compute statistics FOR COLUMNS;\nanalyze table customer compute statistics FOR COLUMNS;\nanalyze table customer_address compute statistics FOR COLUMNS;\nanalyze table customer_demographics compute statistics FOR COLUMNS;\nanalyze table date_dim compute statistics FOR COLUMNS;\nanalyze table household_demographics compute statistics FOR COLUMNS;\nanalyze table income_band compute statistics FOR COLUMNS;\nanalyze table inventory compute statistics FOR COLUMNS;\nanalyze table item compute statistics FOR COLUMNS;\nanalyze table promotion compute statistics FOR COLUMNS;\nanalyze table reason compute statistics FOR COLUMNS;\nanalyze table ship_mode compute statistics FOR COLUMNS;\nanalyze table store compute statistics FOR COLUMNS;\nanalyze table store_returns compute statistics FOR COLUMNS;\nanalyze table store_sales compute statistics FOR COLUMNS;\nanalyze table time_dim compute statistics FOR COLUMNS;\nanalyze table warehouse compute statistics FOR COLUMNS;\nanalyze table web_page compute statistics FOR COLUMNS;\nanalyze table web_returns compute statistics FOR COLUMNS;\nanalyze table web_sales compute statistics FOR COLUMNS;\nanalyze table web_site compute statistics FOR COLUMNS;\n"})}),"\n",(0,t.jsx)(n.h4,{id:"424-query-data",children:"4.2.4 Query Data"}),"\n",(0,t.jsxs)(n.p,{children:["StarRocks uses ",(0,t.jsx)(n.a,{href:"/doc/docs/3.0/data_source/catalog/hive_catalog",children:"Hive catalog"})," to query Hive external tables."]}),"\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.a,{href:"/doc/docs/3.0/data_source/data_cache",children:"Data Cache"})," is enabled for StarRocks during the test, the following configuration is recommended for the Data Cache feature."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"block_cache_mem_size = 5368709120\nblock_cache_disk_size = 193273528320\n"})}),"\n",(0,t.jsx)(n.h2,{id:"5-query-statements-and-create-table-statements",children:"5. Query statements and CREATE TABLE statements"}),"\n",(0,t.jsx)(n.h3,{id:"51-tpc-ds-sql-queries",children:"5.1 TPC-DS SQL queries"}),"\n",(0,t.jsxs)(n.p,{children:["For more information about the 99 SQL queries, see ",(0,t.jsx)(n.a,{href:"/doc/docs/3.0/benchmarking/tpc_ds_99_sql",children:"TPC-DS SQL"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"52-create-a-starrocks-native-table",children:"5.2 Create a StarRocks native table"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'create table call_center\n(\n    cc_call_center_sk         integer               not null,\n    cc_call_center_id         char(16)              not null,\n    cc_rec_start_date         date                          ,\n    cc_rec_end_date           date                          ,\n    cc_closed_date_sk         integer                       ,\n    cc_open_date_sk           integer                       ,\n    cc_name                   varchar(50)                   ,\n    cc_class                  varchar(50)                   ,\n    cc_employees              integer                       ,\n    cc_sq_ft                  integer                       ,\n    cc_hours                  char(20)                      ,\n    cc_manager                varchar(40)                   ,\n    cc_mkt_id                 integer                       ,\n    cc_mkt_class              char(50)                      ,\n    cc_mkt_desc               varchar(100)                  ,\n    cc_market_manager         varchar(40)                   ,\n    cc_division               integer                       ,\n    cc_division_name          varchar(50)                   ,\n    cc_company                integer                       ,\n    cc_company_name           char(50)                      ,\n    cc_street_number          char(10)                      ,\n    cc_street_name            varchar(60)                   ,\n    cc_street_type            char(15)                      ,\n    cc_suite_number           char(10)                      ,\n    cc_city                   varchar(60)                   ,\n    cc_county                 varchar(30)                   ,\n    cc_state                  char(2)                       ,\n    cc_zip                    char(10)                      ,\n    cc_country                varchar(20)                   ,\n    cc_gmt_offset             decimal(5,2)                  ,\n    cc_tax_percentage         decimal(5,2)\n)\nduplicate key (cc_call_center_sk)\ndistributed by hash(cc_call_center_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table catalog_page\n(\n    cp_catalog_page_sk        integer               not null,\n    cp_catalog_page_id        char(16)              not null,\n    cp_start_date_sk          integer                       ,\n    cp_end_date_sk            integer                       ,\n    cp_department             varchar(50)                   ,\n    cp_catalog_number         integer                       ,\n    cp_catalog_page_number    integer                       ,\n    cp_description            varchar(100)                  ,\n    cp_type                   varchar(100)\n)\nduplicate key (cp_catalog_page_sk)\ndistributed by hash(cp_catalog_page_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table catalog_returns\n(\n    cr_item_sk                integer               not null,\n    cr_order_number           integer               not null,\n    cr_returned_date_sk       integer                       ,\n    cr_returned_time_sk       integer                       ,\n    cr_refunded_customer_sk   integer                       ,\n    cr_refunded_cdemo_sk      integer                       ,\n    cr_refunded_hdemo_sk      integer                       ,\n    cr_refunded_addr_sk       integer                       ,\n    cr_returning_customer_sk  integer                       ,\n    cr_returning_cdemo_sk     integer                       ,\n    cr_returning_hdemo_sk     integer                       ,\n    cr_returning_addr_sk      integer                       ,\n    cr_call_center_sk         integer                       ,\n    cr_catalog_page_sk        integer                       ,\n    cr_ship_mode_sk           integer                       ,\n    cr_warehouse_sk           integer                       ,\n    cr_reason_sk              integer                       ,\n    cr_return_quantity        integer                       ,\n    cr_return_amount          decimal(7,2)                  ,\n    cr_return_tax             decimal(7,2)                  ,\n    cr_return_amt_inc_tax     decimal(7,2)                  ,\n    cr_fee                    decimal(7,2)                  ,\n    cr_return_ship_cost       decimal(7,2)                  ,\n    cr_refunded_cash          decimal(7,2)                  ,\n    cr_reversed_charge        decimal(7,2)                  ,\n    cr_store_credit           decimal(7,2)                  ,\n    cr_net_loss               decimal(7,2)\n)\nduplicate key (cr_item_sk, cr_order_number)\ndistributed by hash(cr_item_sk, cr_order_number) buckets 16\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table catalog_sales\n(\n    cs_item_sk                integer               not null,\n    cs_order_number           integer               not null,\n    cs_sold_date_sk           integer                       ,\n    cs_sold_time_sk           integer                       ,\n    cs_ship_date_sk           integer                       ,\n    cs_bill_customer_sk       integer                       ,\n    cs_bill_cdemo_sk          integer                       ,\n    cs_bill_hdemo_sk          integer                       ,\n    cs_bill_addr_sk           integer                       ,\n    cs_ship_customer_sk       integer                       ,\n    cs_ship_cdemo_sk          integer                       ,\n    cs_ship_hdemo_sk          integer                       ,\n    cs_ship_addr_sk           integer                       ,\n    cs_call_center_sk         integer                       ,\n    cs_catalog_page_sk        integer                       ,\n    cs_ship_mode_sk           integer                       ,\n    cs_warehouse_sk           integer                       ,\n    cs_promo_sk               integer                       ,\n    cs_quantity               integer                       ,\n    cs_wholesale_cost         decimal(7,2)                  ,\n    cs_list_price             decimal(7,2)                  ,\n    cs_sales_price            decimal(7,2)                  ,\n    cs_ext_discount_amt       decimal(7,2)                  ,\n    cs_ext_sales_price        decimal(7,2)                  ,\n    cs_ext_wholesale_cost     decimal(7,2)                  ,\n    cs_ext_list_price         decimal(7,2)                  ,\n    cs_ext_tax                decimal(7,2)                  ,\n    cs_coupon_amt             decimal(7,2)                  ,\n    cs_ext_ship_cost          decimal(7,2)                  ,\n    cs_net_paid               decimal(7,2)                  ,\n    cs_net_paid_inc_tax       decimal(7,2)                  ,\n    cs_net_paid_inc_ship      decimal(7,2)                  ,\n    cs_net_paid_inc_ship_tax  decimal(7,2)                  ,\n    cs_net_profit             decimal(7,2)\n)\nduplicate key (cs_item_sk, cs_order_number)\ndistributed by hash(cs_item_sk) buckets 192\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table customer_address\n(\n    ca_address_sk             integer               not null,\n    ca_address_id             char(16)              not null,\n    ca_street_number          char(10)                      ,\n    ca_street_name            varchar(60)                   ,\n    ca_street_type            char(15)                      ,\n    ca_suite_number           char(10)                      ,\n    ca_city                   varchar(60)                   ,\n    ca_county                 varchar(30)                   ,\n    ca_state                  char(2)                       ,\n    ca_zip                    char(10)                      ,\n    ca_country                varchar(20)                   ,\n    ca_gmt_offset             decimal(5,2)                  ,\n    ca_location_type          char(20)\n)\nduplicate key(ca_address_sk)\ndistributed by hash(ca_address_sk) buckets 10\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table customer_demographics\n(\n    cd_demo_sk                integer  not null,\n    cd_gender                 char(1)  not null,\n    cd_marital_status         char(1)  not null,\n    cd_education_status       char(20) not null,\n    cd_purchase_estimate      integer  not null,\n    cd_credit_rating          char(10) not null,\n    cd_dep_count              integer  not null,\n    cd_dep_employed_count     integer  not null,\n    cd_dep_college_count      integer  not null\n)\nduplicate key (cd_demo_sk)\ndistributed by hash(cd_demo_sk) buckets 10\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table customer\n(\n    c_customer_sk             integer               not null,\n    c_customer_id             char(16)              not null,\n    c_current_cdemo_sk        integer                       ,\n    c_current_hdemo_sk        integer                       ,\n    c_current_addr_sk         integer                       ,\n    c_first_shipto_date_sk    integer                       ,\n    c_first_sales_date_sk     integer                       ,\n    c_salutation              char(10)                      ,\n    c_first_name              char(20)                      ,\n    c_last_name               char(30)                      ,\n    c_preferred_cust_flag     char(1)                       ,\n    c_birth_day               integer                       ,\n    c_birth_month             integer                       ,\n    c_birth_year              integer                       ,\n    c_birth_country           varchar(20)                   ,\n    c_login                   char(13)                      ,\n    c_email_address           char(50)                      ,\n    c_last_review_date        char(10)\n)\nduplicate key (c_customer_sk)\ndistributed by hash(c_customer_sk) buckets 10\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table date_dim\n(\n    d_date_sk                 integer   not null,\n    d_date_id                 char(16)  not null,\n    d_date                    date      not null,\n    d_month_seq               integer   not null,\n    d_week_seq                integer   not null,\n    d_quarter_seq             integer   not null,\n    d_year                    integer   not null,\n    d_dow                     integer   not null,\n    d_moy                     integer   not null,\n    d_dom                     integer   not null,\n    d_qoy                     integer   not null,\n    d_fy_year                 integer   not null,\n    d_fy_quarter_seq          integer   not null,\n    d_fy_week_seq             integer   not null,\n    d_day_name                char(9)   not null,\n    d_quarter_name            char(6)   not null,\n    d_holiday                 char(1)   not null,\n    d_weekend                 char(1)   not null,\n    d_following_holiday       char(1)   not null,\n    d_first_dom               integer   not null,\n    d_last_dom                integer   not null,\n    d_same_day_ly             integer   not null,\n    d_same_day_lq             integer   not null,\n    d_current_day             char(1)   not null,\n    d_current_week            char(1)   not null,\n    d_current_month           char(1)   not null,\n    d_current_quarter         char(1)   not null,\n    d_current_year            char(1)   not null\n)\nduplicate key (d_date_sk)\ndistributed by hash(d_date_sk) buckets 5\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table household_demographics\n(\n    hd_demo_sk                integer  not null,\n    hd_income_band_sk         integer  not null,\n    hd_buy_potential          char(15) not null,\n    hd_dep_count              integer  not null,\n    hd_vehicle_count          integer  not null\n)\nduplicate key (hd_demo_sk)\ndistributed by hash(hd_demo_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table income_band\n(\n    ib_income_band_sk         integer               not null,\n    ib_lower_bound            integer                       ,\n    ib_upper_bound            integer\n)\nduplicate key (ib_income_band_sk)\ndistributed by hash(ib_income_band_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table inventory\n(\n    inv_item_sk               integer               not null,\n    inv_date_sk               integer               not null,\n    inv_warehouse_sk          integer               not null,\n    inv_quantity_on_hand      integer\n)\nduplicate key (inv_item_sk, inv_date_sk, inv_warehouse_sk)\ndistributed by hash(inv_item_sk) buckets 32\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table item\n(\n    i_item_sk                 integer               not null,\n    i_item_id                 char(16)              not null,\n    i_rec_start_date          date                          ,\n    i_rec_end_date            date                          ,\n    i_item_desc               varchar(200)                  ,\n    i_current_price           decimal(7,2)                  ,\n    i_wholesale_cost          decimal(7,2)                  ,\n    i_brand_id                integer                       ,\n    i_brand                   char(50)                      ,\n    i_class_id                integer                       ,\n    i_class                   char(50)                      ,\n    i_category_id             integer                       ,\n    i_category                char(50)                      ,\n    i_manufact_id             integer                       ,\n    i_manufact                char(50)                      ,\n    i_size                    char(20)                      ,\n    i_formulation             char(20)                      ,\n    i_color                   char(20)                      ,\n    i_units                   char(10)                      ,\n    i_container               char(10)                      ,\n    i_manager_id              integer                       ,\n    i_product_name            char(50)\n)\nduplicate key (i_item_sk)\ndistributed by hash(i_item_sk) buckets 10\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table promotion\n(\n    p_promo_sk                integer               not null,\n    p_promo_id                char(16)              not null,\n    p_start_date_sk           integer                       ,\n    p_end_date_sk             integer                       ,\n    p_item_sk                 integer                       ,\n    p_cost                    decimal(15,2)                 ,\n    p_response_target         integer                       ,\n    p_promo_name              char(50)                      ,\n    p_channel_dmail           char(1)                       ,\n    p_channel_email           char(1)                       ,\n    p_channel_catalog         char(1)                       ,\n    p_channel_tv              char(1)                       ,\n    p_channel_radio           char(1)                       ,\n    p_channel_press           char(1)                       ,\n    p_channel_event           char(1)                       ,\n    p_channel_demo            char(1)                       ,\n    p_channel_details         varchar(100)                  ,\n    p_purpose                 char(15)                      ,\n    p_discount_active         char(1)\n)\nduplicate key (p_promo_sk)\ndistributed by hash(p_promo_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table reason\n(\n    r_reason_sk               integer               not null,\n    r_reason_id               char(16)              not null,\n    r_reason_desc             char(100)\n)\nduplicate key (r_reason_sk)\ndistributed by hash(r_reason_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table ship_mode\n(\n    sm_ship_mode_sk           integer               not null,\n    sm_ship_mode_id           char(16)              not null,\n    sm_type                   char(30)                      ,\n    sm_code                   char(10)                      ,\n    sm_carrier                char(20)                      ,\n    sm_contract               char(20)\n)\nduplicate key (sm_ship_mode_sk)\ndistributed by hash(sm_ship_mode_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table store_returns\n(\n    sr_item_sk                integer               not null,\n    sr_ticket_number          integer               not null,\n    sr_returned_date_sk       integer                       ,\n    sr_return_time_sk         integer                       ,\n    sr_customer_sk            integer                       ,\n    sr_cdemo_sk               integer                       ,\n    sr_hdemo_sk               integer                       ,\n    sr_addr_sk                integer                       ,\n    sr_store_sk               integer                       ,\n    sr_reason_sk              integer                       ,\n    sr_return_quantity        integer                       ,\n    sr_return_amt             decimal(7,2)                  ,\n    sr_return_tax             decimal(7,2)                  ,\n    sr_return_amt_inc_tax     decimal(7,2)                  ,\n    sr_fee                    decimal(7,2)                  ,\n    sr_return_ship_cost       decimal(7,2)                  ,\n    sr_refunded_cash          decimal(7,2)                  ,\n    sr_reversed_charge        decimal(7,2)                  ,\n    sr_store_credit           decimal(7,2)                  ,\n    sr_net_loss               decimal(7,2)\n)\nduplicate key (sr_item_sk, sr_ticket_number)\ndistributed by hash(sr_item_sk, sr_ticket_number) buckets 10\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table store_sales\n(\n    ss_item_sk                integer               not null,\n    ss_ticket_number          integer               not null,\n    ss_sold_date_sk           integer                       ,\n    ss_sold_time_sk           integer                       ,\n    ss_customer_sk            integer                       ,\n    ss_cdemo_sk               integer                       ,\n    ss_hdemo_sk               integer                       ,\n    ss_addr_sk                integer                       ,\n    ss_store_sk               integer                       ,\n    ss_promo_sk               integer                       ,\n    ss_quantity               integer                       ,\n    ss_wholesale_cost         decimal(7,2)                  ,\n    ss_list_price             decimal(7,2)                  ,\n    ss_sales_price            decimal(7,2)                  ,\n    ss_ext_discount_amt       decimal(7,2)                  ,\n    ss_ext_sales_price        decimal(7,2)                  ,\n    ss_ext_wholesale_cost     decimal(7,2)                  ,\n    ss_ext_list_price         decimal(7,2)                  ,\n    ss_ext_tax                decimal(7,2)                  ,\n    ss_coupon_amt             decimal(7,2)                  ,\n    ss_net_paid               decimal(7,2)                  ,\n    ss_net_paid_inc_tax       decimal(7,2)                  ,\n    ss_net_profit             decimal(7,2)\n)\nduplicate key (ss_item_sk, ss_ticket_number)\ndistributed by hash(ss_item_sk) buckets 192\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table store\n(\n    s_store_sk                integer               not null,\n    s_store_id                char(16)              not null,\n    s_rec_start_date          date                          ,\n    s_rec_end_date            date                          ,\n    s_closed_date_sk          integer                       ,\n    s_store_name              varchar(50)                   ,\n    s_number_employees        integer                       ,\n    s_floor_space             integer                       ,\n    s_hours                   char(20)                      ,\n    s_manager                 varchar(40)                   ,\n    s_market_id               integer                       ,\n    s_geography_class         varchar(100)                  ,\n    s_market_desc             varchar(100)                  ,\n    s_market_manager          varchar(40)                   ,\n    s_division_id             integer                       ,\n    s_division_name           varchar(50)                   ,\n    s_company_id              integer                       ,\n    s_company_name            varchar(50)                   ,\n    s_street_number           varchar(10)                   ,\n    s_street_name             varchar(60)                   ,\n    s_street_type             char(15)                      ,\n    s_suite_number            char(10)                      ,\n    s_city                    varchar(60)                   ,\n    s_county                  varchar(30)                   ,\n    s_state                   char(2)                       ,\n    s_zip                     char(10)                      ,\n    s_country                 varchar(20)                   ,\n    s_gmt_offset              decimal(5,2)                  ,\n    s_tax_precentage          decimal(5,2)\n)\nduplicate key (s_store_sk)\ndistributed by hash(s_store_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table time_dim\n(\n    t_time_sk                 integer               not null,\n    t_time_id                 char(16)              not null,\n    t_time                    integer               not null,\n    t_hour                    integer               not null,\n    t_minute                  integer               not null,\n    t_second                  integer               not null,\n    t_am_pm                   char(2)               not null,\n    t_shift                   char(20)              not null,\n    t_sub_shift               char(20)              not null,\n    t_meal_time               char(20)\n)\nduplicate key (t_time_sk)\ndistributed by hash(t_time_sk) buckets 5\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table warehouse\n(\n    w_warehouse_sk            integer               not null,\n    w_warehouse_id            char(16)              not null,\n    w_warehouse_name          varchar(20)                   ,\n    w_warehouse_sq_ft         integer                       ,\n    w_street_number           char(10)                      ,\n    w_street_name             varchar(60)                   ,\n    w_street_type             char(15)                      ,\n    w_suite_number            char(10)                      ,\n    w_city                    varchar(60)                   ,\n    w_county                  varchar(30)                   ,\n    w_state                   char(2)                       ,\n    w_zip                     char(10)                      ,\n    w_country                 varchar(20)                   ,\n    w_gmt_offset              decimal(5,2)\n)\nduplicate key (w_warehouse_sk)\ndistributed by hash(w_warehouse_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table web_page\n(\n    wp_web_page_sk            integer               not null,\n    wp_web_page_id            char(16)              not null,\n    wp_rec_start_date         date                          ,\n    wp_rec_end_date           date                          ,\n    wp_creation_date_sk       integer                       ,\n    wp_access_date_sk         integer                       ,\n    wp_autogen_flag           char(1)                       ,\n    wp_customer_sk            integer                       ,\n    wp_url                    varchar(100)                  ,\n    wp_type                   char(50)                      ,\n    wp_char_count             integer                       ,\n    wp_link_count             integer                       ,\n    wp_image_count            integer                       ,\n    wp_max_ad_count           integer\n)\nduplicate key (wp_web_page_sk)\ndistributed by hash(wp_web_page_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table web_returns\n(\n    wr_item_sk                integer               not null,\n    wr_order_number           integer               not null,\n    wr_returned_date_sk       integer                       ,\n    wr_returned_time_sk       integer                       ,\n    wr_refunded_customer_sk   integer                       ,\n    wr_refunded_cdemo_sk      integer                       ,\n    wr_refunded_hdemo_sk      integer                       ,\n    wr_refunded_addr_sk       integer                       ,\n    wr_returning_customer_sk  integer                       ,\n    wr_returning_cdemo_sk     integer                       ,\n    wr_returning_hdemo_sk     integer                       ,\n    wr_returning_addr_sk      integer                       ,\n    wr_web_page_sk            integer                       ,\n    wr_reason_sk              integer                       ,\n    wr_return_quantity        integer                       ,\n    wr_return_amt             decimal(7,2)                  ,\n    wr_return_tax             decimal(7,2)                  ,\n    wr_return_amt_inc_tax     decimal(7,2)                  ,\n    wr_fee                    decimal(7,2)                  ,\n    wr_return_ship_cost       decimal(7,2)                  ,\n    wr_refunded_cash          decimal(7,2)                  ,\n    wr_reversed_charge        decimal(7,2)                  ,\n    wr_account_credit         decimal(7,2)                  ,\n    wr_net_loss               decimal(7,2)\n)\nduplicate key (wr_item_sk, wr_order_number)\ndistributed by hash(wr_item_sk, wr_order_number) buckets 10\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table web_sales\n(\n    ws_item_sk                integer               not null,\n    ws_order_number           integer               not null,\n    ws_sold_date_sk           integer                       ,\n    ws_sold_time_sk           integer                       ,\n    ws_ship_date_sk           integer                       ,\n    ws_bill_customer_sk       integer                       ,\n    ws_bill_cdemo_sk          integer                       ,\n    ws_bill_hdemo_sk          integer                       ,\n    ws_bill_addr_sk           integer                       ,\n    ws_ship_customer_sk       integer                       ,\n    ws_ship_cdemo_sk          integer                       ,\n    ws_ship_hdemo_sk          integer                       ,\n    ws_ship_addr_sk           integer                       ,\n    ws_web_page_sk            integer                       ,\n    ws_web_site_sk            integer                       ,\n    ws_ship_mode_sk           integer                       ,\n    ws_warehouse_sk           integer                       ,\n    ws_promo_sk               integer                       ,\n    ws_quantity               integer                       ,\n    ws_wholesale_cost         decimal(7,2)                  ,\n    ws_list_price             decimal(7,2)                  ,\n    ws_sales_price            decimal(7,2)                  ,\n    ws_ext_discount_amt       decimal(7,2)                  ,\n    ws_ext_sales_price        decimal(7,2)                  ,\n    ws_ext_wholesale_cost     decimal(7,2)                  ,\n    ws_ext_list_price         decimal(7,2)                  ,\n    ws_ext_tax                decimal(7,2)                  ,\n    ws_coupon_amt             decimal(7,2)                  ,\n    ws_ext_ship_cost          decimal(7,2)                  ,\n    ws_net_paid               decimal(7,2)                  ,\n    ws_net_paid_inc_tax       decimal(7,2)                  ,\n    ws_net_paid_inc_ship      decimal(7,2)                  ,\n    ws_net_paid_inc_ship_tax  decimal(7,2)                  ,\n    ws_net_profit             decimal(7,2)\n)\nduplicate key (ws_item_sk, ws_order_number)\ndistributed by hash(ws_item_sk, ws_order_number) buckets 192\nproperties(\n    "replication_num" = "1"\n);\n\ncreate table web_site\n(\n    web_site_sk               integer               not null,\n    web_site_id               char(16)              not null,\n    web_rec_start_date        date                          ,\n    web_rec_end_date          date                          ,\n    web_name                  varchar(50)                   ,\n    web_open_date_sk          integer                       ,\n    web_close_date_sk         integer                       ,\n    web_class                 varchar(50)                   ,\n    web_manager               varchar(40)                   ,\n    web_mkt_id                integer                       ,\n    web_mkt_class             varchar(50)                   ,\n    web_mkt_desc              varchar(100)                  ,\n    web_market_manager        varchar(40)                   ,\n    web_company_id            integer                       ,\n    web_company_name          char(50)                      ,\n    web_street_number         char(10)                      ,\n    web_street_name           varchar(60)                   ,\n    web_street_type           char(15)                      ,\n    web_suite_number          char(10)                      ,\n    web_city                  varchar(60)                   ,\n    web_county                varchar(30)                   ,\n    web_state                 char(2)                       ,\n    web_zip                   char(10)                      ,\n    web_country               varchar(20)                   ,\n    web_gmt_offset            decimal(5,2)                  ,\n    web_tax_percentage        decimal(5,2)\n)\nduplicate key (web_site_sk)\ndistributed by hash(web_site_sk) buckets 1\nproperties(\n    "replication_num" = "1"\n);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"53-create-hive-external-tablesparquet",children:"5.3 Create Hive external tables\uff08Parquet)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:'use tpcds_100g_parquet_lz4;\n\nCREATE EXTERNAL TABLE IF NOT EXISTS customer_address\n (\n  ca_address_sk int\n  ,ca_address_id varchar(16)\n  ,ca_street_number varchar(10)\n  ,ca_street_name varchar(60)\n  ,ca_street_type varchar(15)\n  ,ca_suite_number varchar(10)\n  ,ca_city varchar(60)\n  ,ca_county varchar(30)\n  ,ca_state varchar(2)\n  ,ca_zip varchar(10)\n  ,ca_country varchar(20)\n  ,ca_gmt_offset decimal(5,2)\n  ,ca_location_type varchar(20)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/customer_address/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS customer_demographics\n (\n  cd_demo_sk int\n ,cd_gender varchar(1)\n ,cd_marital_status varchar(1)\n ,cd_education_status varchar(20)\n ,cd_purchase_estimate   int\n ,cd_credit_rating varchar(10)\n ,cd_dep_count int\n ,cd_dep_employed_count int\n ,cd_dep_college_count int\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/customer_demographics/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS date_dim\n (\n  d_date_sk int\n  ,d_date_id varchar(16)\n  ,d_date date\n  ,d_month_seq int\n  ,d_week_seq int\n  ,d_quarter_seq int\n  ,d_year int\n  ,d_dow int\n  ,d_moy int\n  ,d_dom int\n  ,d_qoy int\n  ,d_fy_year int\n  ,d_fy_quarter_seq int\n  ,d_fy_week_seq int\n  ,d_day_name varchar(9)\n  ,d_quarter_name varchar(6)\n  ,d_holiday varchar(1)\n  ,d_weekend varchar(1)\n  ,d_following_holiday varchar(1)\n  ,d_first_dom int\n  ,d_last_dom int\n  ,d_same_day_ly int\n  ,d_same_day_lq int\n  ,d_current_day varchar(1)\n  ,d_current_week varchar(1)\n  ,d_current_month varchar(1)\n  ,d_current_quarter varchar(1)\n  ,d_current_year varchar(1)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/date_dim/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS warehouse\n (\n  w_warehouse_sk int\n  ,w_warehouse_id varchar(16)\n  ,w_warehouse_name varchar(20)\n  ,w_warehouse_sq_ft int\n  ,w_street_number varchar(10)\n  ,w_street_name varchar(60)\n  ,w_street_type varchar(15)\n  ,w_suite_number varchar(10)\n  ,w_city varchar(60)\n  ,w_county varchar(30)\n  ,w_state varchar(2)\n  ,w_zip varchar(10)\n  ,w_country varchar(20)\n  ,w_gmt_offset decimal(5,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/warehouse/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS ship_mode\n (\n  sm_ship_mode_sk int\n  ,sm_ship_mode_id varchar(16)\n  ,sm_type varchar(30)\n  ,sm_code varchar(10)\n  ,sm_carrier varchar(20)\n  ,sm_contract varchar(20)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/ship_mode/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS time_dim\n (\n  t_time_sk int\n  ,t_time_id varchar(16)\n  ,t_time int\n  ,t_hour int\n  ,t_minute int\n  ,t_second int\n  ,t_am_pm varchar(2)\n  ,t_shift varchar(20)\n  ,t_sub_shift varchar(20)\n  ,t_meal_time varchar(20)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/time_dim/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS reason\n (\n  r_reason_sk int\n  ,r_reason_id varchar(16)\n  ,r_reason_desc varchar(100)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/reason/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS income_band\n (\n  ib_income_band_sk integer ,\n  ib_lower_bound integer ,\n  ib_upper_bound integer\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/income_band/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS item\n (\n  i_item_sk int\n  ,i_item_id varchar(16)\n  ,i_rec_start_date date\n  ,i_rec_end_date date\n  ,i_item_desc varchar(200)\n  ,i_current_price decimal(7,2)\n  ,i_wholesale_cost decimal(7,2)\n  ,i_brand_id int\n  ,i_brand varchar(50)\n  ,i_class_id int\n  ,i_class varchar(50)\n  ,i_category_id int\n  ,i_category varchar(50)\n  ,i_manufact_id int\n  ,i_manufact varchar(50)\n  ,i_size varchar(20)\n  ,i_formulation varchar(20)\n  ,i_color varchar(20)\n  ,i_units varchar(10)\n  ,i_container varchar(10)\n  ,i_manager_id int\n  ,i_product_name varchar(50)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/item/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS store\n (\n  s_store_sk int\n  ,s_store_id varchar(16)\n  ,s_rec_start_date date\n  ,s_rec_end_date date\n  ,s_closed_date_sk int\n  ,s_store_name varchar(50)\n  ,s_number_employees int\n  ,s_floor_space int\n  ,s_hours varchar(20)\n  ,s_manager varchar(40)\n  ,s_market_id int\n  ,s_geography_class varchar(100)\n  ,s_market_desc varchar(100)\n  ,s_market_manager varchar(40)\n  ,s_division_id int\n  ,s_division_name varchar(50)\n  ,s_company_id int\n  ,s_company_name varchar(50)\n  ,s_street_number varchar(10)\n  ,s_street_name varchar(60)\n  ,s_street_type varchar(15)\n  ,s_suite_number varchar(10)\n  ,s_city varchar(60)\n  ,s_county varchar(30)\n  ,s_state varchar(2)\n  ,s_zip varchar(10)\n  ,s_country varchar(20)\n  ,s_gmt_offset decimal(5,2)\n  ,s_tax_precentage decimal(5,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/store/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS call_center\n (\n  cc_call_center_sk int\n  ,cc_call_center_id varchar(16)\n  ,cc_rec_start_date date\n  ,cc_rec_end_date date\n  ,cc_closed_date_sk int\n  ,cc_open_date_sk int\n  ,cc_name varchar(50)\n  ,cc_class varchar(50)\n  ,cc_employees int\n  ,cc_sq_ft int\n  ,cc_hours varchar(20)\n  ,cc_manager varchar(40)\n  ,cc_mkt_id int\n  ,cc_mkt_class varchar(50)\n  ,cc_mkt_desc varchar(100)\n  ,cc_market_manager varchar(40)\n  ,cc_division int\n  ,cc_division_name varchar(50)\n  ,cc_company int\n  ,cc_company_name varchar(50)\n  ,cc_street_number varchar(10)\n  ,cc_street_name varchar(60)\n  ,cc_street_type varchar(15)\n  ,cc_suite_number varchar(10)\n  ,cc_city varchar(60)\n  ,cc_county varchar(30)\n  ,cc_state varchar(2)\n  ,cc_zip varchar(10)\n  ,cc_country varchar(20)\n  ,cc_gmt_offset decimal(5,2)\n  ,cc_tax_percentage decimal(5,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/call_center/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS customer\n (\n  c_customer_sk int\n  ,c_customer_id varchar(16)\n  ,c_current_cdemo_sk int\n  ,c_current_hdemo_sk int\n  ,c_current_addr_sk int\n  ,c_first_shipto_date_sk    int\n  ,c_first_sales_date_sk     int\n  ,c_salutation varchar(10)\n  ,c_first_name varchar(20)\n  ,c_last_name varchar(30)\n  ,c_preferred_cust_flag     varchar(1)\n  ,c_birth_day int\n  ,c_birth_month int\n  ,c_birth_year int\n  ,c_birth_country varchar(20)\n  ,c_login varchar(13)\n  ,c_email_address varchar(50)\n  ,c_last_review_date varchar(10)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/customer/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_site\n (\n  web_site_sk int\n  ,web_site_id varchar(16)\n  ,web_rec_start_date date\n  ,web_rec_end_date date\n  ,web_name varchar(50)\n  ,web_open_date_sk int\n  ,web_close_date_sk int\n  ,web_class varchar(50)\n  ,web_manager varchar(40)\n  ,web_mkt_id int\n  ,web_mkt_class varchar(50)\n  ,web_mkt_desc varchar(100)\n  ,web_market_manager varchar(40)\n  ,web_company_id int\n  ,web_company_name varchar(50)\n  ,web_street_number varchar(10)\n  ,web_street_name varchar(60)\n  ,web_street_type varchar(15)\n  ,web_suite_number varchar(10)\n  ,web_city varchar(60)\n  ,web_county varchar(30)\n  ,web_state varchar(2)\n  ,web_zip varchar(10)\n  ,web_country varchar(20)\n  ,web_gmt_offset decimal(5,2)\n  ,web_tax_percentage decimal(5,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/web_site/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS store_returns\n (\n  sr_item_sk int\n  ,sr_ticket_number int\n  ,sr_returned_date_sk int\n  ,sr_return_time_sk int\n  ,sr_customer_sk int\n  ,sr_cdemo_sk int\n  ,sr_hdemo_sk int\n  ,sr_addr_sk int\n  ,sr_store_sk int\n  ,sr_reason_sk int\n  ,sr_return_quantity int\n  ,sr_return_amt decimal(7,2)\n  ,sr_return_tax decimal(7,2)\n  ,sr_return_amt_inc_tax decimal(7,2)\n  ,sr_fee decimal(7,2)\n  ,sr_return_ship_cost decimal(7,2)\n  ,sr_refunded_cash decimal(7,2)\n  ,sr_reversed_charge decimal(7,2)\n  ,sr_store_credit decimal(7,2)\n  ,sr_net_loss decimal(7,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/store_returns/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS household_demographics\n (\n  hd_demo_sk int\n  ,hd_income_band_sk int\n  ,hd_buy_potential varchar(15)\n  ,hd_dep_count int\n  ,hd_vehicle_count int\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/household_demographics/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_page\n (\n  wp_web_page_sk int\n  ,wp_web_page_id varchar(16)\n  ,wp_rec_start_date date\n  ,wp_rec_end_date date\n  ,wp_creation_date_sk int\n  ,wp_access_date_sk int\n  ,wp_autogen_flag varchar(1)\n  ,wp_customer_sk int\n  ,wp_url varchar(100)\n  ,wp_type varchar(50)\n  ,wp_char_count int\n  ,wp_link_count int\n  ,wp_image_count int\n  ,wp_max_ad_count int\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/web_page/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS promotion\n (\n  p_promo_sk int\n  ,p_promo_id varchar(16)\n  ,p_start_date_sk int\n  ,p_end_date_sk int\n  ,p_item_sk int\n  ,p_cost decimal(15,2)\n  ,p_response_target int\n  ,p_promo_name varchar(50)\n  ,p_channel_dmail varchar(1)\n  ,p_channel_email varchar(1)\n  ,p_channel_catalog varchar(1)\n  ,p_channel_tv varchar(1)\n  ,p_channel_radio varchar(1)\n  ,p_channel_press varchar(1)\n  ,p_channel_event varchar(1)\n  ,p_channel_demo varchar(1)\n  ,p_channel_details varchar(100)\n  ,p_purpose varchar(15)\n  ,p_discount_active varchar(1)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/promotion/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS catalog_page\n (\n  cp_catalog_page_sk int\n  ,cp_catalog_page_id varchar(16)\n  ,cp_start_date_sk int\n  ,cp_end_date_sk int\n  ,cp_department varchar(50)\n  ,cp_catalog_number int\n  ,cp_catalog_page_number    int\n  ,cp_description varchar(100)\n  ,cp_type varchar(100)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/catalog_page/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS inventory\n (\n  inv_date_sk integer ,\n  inv_item_sk integer ,\n  inv_warehouse_sk integer ,\n  inv_quantity_on_hand integer\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/inventory/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS catalog_returns\n (\n  cr_item_sk int\n  ,cr_order_number int\n  ,cr_returned_date_sk int\n  ,cr_returned_time_sk int\n  ,cr_refunded_customer_sk int\n  ,cr_refunded_cdemo_sk  int\n  ,cr_refunded_hdemo_sk  int\n  ,cr_refunded_addr_sk int\n  ,cr_returning_customer_sk int\n  ,cr_returning_cdemo_sk     int\n  ,cr_returning_hdemo_sk     int\n  ,cr_returning_addr_sk  int\n  ,cr_call_center_sk int\n  ,cr_catalog_page_sk int\n  ,cr_ship_mode_sk int\n  ,cr_warehouse_sk int\n  ,cr_reason_sk int\n  ,cr_return_quantity int\n  ,cr_return_amount decimal(7,2)\n  ,cr_return_tax decimal(7,2)\n  ,cr_return_amt_inc_tax     decimal(7,2)\n  ,cr_fee decimal(7,2)\n  ,cr_return_ship_cost  decimal(7,2)\n  ,cr_refunded_cash decimal(7,2)\n  ,cr_reversed_charge decimal(7,2)\n  ,cr_store_credit decimal(7,2)\n  ,cr_net_loss decimal(7,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/catalog_returns/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_returns\n (\n  wr_item_sk int\n  ,wr_order_number int\n  ,wr_returned_date_sk int\n  ,wr_returned_time_sk int\n  ,wr_refunded_customer_sk   int\n  ,wr_refunded_cdemo_sk  int\n  ,wr_refunded_hdemo_sk int\n  ,wr_refunded_addr_sk int\n  ,wr_returning_customer_sk  int\n  ,wr_returning_cdemo_sk     int\n  ,wr_returning_hdemo_sk     int\n  ,wr_returning_addr_sk  int\n  ,wr_web_page_sk int\n  ,wr_reason_sk int\n  ,wr_return_quantity int\n  ,wr_return_amt decimal(7,2)\n  ,wr_return_tax decimal(7,2)\n  ,wr_return_amt_inc_tax     decimal(7,2)\n  ,wr_fee decimal(7,2)\n  ,wr_return_ship_cost decimal(7,2)\n  ,wr_refunded_cash decimal(7,2)\n  ,wr_reversed_charge decimal(7,2)\n  ,wr_account_credit decimal(7,2)\n  ,wr_net_loss decimal(7,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/web_returns/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_sales\n (\n  ws_item_sk int\n  ,ws_order_number int\n  ,ws_sold_date_sk int\n  ,ws_sold_time_sk int\n  ,ws_ship_date_sk int\n  ,ws_bill_customer_sk int\n  ,ws_bill_cdemo_sk int\n  ,ws_bill_hdemo_sk int\n  ,ws_bill_addr_sk int\n  ,ws_ship_customer_sk int\n  ,ws_ship_cdemo_sk int\n  ,ws_ship_hdemo_sk int\n  ,ws_ship_addr_sk int\n  ,ws_web_page_sk int\n  ,ws_web_site_sk int\n  ,ws_ship_mode_sk int\n  ,ws_warehouse_sk int\n  ,ws_promo_sk int\n  ,ws_quantity int\n  ,ws_wholesale_cost decimal(7,2)\n  ,ws_list_price decimal(7,2)\n  ,ws_sales_price decimal(7,2)\n  ,ws_ext_discount_amt decimal(7,2)\n  ,ws_ext_sales_price decimal(7,2)\n  ,ws_ext_wholesale_cost decimal(7,2)\n  ,ws_ext_list_price decimal(7,2)\n  ,ws_ext_tax decimal(7,2)\n  ,ws_coupon_amt decimal(7,2)\n  ,ws_ext_ship_cost decimal(7,2)\n  ,ws_net_paid decimal(7,2)\n  ,ws_net_paid_inc_tax  decimal(7,2)\n  ,ws_net_paid_inc_ship  decimal(7,2)\n  ,ws_net_paid_inc_ship_tax  decimal(7,2)\n  ,ws_net_profit decimal(7,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/web_sales/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS catalog_sales\n (\n  cs_item_sk int\n  ,cs_order_number int\n  ,cs_sold_date_sk int\n  ,cs_sold_time_sk int\n  ,cs_ship_date_sk int\n  ,cs_bill_customer_sk int\n  ,cs_bill_cdemo_sk int\n  ,cs_bill_hdemo_sk int\n  ,cs_bill_addr_sk int\n  ,cs_ship_customer_sk int\n  ,cs_ship_cdemo_sk int\n  ,cs_ship_hdemo_sk int\n  ,cs_ship_addr_sk int\n  ,cs_call_center_sk int\n  ,cs_catalog_page_sk int\n  ,cs_ship_mode_sk int\n  ,cs_warehouse_sk int\n  ,cs_promo_sk int\n  ,cs_quantity int\n  ,cs_wholesale_cost decimal(7,2)\n  ,cs_list_price decimal(7,2)\n  ,cs_sales_price decimal(7,2)\n  ,cs_ext_discount_amt decimal(7,2)\n  ,cs_ext_sales_price decimal(7,2)\n  ,cs_ext_wholesale_cost decimal(7,2)\n  ,cs_ext_list_price decimal(7,2)\n  ,cs_ext_tax decimal(7,2)\n  ,cs_coupon_amt decimal(7,2)\n  ,cs_ext_ship_cost decimal(7,2)\n  ,cs_net_paid decimal(7,2)\n  ,cs_net_paid_inc_tax  decimal(7,2)\n  ,cs_net_paid_inc_ship  decimal(7,2)\n  ,cs_net_paid_inc_ship_tax decimal(7,2)\n  ,cs_net_profit decimal(7,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/catalog_sales/\'\ntblproperties("parquet.compression"="Lz4");\n\nCREATE EXTERNAL TABLE IF NOT EXISTS store_sales\n (\n  ss_item_sk int\n  ,ss_ticket_number int\n  ,ss_sold_date_sk int\n  ,ss_sold_time_sk int\n  ,ss_customer_sk int\n  ,ss_cdemo_sk int\n  ,ss_hdemo_sk int\n  ,ss_addr_sk int\n  ,ss_store_sk int\n  ,ss_promo_sk int\n  ,ss_quantity int\n  ,ss_wholesale_cost decimal(7,2)\n  ,ss_list_price decimal(7,2)\n  ,ss_sales_price decimal(7,2)\n  ,ss_ext_discount_amt decimal(7,2)\n  ,ss_ext_sales_price decimal(7,2)\n  ,ss_ext_wholesale_cost decimal(7,2)\n  ,ss_ext_list_price decimal(7,2)\n  ,ss_ext_tax decimal(7,2)\n  ,ss_coupon_amt decimal(7,2)\n  ,ss_net_paid decimal(7,2)\n  ,ss_net_paid_inc_tax decimal(7,2)\n  ,ss_net_profit decimal(7,2)\n )\nstored as PARQUET\nLOCATION \'/user/tmp/parquet/store_sales/\'\ntblproperties("parquet.compression"="Lz4");\n'})}),"\n",(0,t.jsx)(n.h3,{id:"54-create-hive-external-tablescsv",children:"5.4 Create Hive external tables\uff08CSV\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-SQL",children:"use tpcds_100g_csv;\n\nCREATE EXTERNAL TABLE IF NOT EXISTS customer_address\n (\n  ca_address_sk int\n  ,ca_address_id varchar(16)\n  ,ca_street_number varchar(10)\n  ,ca_street_name varchar(60)\n  ,ca_street_type varchar(15)\n  ,ca_suite_number varchar(10)\n  ,ca_city varchar(60)\n  ,ca_county varchar(30)\n  ,ca_state varchar(2)\n  ,ca_zip varchar(10)\n  ,ca_country varchar(20)\n  ,ca_gmt_offset decimal(5,2)\n  ,ca_location_type varchar(20)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/customer_address/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS customer_demographics\n (\n  cd_demo_sk int\n ,cd_gender varchar(1)\n ,cd_marital_status varchar(1)\n ,cd_education_status varchar(20)\n ,cd_purchase_estimate   int\n ,cd_credit_rating varchar(10)\n ,cd_dep_count int\n ,cd_dep_employed_count int\n ,cd_dep_college_count int\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/customer_demographics/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS date_dim\n (\n  d_date_sk int\n  ,d_date_id varchar(16)\n  ,d_date date\n  ,d_month_seq int\n  ,d_week_seq int\n  ,d_quarter_seq int\n  ,d_year int\n  ,d_dow int\n  ,d_moy int\n  ,d_dom int\n  ,d_qoy int\n  ,d_fy_year int\n  ,d_fy_quarter_seq int\n  ,d_fy_week_seq int\n  ,d_day_name varchar(9)\n  ,d_quarter_name varchar(6)\n  ,d_holiday varchar(1)\n  ,d_weekend varchar(1)\n  ,d_following_holiday varchar(1)\n  ,d_first_dom int\n  ,d_last_dom int\n  ,d_same_day_ly int\n  ,d_same_day_lq int\n  ,d_current_day varchar(1)\n  ,d_current_week varchar(1)\n  ,d_current_month varchar(1)\n  ,d_current_quarter varchar(1)\n  ,d_current_year varchar(1)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/date_dim/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS warehouse\n (\n  w_warehouse_sk int\n  ,w_warehouse_id varchar(16)\n  ,w_warehouse_name varchar(20)\n  ,w_warehouse_sq_ft int\n  ,w_street_number varchar(10)\n  ,w_street_name varchar(60)\n  ,w_street_type varchar(15)\n  ,w_suite_number varchar(10)\n  ,w_city varchar(60)\n  ,w_county varchar(30)\n  ,w_state varchar(2)\n  ,w_zip varchar(10)\n  ,w_country varchar(20)\n  ,w_gmt_offset decimal(5,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/warehouse/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS ship_mode\n (\n  sm_ship_mode_sk int\n  ,sm_ship_mode_id varchar(16)\n  ,sm_type varchar(30)\n  ,sm_code varchar(10)\n  ,sm_carrier varchar(20)\n  ,sm_contract varchar(20)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/ship_mode/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS time_dim\n (\n  t_time_sk int\n  ,t_time_id varchar(16)\n  ,t_time int\n  ,t_hour int\n  ,t_minute int\n  ,t_second int\n  ,t_am_pm varchar(2)\n  ,t_shift varchar(20)\n  ,t_sub_shift varchar(20)\n  ,t_meal_time varchar(20)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/time_dim/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS reason\n (\n  r_reason_sk int\n  ,r_reason_id varchar(16)\n  ,r_reason_desc varchar(100)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/reason/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS income_band\n (\n  ib_income_band_sk integer ,\n  ib_lower_bound integer ,\n  ib_upper_bound integer\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/income_band/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS item\n (\n  i_item_sk int\n  ,i_item_id varchar(16)\n  ,i_rec_start_date date\n  ,i_rec_end_date date\n  ,i_item_desc varchar(200)\n  ,i_current_price decimal(7,2)\n  ,i_wholesale_cost decimal(7,2)\n  ,i_brand_id int\n  ,i_brand varchar(50)\n  ,i_class_id int\n  ,i_class varchar(50)\n  ,i_category_id int\n  ,i_category varchar(50)\n  ,i_manufact_id int\n  ,i_manufact varchar(50)\n  ,i_size varchar(20)\n  ,i_formulation varchar(20)\n  ,i_color varchar(20)\n  ,i_units varchar(10)\n  ,i_container varchar(10)\n  ,i_manager_id int\n  ,i_product_name varchar(50)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/item/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS store\n (\n  s_store_sk int\n  ,s_store_id varchar(16)\n  ,s_rec_start_date date\n  ,s_rec_end_date date\n  ,s_closed_date_sk int\n  ,s_store_name varchar(50)\n  ,s_number_employees int\n  ,s_floor_space int\n  ,s_hours varchar(20)\n  ,s_manager varchar(40)\n  ,s_market_id int\n  ,s_geography_class varchar(100)\n  ,s_market_desc varchar(100)\n  ,s_market_manager varchar(40)\n  ,s_division_id int\n  ,s_division_name varchar(50)\n  ,s_company_id int\n  ,s_company_name varchar(50)\n  ,s_street_number varchar(10)\n  ,s_street_name varchar(60)\n  ,s_street_type varchar(15)\n  ,s_suite_number varchar(10)\n  ,s_city varchar(60)\n  ,s_county varchar(30)\n  ,s_state varchar(2)\n  ,s_zip varchar(10)\n  ,s_country varchar(20)\n  ,s_gmt_offset decimal(5,2)\n  ,s_tax_precentage decimal(5,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/store/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS call_center\n (\n  cc_call_center_sk int\n  ,cc_call_center_id varchar(16)\n  ,cc_rec_start_date date\n  ,cc_rec_end_date date\n  ,cc_closed_date_sk int\n  ,cc_open_date_sk int\n  ,cc_name varchar(50)\n  ,cc_class varchar(50)\n  ,cc_employees int\n  ,cc_sq_ft int\n  ,cc_hours varchar(20)\n  ,cc_manager varchar(40)\n  ,cc_mkt_id int\n  ,cc_mkt_class varchar(50)\n  ,cc_mkt_desc varchar(100)\n  ,cc_market_manager varchar(40)\n  ,cc_division int\n  ,cc_division_name varchar(50)\n  ,cc_company int\n  ,cc_company_name varchar(50)\n  ,cc_street_number varchar(10)\n  ,cc_street_name varchar(60)\n  ,cc_street_type varchar(15)\n  ,cc_suite_number varchar(10)\n  ,cc_city varchar(60)\n  ,cc_county varchar(30)\n  ,cc_state varchar(2)\n  ,cc_zip varchar(10)\n  ,cc_country varchar(20)\n  ,cc_gmt_offset decimal(5,2)\n  ,cc_tax_percentage decimal(5,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/call_center/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS customer\n (\n  c_customer_sk int\n  ,c_customer_id varchar(16)\n  ,c_current_cdemo_sk int\n  ,c_current_hdemo_sk int\n  ,c_current_addr_sk int\n  ,c_first_shipto_date_sk    int\n  ,c_first_sales_date_sk     int\n  ,c_salutation varchar(10)\n  ,c_first_name varchar(20)\n  ,c_last_name varchar(30)\n  ,c_preferred_cust_flag     varchar(1)\n  ,c_birth_day int\n  ,c_birth_month int\n  ,c_birth_year int\n  ,c_birth_country varchar(20)\n  ,c_login varchar(13)\n  ,c_email_address varchar(50)\n  ,c_last_review_date varchar(10)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/customer/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_site\n (\n  web_site_sk int\n  ,web_site_id varchar(16)\n  ,web_rec_start_date date\n  ,web_rec_end_date date\n  ,web_name varchar(50)\n  ,web_open_date_sk int\n  ,web_close_date_sk int\n  ,web_class varchar(50)\n  ,web_manager varchar(40)\n  ,web_mkt_id int\n  ,web_mkt_class varchar(50)\n  ,web_mkt_desc varchar(100)\n  ,web_market_manager varchar(40)\n  ,web_company_id int\n  ,web_company_name varchar(50)\n  ,web_street_number varchar(10)\n  ,web_street_name varchar(60)\n  ,web_street_type varchar(15)\n  ,web_suite_number varchar(10)\n  ,web_city varchar(60)\n  ,web_county varchar(30)\n  ,web_state varchar(2)\n  ,web_zip varchar(10)\n  ,web_country varchar(20)\n  ,web_gmt_offset decimal(5,2)\n  ,web_tax_percentage decimal(5,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/web_site/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS store_returns\n (\n  sr_item_sk int\n  ,sr_ticket_number int\n  ,sr_returned_date_sk int\n  ,sr_return_time_sk int\n  ,sr_customer_sk int\n  ,sr_cdemo_sk int\n  ,sr_hdemo_sk int\n  ,sr_addr_sk int\n  ,sr_store_sk int\n  ,sr_reason_sk int\n  ,sr_return_quantity int\n  ,sr_return_amt decimal(7,2)\n  ,sr_return_tax decimal(7,2)\n  ,sr_return_amt_inc_tax decimal(7,2)\n  ,sr_fee decimal(7,2)\n  ,sr_return_ship_cost decimal(7,2)\n  ,sr_refunded_cash decimal(7,2)\n  ,sr_reversed_charge decimal(7,2)\n  ,sr_store_credit decimal(7,2)\n  ,sr_net_loss decimal(7,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/store_returns/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS household_demographics\n (\n  hd_demo_sk int\n  ,hd_income_band_sk int\n  ,hd_buy_potential varchar(15)\n  ,hd_dep_count int\n  ,hd_vehicle_count int\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/household_demographics/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_page\n (\n  wp_web_page_sk int\n  ,wp_web_page_id varchar(16)\n  ,wp_rec_start_date date\n  ,wp_rec_end_date date\n  ,wp_creation_date_sk int\n  ,wp_access_date_sk int\n  ,wp_autogen_flag varchar(1)\n  ,wp_customer_sk int\n  ,wp_url varchar(100)\n  ,wp_type varchar(50)\n  ,wp_char_count int\n  ,wp_link_count int\n  ,wp_image_count int\n  ,wp_max_ad_count int\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/web_page/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS promotion\n (\n  p_promo_sk int\n  ,p_promo_id varchar(16)\n  ,p_start_date_sk int\n  ,p_end_date_sk int\n  ,p_item_sk int\n  ,p_cost decimal(15,2)\n  ,p_response_target int\n  ,p_promo_name varchar(50)\n  ,p_channel_dmail varchar(1)\n  ,p_channel_email varchar(1)\n  ,p_channel_catalog varchar(1)\n  ,p_channel_tv varchar(1)\n  ,p_channel_radio varchar(1)\n  ,p_channel_press varchar(1)\n  ,p_channel_event varchar(1)\n  ,p_channel_demo varchar(1)\n  ,p_channel_details varchar(100)\n  ,p_purpose varchar(15)\n  ,p_discount_active varchar(1)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/promotion/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS catalog_page\n (\n  cp_catalog_page_sk int\n  ,cp_catalog_page_id varchar(16)\n  ,cp_start_date_sk int\n  ,cp_end_date_sk int\n  ,cp_department varchar(50)\n  ,cp_catalog_number int\n  ,cp_catalog_page_number    int\n  ,cp_description varchar(100)\n  ,cp_type varchar(100)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/catalog_page/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS inventory\n (\n  inv_date_sk integer ,\n  inv_item_sk integer ,\n  inv_warehouse_sk integer ,\n  inv_quantity_on_hand integer\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/inventory/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS catalog_returns\n (\n  cr_item_sk int\n  ,cr_order_number int\n  ,cr_returned_date_sk int\n  ,cr_returned_time_sk int\n  ,cr_refunded_customer_sk int\n  ,cr_refunded_cdemo_sk  int\n  ,cr_refunded_hdemo_sk  int\n  ,cr_refunded_addr_sk int\n  ,cr_returning_customer_sk int\n  ,cr_returning_cdemo_sk     int\n  ,cr_returning_hdemo_sk     int\n  ,cr_returning_addr_sk  int\n  ,cr_call_center_sk int\n  ,cr_catalog_page_sk int\n  ,cr_ship_mode_sk int\n  ,cr_warehouse_sk int\n  ,cr_reason_sk int\n  ,cr_return_quantity int\n  ,cr_return_amount decimal(7,2)\n  ,cr_return_tax decimal(7,2)\n  ,cr_return_amt_inc_tax     decimal(7,2)\n  ,cr_fee decimal(7,2)\n  ,cr_return_ship_cost  decimal(7,2)\n  ,cr_refunded_cash decimal(7,2)\n  ,cr_reversed_charge decimal(7,2)\n  ,cr_store_credit decimal(7,2)\n  ,cr_net_loss decimal(7,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/catalog_returns/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_returns\n (\n  wr_item_sk int\n  ,wr_order_number int\n  ,wr_returned_date_sk int\n  ,wr_returned_time_sk int\n  ,wr_refunded_customer_sk   int\n  ,wr_refunded_cdemo_sk  int\n  ,wr_refunded_hdemo_sk int\n  ,wr_refunded_addr_sk int\n  ,wr_returning_customer_sk  int\n  ,wr_returning_cdemo_sk     int\n  ,wr_returning_hdemo_sk     int\n  ,wr_returning_addr_sk  int\n  ,wr_web_page_sk int\n  ,wr_reason_sk int\n  ,wr_return_quantity int\n  ,wr_return_amt decimal(7,2)\n  ,wr_return_tax decimal(7,2)\n  ,wr_return_amt_inc_tax     decimal(7,2)\n  ,wr_fee decimal(7,2)\n  ,wr_return_ship_cost decimal(7,2)\n  ,wr_refunded_cash decimal(7,2)\n  ,wr_reversed_charge decimal(7,2)\n  ,wr_account_credit decimal(7,2)\n  ,wr_net_loss decimal(7,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/web_returns/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS web_sales\n (\n  ws_item_sk int\n  ,ws_order_number int\n  ,ws_sold_date_sk int\n  ,ws_sold_time_sk int\n  ,ws_ship_date_sk int\n  ,ws_bill_customer_sk int\n  ,ws_bill_cdemo_sk int\n  ,ws_bill_hdemo_sk int\n  ,ws_bill_addr_sk int\n  ,ws_ship_customer_sk int\n  ,ws_ship_cdemo_sk int\n  ,ws_ship_hdemo_sk int\n  ,ws_ship_addr_sk int\n  ,ws_web_page_sk int\n  ,ws_web_site_sk int\n  ,ws_ship_mode_sk int\n  ,ws_warehouse_sk int\n  ,ws_promo_sk int\n  ,ws_quantity int\n  ,ws_wholesale_cost decimal(7,2)\n  ,ws_list_price decimal(7,2)\n  ,ws_sales_price decimal(7,2)\n  ,ws_ext_discount_amt decimal(7,2)\n  ,ws_ext_sales_price decimal(7,2)\n  ,ws_ext_wholesale_cost decimal(7,2)\n  ,ws_ext_list_price decimal(7,2)\n  ,ws_ext_tax decimal(7,2)\n  ,ws_coupon_amt decimal(7,2)\n  ,ws_ext_ship_cost decimal(7,2)\n  ,ws_net_paid decimal(7,2)\n  ,ws_net_paid_inc_tax  decimal(7,2)\n  ,ws_net_paid_inc_ship  decimal(7,2)\n  ,ws_net_paid_inc_ship_tax  decimal(7,2)\n  ,ws_net_profit decimal(7,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/web_sales/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS catalog_sales\n (\n  cs_item_sk int\n  ,cs_order_number int\n  ,cs_sold_date_sk int\n  ,cs_sold_time_sk int\n  ,cs_ship_date_sk int\n  ,cs_bill_customer_sk int\n  ,cs_bill_cdemo_sk int\n  ,cs_bill_hdemo_sk int\n  ,cs_bill_addr_sk int\n  ,cs_ship_customer_sk int\n  ,cs_ship_cdemo_sk int\n  ,cs_ship_hdemo_sk int\n  ,cs_ship_addr_sk int\n  ,cs_call_center_sk int\n  ,cs_catalog_page_sk int\n  ,cs_ship_mode_sk int\n  ,cs_warehouse_sk int\n  ,cs_promo_sk int\n  ,cs_quantity int\n  ,cs_wholesale_cost decimal(7,2)\n  ,cs_list_price decimal(7,2)\n  ,cs_sales_price decimal(7,2)\n  ,cs_ext_discount_amt decimal(7,2)\n  ,cs_ext_sales_price decimal(7,2)\n  ,cs_ext_wholesale_cost decimal(7,2)\n  ,cs_ext_list_price decimal(7,2)\n  ,cs_ext_tax decimal(7,2)\n  ,cs_coupon_amt decimal(7,2)\n  ,cs_ext_ship_cost decimal(7,2)\n  ,cs_net_paid decimal(7,2)\n  ,cs_net_paid_inc_tax  decimal(7,2)\n  ,cs_net_paid_inc_ship  decimal(7,2)\n  ,cs_net_paid_inc_ship_tax decimal(7,2)\n  ,cs_net_profit decimal(7,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/catalog_sales/';\n\nCREATE EXTERNAL TABLE IF NOT EXISTS store_sales\n (\n  ss_item_sk int\n  ,ss_ticket_number int\n  ,ss_sold_date_sk int\n  ,ss_sold_time_sk int\n  ,ss_customer_sk int\n  ,ss_cdemo_sk int\n  ,ss_hdemo_sk int\n  ,ss_addr_sk int\n  ,ss_store_sk int\n  ,ss_promo_sk int\n  ,ss_quantity int\n  ,ss_wholesale_cost decimal(7,2)\n  ,ss_list_price decimal(7,2)\n  ,ss_sales_price decimal(7,2)\n  ,ss_ext_discount_amt decimal(7,2)\n  ,ss_ext_sales_price decimal(7,2)\n  ,ss_ext_wholesale_cost decimal(7,2)\n  ,ss_ext_list_price decimal(7,2)\n  ,ss_ext_tax decimal(7,2)\n  ,ss_coupon_amt decimal(7,2)\n  ,ss_net_paid decimal(7,2)\n  ,ss_net_paid_inc_tax decimal(7,2)\n  ,ss_net_profit decimal(7,2)\n )\nrow format delimited fields terminated by '|'\nLOCATION '/user/tmp/csv/store_sales/';\n"})})]})}const h=function(e={}){const{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,t.jsx)(n,Object.assign({},e,{children:(0,t.jsx)(l,e)})):l(e)}},36121:(e,n,r)=>{r.d(n,{Z:()=>t});const t=r.p+"assets/images/tpc-ds-39cd280b579448869a15866e114e6742.png"},11151:(e,n,r)=>{r.d(n,{Zo:()=>i,ah:()=>c});var t=r(67294);const s=t.createContext({});function c(e){const n=t.useContext(s);return t.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const _={};function i({components:e,children:n,disableParentContext:r}){let i;return i=r?"function"==typeof e?e({}):e||_:c(e),t.createElement(s.Provider,{value:i},n)}}}]);