<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-3.0 docs-doc-page docs-doc-id-administration/Monitor_and_Alert" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-beta.0">
<title data-rh="true">监控报警 | StarRocks</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://danroscigno.github.io/doc/zh/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://danroscigno.github.io/doc/zh/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://danroscigno.github.io/doc/zh/docs/3.0/administration/Monitor_and_Alert"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en_US"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="3.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.0"><meta data-rh="true" name="docsearch:version" content="3.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.0"><meta data-rh="true" property="og:title" content="监控报警 | StarRocks"><meta data-rh="true" name="description" content="本文介绍如何为 StarRocks 设置监控报警。"><meta data-rh="true" property="og:description" content="本文介绍如何为 StarRocks 设置监控报警。"><link data-rh="true" rel="icon" href="/doc/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danroscigno.github.io/doc/zh/docs/3.0/administration/Monitor_and_Alert"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/docs/3.0/administration/Monitor_and_Alert" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/zh/docs/3.0/administration/Monitor_and_Alert" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://danroscigno.github.io/doc/docs/3.0/administration/Monitor_and_Alert" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ER08SJMRY1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="StarRocks" href="/doc/zh/opensearch.xml"><link rel="stylesheet" href="/doc/zh/assets/css/styles.62f01ed5.css">
<script src="/doc/zh/assets/js/runtime~main.70780970.js" defer="defer"></script>
<script src="/doc/zh/assets/js/main.eac6741c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.starrocks.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/doc/zh/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc/zh/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">StarRocks</b></a><a class="navbar__item navbar__link" href="/doc/zh/docs/3.0/introduction/StarRocks_intro">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/doc/zh/docs/3.0/introduction/StarRocks_intro">3.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/zh/docs/next/examples/introduction">Next</a></li><li><a class="dropdown__link" href="/doc/zh/docs/administration/Monitor_and_Alert">3.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/doc/zh/docs/3.0/administration/Monitor_and_Alert">3.0</a></li><li><a class="dropdown__link" href="/doc/zh/docs/2.5/administration/Monitor_and_Alert">2.5</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/doc/docs/3.0/administration/Monitor_and_Alert" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">English</a></li><li><a href="/doc/zh/docs/3.0/administration/Monitor_and_Alert" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/StarRocks/starrocks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/zh/docs/3.0/introduction/StarRocks_intro">StarRocks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/产品简介">产品简介</a><button aria-label="Expand sidebar category &#x27;产品简介&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/quick_start">快速开始</a><button aria-label="Expand sidebar category &#x27;快速开始&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/deployment/deployment_overview">部署 StarRocks</a><button aria-label="Expand sidebar category &#x27;部署 StarRocks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/table_design/StarRocks_table_design">表设计</a><button aria-label="Expand sidebar category &#x27;表设计&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/loading/Loading_intro">导入数据</a><button aria-label="Expand sidebar category &#x27;导入数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/导出数据">导出数据</a><button aria-label="Expand sidebar category &#x27;导出数据&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/查询数据湖">查询数据湖</a><button aria-label="Expand sidebar category &#x27;查询数据湖&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/查询加速">查询加速</a><button aria-label="Expand sidebar category &#x27;查询加速&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/外部系统集成">外部系统集成</a><button aria-label="Expand sidebar category &#x27;外部系统集成&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/doc/zh/docs/3.0/category/管理手册">管理手册</a><button aria-label="Collapse sidebar category &#x27;管理手册&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/doc/zh/docs/3.0/category/运维集群">运维集群</a><button aria-label="Collapse sidebar category &#x27;运维集群&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/Scale_up_down">扩容缩容 StarRocks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/Backup_and_restore">备份与恢复</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/Configuration">配置参数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/doc/zh/docs/3.0/administration/Monitor_and_Alert">监控报警</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/audit_loader">通过 Audit Loader 管理 StarRocks 中的审计日志</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/enable_fqdn">启用 FQDN 访问</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/timezone">设置时区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/information_schema">Information Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/monitor_manage_big_queries">监控管理大查询</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/doc/zh/docs/3.0/category/管理资源">管理资源</a><button aria-label="Expand sidebar category &#x27;管理资源&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/doc/zh/docs/3.0/administration/Data_recovery">恢复数据</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/doc/zh/docs/3.0/administration/privilege_overview">管理用户权限</a><button aria-label="Expand sidebar category &#x27;管理用户权限&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/doc/zh/docs/3.0/category/性能调优">性能调优</a><button aria-label="Expand sidebar category &#x27;性能 调优&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/参考手册">参考手册</a><button aria-label="Expand sidebar category &#x27;参考手册&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/faq-1">FAQ</a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/benchmarks-1">Benchmarks</a><button aria-label="Expand sidebar category &#x27;Benchmarks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/developers-1">Developers</a><button aria-label="Expand sidebar category &#x27;Developers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/doc/zh/docs/3.0/category/ecosystem-release-notes-1">Ecosystem Release Notes</a><button aria-label="Expand sidebar category &#x27;Ecosystem Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/doc/zh/docs/3.0/category/管理手册"><span itemprop="name">管理手册</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/doc/zh/docs/3.0/category/运维集群"><span itemprop="name">运维集群</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">监控报警</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：3.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>监控报警</h1>
<p>本文介绍如何为 StarRocks 设置监控报警。</p>
<p>StarRocks 提供两种监控报警的方案。企业版用户可以使用内置的 StarRocksManager，其自带的 Agent 从各个 Host 采集监控信息，上报至 Center Service，然后做可视化展示。StarRocksManager 提供邮件和 Webhook 的方式发送报警通知。如果您有二次开发需求，需要自行搭建部署监控服务，也可以使用开源 Prometheus+Grafana 方案，StarRocks 提供了兼容 Prometheus 的信息采集接口，可以通过直接连接 BE 或 FE 的 HTTP 端口来获取集群的监控信息。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用-starrocksmanager">使用 StarRocksManager<a href="#使用-starrocksmanager" class="hash-link" aria-label="使用 StarRocksManager的直接链接" title="使用 StarRocksManager的直接链接">​</a></h2>
<p>StarRocksManager 的监控可以分成 <strong>集群</strong> 和 <strong>节点</strong> 两个维度。</p>
<p>您可以在集群页面可以看到下列监控项：</p>
<ul>
<li>集群性能监控<!-- -->
<ul>
<li>CPU 使用率</li>
<li>内存使用</li>
<li>磁盘 I/O 使用率，磁盘使用量、磁盘空闲量</li>
<li>发包带宽、收包带宽，发包数、收包数</li>
</ul>
</li>
<li>集群查询监控<!-- -->
<ul>
<li>QPS</li>
<li>平均响应时间</li>
<li>50/75/90/95/99/999 分位响应时间</li>
</ul>
</li>
<li>数据导入量监控<!-- -->
<ul>
<li>发起导入次数</li>
<li>导入行数</li>
<li>导入数据量</li>
</ul>
</li>
<li>数据组合并（Compaction）监控<!-- -->
<ul>
<li>基线合并数据组速率</li>
<li>基线合并数据量</li>
<li>增量合并数据组速率</li>
<li>增量合并数据量</li>
</ul>
</li>
</ul>
<p>在<strong>节点</strong>页面可以看到所有 BE/FE 的机器列表和状态等基础信息。</p>
<p><img loading="lazy" alt="8.10.1-1" src="/doc/zh/assets/images/8.10.1-1-2bf28282d70d487702dfd958fc785606.png" width="3024" height="1394" class="img_ev3q"></p>
<p>点击节点链接可以看到每一个节点的详细监控信息。在右侧的节点列表中选择多个节点同时展示，也可以在上方的下拉框中选择各类指标。</p>
<p><img loading="lazy" alt="8.10.1-2" src="/doc/zh/assets/images/8.10.1-2-fda2e102210f7275b98b2327e032a877.png" width="2173" height="840" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用-prometheusgrafana">使用 Prometheus+Grafana<a href="#使用-prometheusgrafana" class="hash-link" aria-label="使用 Prometheus+Grafana的直接链接" title="使用 Prometheus+Grafana的直接链接">​</a></h2>
<p>您可以使用 <a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus</a> 作为 StarRocks 监控数据存储方案，并使用 <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">Grafana</a> 作为可视化组件。</p>
<p>Prometheus 是一个拥有多维度数据模型的、灵活的查询语句的时序数据库。它可以通过 Pull 或 Push 采集被监控系统的监控项，存入自身的时序数据库中。并且通过丰富的多维数据查询语言，满足用户的不同需求。</p>
<p>Grafana 是一个开源的 Metric 分析及可视化系统。支持多种数据源，详情可参考官网文档。通过对应的查询语句，从数据源中获取展现数据。通过灵活可配置的 Dashboard，快速的将这些数据以图表的形式展示给用户。</p>
<blockquote>
<p>本文档仅提供基于 Prometheus 和 Grafana 实现的一种 StarRocks 可视化监控方案，原则上不维护和开发这些组件。更多详细的介绍和使用，请参考对应的官网文档。</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="监控架构">监控架构<a href="#监控架构" class="hash-link" aria-label="监控架构的直接链接" title="监控架构的直接链接">​</a></h3>
<p><img loading="lazy" alt="8.10.2-1" src="/doc/zh/assets/images/8.10.2-1-8b6c6ae1f9e30e37d254a3e336569531.png" width="1488" height="686" class="img_ev3q"></p>
<p>Prometheus 通过 Pull 方式访问 FE 或 BE 的 Metric 接口，然后将监控数据存入时序数据库。</p>
<p>用户可以通过 Grafana 配置 Prometheus 为数据源，自定义绘制 Dashboard。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="部署-prometheus">部署 Prometheus<a href="#部署-prometheus" class="hash-link" aria-label="部署 Prometheus的直接链接" title="部署 Prometheus的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="下载并安装-prometheus">下载并安装 Prometheus<a href="#下载并安装-prometheus" class="hash-link" aria-label="下载并安装 Prometheus的直接链接" title="下载并安装 Prometheus的直接链接">​</a></h4>
<p><strong>1.</strong> 从 <a href="https://prometheus.io/download/" target="_blank" rel="noopener noreferrer">Prometheus 官网</a>下载最新版本的 Prometheus。</p>
<p>以下示例以 prometheus-2.29.1.linux-amd64 版本为例。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://github.com/prometheus/prometheus/releases/download/v2.29.1/prometheus-2.29.1.linux-amd64.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> -xf prometheus-2.29.1.linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置-prometheus">配置 Prometheus<a href="#配置-prometheus" class="hash-link" aria-label="配置 Prometheus的直接链接" title="配置 Prometheus的直接链接">​</a></h4>
<p>在 <strong>prometheus.yml</strong> 中添加 StarRocks 监控相关的配置。</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># my global config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">global</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scrape_interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     15s </span><span class="token comment" style="color:#999988;font-style:italic"># 全局的采集间隔，默认是 1m，这里设置为 15s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">evaluation_interval</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 15s </span><span class="token comment" style="color:#999988;font-style:italic"># 全局的规则触发间隔，默认是 1m，这里设置 15s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">scrape_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;StarRocks_Cluster01&#x27;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 每一个集群称之为一个job，可以自定义名字作为StarRocks集群名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metrics_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/metrics&#x27;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 指定获取监控项目的Restful Api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;fe_host1:http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;fe_host3:http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;fe_host3:http_port&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fe </span><span class="token comment" style="color:#999988;font-style:italic"># 这里配置了 fe 的 group，该 group 中包含了 3 个 Frontends</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;be_host1:be_http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;be_host2:be_http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;be_host3:be_http_port&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> be </span><span class="token comment" style="color:#999988;font-style:italic"># 这里配置了 be 的 group，该 group 中包含了 3 个 Backends</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">job_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;StarRocks_Cluster02&#x27;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 可以在Prometheus中监控多个StarRocks集群</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metrics_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/metrics&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">static_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;fe_host1:http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;fe_host3:http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;fe_host3:http_port&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> fe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">targets</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;be_host1:be_http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;be_host2:be_http_port&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;be_host3:be_http_port&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> be</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="启动-prometheus">启动 Prometheus<a href="#启动-prometheus" class="hash-link" aria-label="启动 Prometheus的直接链接" title="启动 Prometheus的直接链接">​</a></h4>
<p>通过以下命令启动 Prometheus。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">nohup</span><span class="token plain"> ./prometheus </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --config.file</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;./prometheus.yml&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --web.listen-address</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;:9090&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --log.level</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;info&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该命令将后台运行 Prometheus，并指定其 Web 端口为 <code>9090</code>。启动后，即开始采集数据，并将数据存放在 <strong>./data</strong> 目录中。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="访问-prometheus">访问 Prometheus<a href="#访问-prometheus" class="hash-link" aria-label="访问 Prometheus的直接链接" title="访问 Prometheus的直接链接">​</a></h4>
<p>您可以通过 Web 页面访问 Prometheus。通过浏览器打开 <code>9090</code> 端口，即可访问 Prometheus 的页面。依次点击导航栏中 <strong>Status</strong> 和 <strong>Targets</strong>，即可看到所有分组 Job 的监控主机节点。正常情况下，所有节点都应为 UP，表示数据采集正常。如果节点状态不为 UP，您可以访问 StarRocks 的 Metrics 接口（<code>http://fe_host:fe_http_port/metrics</code> 或 <code>http://be_host:be_http_port/metrics</code>）检查是否可以访问。如果仍无法解决，您可以查询 Prometheus 相关文档寻找解决方案。</p>
<p><img loading="lazy" alt="8.10.2-6" src="/doc/zh/assets/images/8.10.2-6-9c0e3d65c339da3cde5e0f890c072428.png" width="2120" height="1234" class="img_ev3q"></p>
<p>至此，一个简单的 Prometheus 已经搭建、配置完毕。更多高级使用方式，请参阅<a href="https://prometheus.io/docs/introduction/overview/" target="_blank" rel="noopener noreferrer">官方文档</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据接入自有-prometheus">数据接入自有 Prometheus<a href="#数据接入自有-prometheus" class="hash-link" aria-label="数据接入自有 Prometheus的直接链接" title="数据接入自有 Prometheus的直接链接">​</a></h4>
<p>如果需要将监控数据接入自有的 Prometheus 系统，您可以通过下列接口访问：</p>
<ul>
<li>FE: <code>fe_host:fe_http_port/metrics</code></li>
<li>BE: <code>be_host:be_web_server_port/metrics</code></li>
</ul>
<p>如果需要 JSON 格式数据，您可以通过下列接口访问：</p>
<ul>
<li>FE: <code>fe_host:fe_http_port/metrics?type=json</code></li>
<li>BE: <code>be_host:be_web_server_port/metrics?type=json</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="部署-grafana">部署 Grafana<a href="#部署-grafana" class="hash-link" aria-label="部署 Grafana的直接链接" title="部署 Grafana的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="下载并安装-grafana">下载并安装 Grafana<a href="#下载并安装-grafana" class="hash-link" aria-label="下载并安装 Grafana的直接链接" title="下载并安装 Grafana的直接链接">​</a></h4>
<p>从 <a href="https://grafana.com/grafana/download" target="_blank" rel="noopener noreferrer">Grafana 官网</a> 下载最新版本的 Grafana。</p>
<p>以下示例以 grafana-8.0.6.linux-amd64 版本为例。</p>
<div class="language-SHELL language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://dl.grafana.com/oss/release/grafana-8.0.6.linux-amd64.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">tar</span><span class="token plain"> -zxf grafana-8.0.6.linux-amd64.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置-grafana">配置 Grafana<a href="#配置-grafana" class="hash-link" aria-label="配置 Grafana的直接链接" title="配置 Grafana的直接链接">​</a></h4>
<p>在 <strong>./conf/defaults.ini</strong> 中添加相关的配置。</p>
<div class="language-ini codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ini codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[paths]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data = ./data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logs = ./data/log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plugins = ./data/plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[server]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http_port = 8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">domain = localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="启动-grafana">启动 Grafana<a href="#启动-grafana" class="hash-link" aria-label="启动 Grafana的直接链接" title="启动 Grafana的直接链接">​</a></h4>
<p>通过以下命令启动 Grafana。</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nohup ./bin/grafana-server \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --config=&quot;./conf/defaults.ini&quot; &amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置-dashboard">配置 DashBoard<a href="#配置-dashboard" class="hash-link" aria-label="配置 DashBoard的直接链接" title="配置 DashBoard的直接链接">​</a></h4>
<p>通过先前配置的地址（<code>http://grafana_host:8000</code>）登录 Grafana，默认用户名为 <code>admin</code>，密码为 <code>admin</code>。</p>
<p><strong>1.</strong> 配置数据源。</p>
<p>依次点击 <strong>Configuration</strong>，<strong>Data sources</strong>，<strong>Add data source</strong>，和 <strong>Prometheus</strong>。</p>
<p>Data Source 配置项简介</p>
<p><img loading="lazy" alt="8.10.2-2" src="/doc/zh/assets/images/8.10.2-2-c085a77a8dcb9525052626cf9b6575b9.png" width="2188" height="1330" class="img_ev3q"></p>
<ul>
<li>Name: 数据源的名称，自定义，比如 <code>starrocks_monitor</code></li>
<li>URL: Prometheus 的 web 地址，如 <code>http://prometheus_host:9090</code></li>
<li>Access: 选择 Server 方式，即通过 Grafana 进程所在服务器，访问 Prometheus。</li>
</ul>
<p>其他配置项可使用默认设置。</p>
<p>点击最下方 <strong>Save &amp; Test</strong> 保存配置，如果显示 <em>Data source is working</em>，即表示数据源可用。</p>
<p><strong>2.</strong> 添加 Dashboard。</p>
<p>下载  Dashboard 模版。</p>
<blockquote>
<p>说明：StarRocks 1.19.0 和 2.4.0 版本的监控 Metric Name 有调整，需要下载下面对应版本 DashBoard 模版。</p>
</blockquote>
<ul>
<li><a href="http://starrocks-thirdparty.oss-cn-zhangjiakou.aliyuncs.com/StarRocks-Overview.json" target="_blank" rel="noopener noreferrer">StarRocks-1.19.0 之前版本 Dashboard 模版</a></li>
<li><a href="http://starrocks-thirdparty.oss-cn-zhangjiakou.aliyuncs.com/StarRocks-Overview-19.json" target="_blank" rel="noopener noreferrer">StarRocks-1.19.0 开始到 StarRocks-2.4.0 之前版本 DashBoard 模版</a></li>
<li><a href="http://starrocks-thirdparty.oss-cn-zhangjiakou.aliyuncs.com/StarRocks-Overview-24.json" target="_blank" rel="noopener noreferrer">StarRocks-2.4.0 及其之后版本 DashBoard 模版</a></li>
</ul>
<blockquote>
<p>说明：Dashboard 模版会不定期更新。同时我们也欢迎您提供更优的 Dashboard 模板。</p>
</blockquote>
<p>确认数据源可用后，点击左边导航栏的 <strong>+</strong> 号以添加 Dashboard。这里我们使用上文下载的 StarRocks 的 Dashboard 模板。依次点击左边的导航栏 <strong>+</strong> 号，<strong>Import</strong>，和 <strong>Upload Json File</strong>，导入 JSON 文件。</p>
<p>导入后，可以命名 Dashboard，默认是 <code>StarRocks Overview</code>。同时，需要选择数据源，这里选择之前创建的 <code>starrocks_monitor</code>。</p>
<p>点击 <strong>Import</strong> 完成导入。至此，您可以看到 StarRocks 的 Dashboard 展示。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="理解-dashboard">理解 Dashboard<a href="#理解-dashboard" class="hash-link" aria-label="理解 Dashboard的直接链接" title="理解 Dashboard的直接链接">​</a></h4>
<p>本小节简要介绍 StarRocks Dashboard。</p>
<blockquote>
<p>注意：Dashboard 的内容可能会随版本升级，不断更新，请参考上文 Dashboard 模版。</p>
</blockquote>
<ul>
<li><strong>顶栏</strong></li>
</ul>
<p><img loading="lazy" alt="8.10.2-3" src="/doc/zh/assets/images/8.10.2-3-9d13eb065fd9e1e3e3c5070267e2d9d0.png" width="2416" height="208" class="img_ev3q"></p>
<p>页面左上角为 Dashboard 名称，右上角显示当前监控时间  范围。您可以下拉选择不同的时间范围，还可以指定定时刷新页面间隔。</p>
<ul>
<li>cluster_name: 即 Prometheus 配置文件中的各个 <code>job_name</code>，代表一个 StarRocks 集群。如果选择不同的 Cluster，下方的图表将展示对应集群的监控信息。</li>
<li>fe_master: 对应集群的 Leader FE 节点。</li>
<li>fe_instance: 对应集群的所有 FE 节点。选择不同的 FE，下方的图表将展示对应 FE 的监控信息。</li>
<li>be_instance: 对应集群的所有 BE 节点。选择不同的 BE，下方的图表将展示对应 BE 的监控信息。</li>
<li>interval: 部分图表展示了速率相关的监控项，这里可选择以特定间隔进行采样计算速率。</li>
</ul>
<blockquote>
<p>注意：建议您不要使用 15s 作为时间间隔，因其可能导致一些图表无法显示。</p>
</blockquote>
<ul>
<li><strong>Row</strong></li>
</ul>
<p><img loading="lazy" alt="8.10.2-4" src="/doc/zh/assets/images/8.10.2-4-e50fa30069a442fa5acb24b1f8123490.png" width="914" height="230" class="img_ev3q"></p>
<p>Grafana 中，Row 代表一组图表的集合。如上图中的 Overview、Cluster Overview 即两个不同的 Row。您可以通过点击当前 Row 以折叠该 Row。</p>
<p>当前 Dashboard 有如下 Row（持续更新中）：</p>
<ul>
<li>
<p>Overview: 所有 StarRocks 集群的汇总展示。</p>
</li>
<li>
<p>Cluster Overview: 选定集群的汇总展示。</p>
</li>
<li>
<p>Query Statistic: 选定集群的查询相关监控。</p>
</li>
<li>
<p>Jobs: 导入任务相关监控。</p>
</li>
<li>
<p>Transaction: 事务相关监控。</p>
</li>
<li>
<p>FE JVM: 选定 FE 的 JVM 监控。</p>
</li>
<li>
<p>BE: 选定集群 BE 的汇总展示。</p>
</li>
<li>
<p>BE Task: 选定集群 BE 的任务信息展示。</p>
</li>
<li>
<p><strong>图表</strong></p>
</li>
</ul>
<p><img loading="lazy" alt="8.10.2-5" src="/doc/zh/assets/images/8.10.2-5-26f293402d666066a117b1ff3b60000d.png" width="1334" height="668" class="img_ev3q"></p>
<p>一 个典型的图表分为以下几部分：</p>
<ul>
<li>鼠标悬停左上角的 <strong>i</strong> 图标，可以查看该图表的说明。</li>
<li>点击下方的图例，可以单独查看某一监控项。再次点击，则显示所有。</li>
<li>在图表中拖拽可以选定时间范围。</li>
<li>标题的 <strong>[]</strong> 中显示选定的集群名称。</li>
<li>部分数值对应左边的 Y 轴，部分对应右边的 Y 轴，可以通过图例末尾的 <strong>-right</strong> 区分。</li>
<li>依次点击 <strong>图表名称</strong> 和 <strong>Edit</strong>，可以对图表进行编辑。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="监控指标">监控指标<a href="#监控指标" class="hash-link" aria-label="监控指标的直接链接" title="监控指标的直接链接">​</a></h2>
<p>可供选择的 StarRocks 监控指标有：</p>
<table><thead><tr><th>指标</th><th align="center">单位</th><th align="center">类型</th><th>描述</th></tr></thead><tbody><tr><td>be_broker_count</td><td align="center">个</td><td align="center">平均值</td><td>Broker的数量。</td></tr><tr><td>be_brpc_endpoint_count</td><td align="center">个</td><td align="center">平均值</td><td>Brpc 中 StubCache 的数量。</td></tr><tr><td>be_bytes_read_per_second</td><td align="center">bytes/s</td><td align="center">平均值</td><td>BE 读取速度。</td></tr><tr><td>be_bytes_written_per_second</td><td align="center">bytes/s</td><td align="center">平均值</td><td>BE 写入速度。</td></tr><tr><td>be_base_compaction_bytes_per_second</td><td align="center">bytes/s</td><td align="center">平均值</td><td>BE 的基线合并速率。</td></tr><tr><td>be_cumulative_compaction_bytes_per_second</td><td align="center">bytes/s</td><td align="center">平均值</td><td>BE 的增量合并速率。</td></tr><tr><td>be_base_compaction_rowsets_per_second</td><td align="center">rowsets/s</td><td align="center">平均值</td><td>BE 的基线合并 rowsets 合并速率。</td></tr><tr><td>be_cumulative_compaction_rowsets_per_second</td><td align="center">rowsets/s</td><td align="center">平均值</td><td>BE 的增量合并 rowsets 合并速率。</td></tr><tr><td>be_base_compaction_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 基线合并失败。</td></tr><tr><td>be_clone_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 克隆失败</td></tr><tr><td>be_create_rollup_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 创建物化视图失败。</td></tr><tr><td>be_create_tablet_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 创建 tablet 失败。</td></tr><tr><td>be_cumulative_compaction_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 增量合并失败。</td></tr><tr><td>be_delete_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 删除失败。</td></tr><tr><td>be_finish_task_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE task 失败。</td></tr><tr><td>be_publish_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 版本发布失败。</td></tr><tr><td>be_report_tables_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 表上报失败。</td></tr><tr><td>be_report_disk_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 磁盘上报失败。</td></tr><tr><td>be_report_tablet_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 分片上报失败。</td></tr><tr><td>be_report_task_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 任务上报失败。</td></tr><tr><td>be_schema_change_failed</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 修改表结构失败。</td></tr><tr><td>be_base_compaction_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 基线合并请求。</td></tr><tr><td>be_clone_total_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 克隆请求。</td></tr><tr><td>be_create_rollup_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 创建物化视图请求。</td></tr><tr><td>be_create_tablet_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 创建分片请求。</td></tr><tr><td>be_cumulative_compaction_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 增量合并请求。</td></tr><tr><td>be_delete_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 删除请求。</td></tr><tr><td>be_finish_task_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 完成任务请求。</td></tr><tr><td>be_publish_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 版本发布请求。</td></tr><tr><td>be_report_tablets_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 分片上报请求。</td></tr><tr><td>be_report_disk_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 磁盘上报请求。</td></tr><tr><td>be_report_tablet_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 任务上报请求。</td></tr><tr><td>be_report_task_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 任务上报请求。</td></tr><tr><td>be_schema_change_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 表结构修改请求。</td></tr><tr><td>be_storage_migrate_requests</td><td align="center">个/秒</td><td align="center">平均值</td><td>BE 迁移请求。</td></tr><tr><td>be_fragment_endpoint_count</td><td align="center">个</td><td align="center">平均值</td><td>BE DataStream 数量。</td></tr><tr><td>be_fragment_request_latency_avg</td><td align="center">ms</td><td align="center">平均值</td><td>fragment 请求响应时间。</td></tr><tr><td>be_fragment_requests_per_second</td><td align="center">个/秒</td><td align="center">平均值</td><td>fragment 请求数。</td></tr><tr><td>be_http_request_latency_avg</td><td align="center">ms</td><td align="center">平均值</td><td>HTTP 请求响应时间。</td></tr><tr><td>be_http_requests_per_second</td><td align="center">个/秒</td><td align="center">平均值</td><td>HTTP 请求数。</td></tr><tr><td>be_http_request_send_bytes_per_second</td><td align="center">bytes/s</td><td align="center">平均值</td><td>HTTP 请求发送字节数。</td></tr><tr><td>fe_connections_per_second</td><td align="center">connections/s</td><td align="center">平均值</td><td>FE 的新增连接速率。</td></tr><tr><td>fe_connection_total</td><td align="center">connections</td><td align="center">累计值</td><td>FE 的总连接数量。</td></tr><tr><td>fe_edit_log_read</td><td align="center">operations/s</td><td align="center">平均值</td><td>FE edit log 读取速率。</td></tr><tr><td>fe_edit_log_size_bytes</td><td align="center">bytes/s</td><td align="center">平均值</td><td>FE edit log 大小。</td></tr><tr><td>fe_edit_log_write</td><td align="center">bytes/s</td><td align="center">平均值</td><td>FE edit log 写入速率。</td></tr><tr><td>fe_checkpoint_push_per_second</td><td align="center">operations/s</td><td align="center">平均值</td><td>FE checkpoint 数。</td></tr><tr><td>fe_pending_hadoop_load_job</td><td align="center">个</td><td align="center">平均值</td><td>Pending 的 hadoop job 数量。</td></tr><tr><td>fe_committed_hadoop_load_job</td><td align="center">个</td><td align="center">平均值</td><td>提交的 hadoop job 数量。</td></tr><tr><td>fe_loading_hadoop_load_job</td><td align="center">个</td><td align="center">平均值</td><td>加载中的 hadoop job 数量。</td></tr><tr><td>fe_finished_hadoop_load_job</td><td align="center">个</td><td align="center">平均值</td><td>完成的 hadoop job 数量。</td></tr><tr><td>fe_cancelled_hadoop_load_job</td><td align="center">个</td><td align="center">平均值</td><td>取消的 hadoop job 数量。</td></tr><tr><td>fe_pending_insert_load_job</td><td align="center">个</td><td align="center">平均值</td><td>Pending 的 insert job 数量。</td></tr><tr><td>fe_loading_insert_load_job</td><td align="center">个</td><td align="center">平均值</td><td>提交的 insert job 数量。</td></tr><tr><td>fe_committed_insert_load_job</td><td align="center">个</td><td align="center">平均值</td><td>加载中的 insert job 数量。</td></tr><tr><td>fe_finished_insert_load_job</td><td align="center">个</td><td align="center">平均值</td><td>完成的 insert job 数量。</td></tr><tr><td>fe_cancelled_insert_load_job</td><td align="center">个</td><td align="center">平均值</td><td>取消的 insert job 数量。</td></tr><tr><td>fe_pending_broker_load_job</td><td align="center">个</td><td align="center">平均值</td><td>Pending 的 broker job 数量。</td></tr><tr><td>fe_loading_broker_load_job</td><td align="center">个</td><td align="center">平均值</td><td>提交的 broker job 数量。</td></tr><tr><td>fe_committed_broker_load_job</td><td align="center">个</td><td align="center">平均值</td><td>加载中的 broker job 数量。</td></tr><tr><td>fe_finished_broker_load_job</td><td align="center">个</td><td align="center">平均值</td><td>完成的 broker job 数量。</td></tr><tr><td>fe_cancelled_broker_load_job</td><td align="center">个</td><td align="center">平均值</td><td>取消的 broker job 数量。</td></tr><tr><td>fe_pending_delete_load_job</td><td align="center">个</td><td align="center">平均值</td><td>Pending 的 delete job 数量。</td></tr><tr><td>fe_loading_delete_load_job</td><td align="center">个</td><td align="center">平均值</td><td>提交的 delete job 数量。</td></tr><tr><td>fe_committed_delete_load_job</td><td align="center">个</td><td align="center">平均值</td><td>加载中的 delete job 数量。</td></tr><tr><td>fe_finished_delete_load_job</td><td align="center">个</td><td align="center">平均值</td><td>完成的 delete job 数量。</td></tr><tr><td>fe_cancelled_delete_load_job</td><td align="center">个</td><td align="center">平均值</td><td>取消的 delete job 数量。</td></tr><tr><td>fe_rollup_running_alter_job</td><td align="center">个</td><td align="center">平均值</td><td>rollup 创建中的 job 数量。</td></tr><tr><td>fe_schema_change_running_job</td><td align="center">个</td><td align="center">平均值</td><td>表结构变更中的 job 数量。</td></tr><tr><td>cpu_util</td><td align="center">百分比</td><td align="center">平均值</td><td>CPU 使用率。</td></tr><tr><td>cpu_system</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_system 使用率。</td></tr><tr><td>cpu_user</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_user 使用率。</td></tr><tr><td>cpu_idle</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_idle 使用率。</td></tr><tr><td>cpu_guest</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_guest 使用率。</td></tr><tr><td>cpu_iowait</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_iowait 使用率。</td></tr><tr><td>cpu_irq</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_irq 使用率。</td></tr><tr><td>cpu_nice</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_nice 使用率。</td></tr><tr><td>cpu_softirq</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_softirq 使用率。</td></tr><tr><td>cpu_steal</td><td align="center">百分比</td><td align="center">平均值</td><td>cpu_steal 使用率。</td></tr><tr><td>disk_free</td><td align="center">bytes</td><td align="center">平均值</td><td>空闲磁盘容量。</td></tr><tr><td>disk_io_svctm</td><td align="center">Ms</td><td align="center">平均值</td><td>磁盘 IO 服务时间。</td></tr><tr><td>disk_io_util</td><td align="center">百分比</td><td align="center">平均值</td><td>磁盘使用率。</td></tr><tr><td>disk_used</td><td align="center">bytes</td><td align="center">平均值</td><td>已用磁盘容量。</td></tr><tr><td>starrocks_fe_query_resource_group</td><td align="center">个</td><td align="center">累计值</td><td>该资源组中查询任务的数量</td></tr><tr><td>starrocks_fe_query_resource_group_latency</td><td align="center">秒</td><td align="center">平均值</td><td>该资源组的查询延迟百分位数</td></tr><tr><td>starrocks_fe_query_resource_group_err</td><td align="center">个</td><td align="center">累计值</td><td>该资源组中报错的查询任务的数量</td></tr><tr><td>starrocks_fe_meta_log_count</td><td align="center">个</td><td align="center">瞬时值</td><td>未做 Checkpoint 的 Edit Log 数量，该值在 <code>100000</code> 以内为合理</td></tr><tr><td>starrocks_be_resource_group_cpu_limit_ratio</td><td align="center">百分比</td><td align="center">瞬时值</td><td>该资源组 CPU 配额比率的瞬时值</td></tr><tr><td>starrocks_be_resource_group_cpu_use_ratio</td><td align="center">百分比</td><td align="center">平均值</td><td>该资源组 CPU 使用时间占所有资源组 CPU 时间的比率</td></tr><tr><td>starrocks_be_resource_group_mem_limit_bytes</td><td align="center">Byte</td><td align="center">瞬时值</td><td>该资源组内存配额比率的瞬时值</td></tr><tr><td>starrocks_be_resource_group_mem_allocated_bytes</td><td align="center">Byte</td><td align="center">瞬时值</td><td>该资源组内存使用率瞬时值</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="最佳实践">最佳实践<a href="#最佳实践" class="hash-link" aria-label="最佳实践的直接链接" title="最佳实践的直接链接">​</a></h2>
<p>监控系统每间隔 15 秒收集一次信息。部分指标是是基于 15 秒间隔监控信息的平均值，单位为「个/秒」。其他指标则基于 15   秒的总值。</p>
<p>当前 P90、P99 等分位值监控信息均为基于 15 秒间隔。如果以更大粒度（1 分钟、5 分钟等）设置监控报警，系统只会以 “一共出现多少次” 或 “一共大于多少值” 作为指标，而非 “平均值为多少”。</p>
<p>当前最佳实践基于以下共识：</p>
<ul>
<li>监控应当在异常状态下报警，并避免在正常状态下报警。</li>
<li>不同集群的资源（比如内存、磁盘）使用量不同，需要分别设置不同的值。此类 Gauge 值以百分比作为度量更具普适性。</li>
<li>针对任务失败次数等监控信息，应当对照任务总量总量，根据一定比例（比如针对 P90，P99，P999的量）来计算报警边界值。</li>
<li>针对 used 或 query 类的监控信息，可以按照 2 倍或以上些来作为增长上限预警值；或者设置为较峰值稍高的值。</li>
</ul>
<blockquote>
<p>注意：</p>
<ul>
<li>通常您需要共同监控 FE 和 BE，但部分监控信息为 FE 或 BE 所特有。</li>
<li>当集群内的机器不是同构时，您需要分成多批监控。</li>
</ul>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="规则设置参考样例">规则设置参考样例<a href="#规则设置参考样例" class="hash-link" aria-label="规则设置参考样例的直接链接" title="规则设置参考样例的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="低频操作报警">低频操作报警<a href="#低频操作报警" class="hash-link" aria-label="低频操作报警的直接链接" title="低频操作报警的直接链接">​</a></h4>
<p>针对低频操作，您可以直接设置出现失败（次数大于等于 1 次）即报警。如果出现多次失败，则引发更高级报警。</p>
<p>例如，您可以为表结构修改等低频操作设置失败即报警。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="未启动任务">未启动任务<a href="#未启动任务" class="hash-link" aria-label="未启动任务的直接链接" title="未启动任务的直接链接">​</a></h4>
<p>通常，未启动任务的监控信息在一段时间都是 <code>0</code>。但一旦有此类信息，后续将引发大量 success 和 failed。</p>
<p>您可以暂时先设置失败大于 1 次即报警，后续可以根据具体情况再修改。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="波动大小">波动大小<a href="#波动大小" class="hash-link" aria-label="波动大小的直接链接" title="波动大小的直接链接">​</a></h4>
<p>针对波动较大的监控信息，您需要关注不同时间粒度的数据，因为粒度大的数据中的波峰波谷会被平均（未来我们将会为 StarRocksManager 增加 sum/min/max/average 等指标聚合值）。通常，您需要查看基于不同时间范围的的数据，例如 15 天、3 天、12 小时、3 小时、1 小时等。同时，您需要设置较长的监控间隔时间（例如 3 分钟或5 分钟等），以屏蔽波动引起的报警。</p>
<p>针对波动较小的监控信息，您可以设置更短的间隔时间，令系统可以更快地发出报警。</p>
<p>如果监控信息具有较高尖刺，您需要判断尖刺情况是否需要报警。如果尖刺较多，您可以适当放大间隔时间，以平滑尖刺；如果尖刺较少，您可以为其设置通知级别的报警。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="资源使用">资源使用<a href="#资源使用" class="hash-link" aria-label="资源使用的直接链接" title="资源使用的直接链接">​</a></h4>
<p>针对低资源使用类的监控信息，您可以设置相对严格的阈值，例如，在 CPU 使用率较低的情况下（不足 20%），可以设置为 <code>cpu_idle&lt;60%</code> 时报警。</p>
<p>针对高资源使用类的监控信息，您可以按照“预留一定资源”的方式设置报警，例如，为内存设置 <code>mem_avaliable&lt;=20%</code> 时报警。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=" 其他信息">其他信息<a href="#其他信息" class="hash-link" aria-label="其他信息的直接链接" title="其他信息的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="p99-分位计算规则">P99 分位计算规则<a href="#p99-分位计算规则" class="hash-link" aria-label="P99 分位计算规则的直接链接" title="P99 分位计算规则的直接链接">​</a></h4>
<p>各节点会以每 15 秒的间隔采集数据，并计算相应数值，当前 99 分位即该 15 秒内的 99 分位。当 QPS 较低时（例如 10 以下），此分位并不具有高准确率。同时，针对 1 分钟（4 个 15 秒间隔）内的 4 个值简单的求聚合（无论是 sum 或是 average）也不具有数学意义。</p>
<p>以上规则同样适用于 P50、P90 计算。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="集群错误性监控">集群错误性监控<a href="#集群错误性监控" class="hash-link" aria-label="集群错误性监控的直接链接" title="集群错误性监控的直接链接">​</a></h4>
<p>您需要监控集群中一些非期望的错误项，以及时发现问题，并更快速地解决问题，使集群恢复正常状态。如果一些监控项不具有重要意义，但<strong>暂时无法从重要错误项中剥离</strong>（比如 SQL 语法错误等），建议您暂时保持监控，并在后期推动区分。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/StarRocks/docs.zh-cn/edit/main/administration/Monitor_and_Alert.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc/zh/docs/3.0/administration/Configuration"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">配置参数</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/doc/zh/docs/3.0/administration/audit_loader"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">通过 Audit Loader 管理 StarRocks 中的审计日志</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#使用-starrocksmanager" class="table-of-contents__link toc-highlight">使用 StarRocksManager</a></li><li><a href="#使用-prometheusgrafana" class="table-of-contents__link toc-highlight">使用 Prometheus+Grafana</a><ul><li><a href="#监控架构" class="table-of-contents__link toc-highlight">监控架构</a></li><li><a href="#部署-prometheus" class="table-of-contents__link toc-highlight">部署 Prometheus</a></li><li><a href="#部署-grafana" class="table-of-contents__link toc-highlight">部署 Grafana</a></li></ul></li><li><a href="#监控指标" class="table-of-contents__link toc-highlight">监控指标</a></li><li><a href="#最佳实践" class="table-of-contents__link toc-highlight">最佳实践</a><ul><li><a href="#规则设置参考样例" class="table-of-contents__link toc-highlight">规则设置参考样例</a></li><li><a href="#其他信息" class="table-of-contents__link toc-highlight">其他信息</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc/zh/docs/introduction/StarRocks_intro">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 StarRocks, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>