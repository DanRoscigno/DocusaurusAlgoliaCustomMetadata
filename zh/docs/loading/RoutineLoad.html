<!doctype html>
<html lang="zh-CN" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-3.1 docs-doc-page docs-doc-id-loading/RoutineLoad" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0-beta.0">
<title data-rh="true">从 Apache Kafka® 持续导入 | StarRocks</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.starrocks.io/zh/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.starrocks.io/zh/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.starrocks.io/zh/docs/loading/RoutineLoad"><meta data-rh="true" property="og:locale" content="zh_CN"><meta data-rh="true" property="og:locale:alternate" content="en_US"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="3.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-3.1"><meta data-rh="true" name="docsearch:version" content="3.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-3.1"><meta data-rh="true" property="og:title" content="从 Apache Kafka® 持续导入 | StarRocks"><meta data-rh="true" name="description" content="本文介绍 Routine Load 的基本原理、以及如何通过 Routine Load 持续消费 Apache Kafka® 的消息并导入至 StarRocks 中。"><meta data-rh="true" property="og:description" content="本文介绍 Routine Load 的基本原理、以及如何通过 Routine Load 持续消费 Apache Kafka® 的消息并导入至 StarRocks 中。"><link data-rh="true" rel="icon" href="/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.starrocks.io/zh/docs/loading/RoutineLoad"><link data-rh="true" rel="alternate" href="https://www.starrocks.io/docs/loading/RoutineLoad" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://www.starrocks.io/zh/docs/loading/RoutineLoad" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://www.starrocks.io/docs/loading/RoutineLoad" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ER08SJMRY1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="StarRocks" href="/zh/opensearch.xml"><link rel="stylesheet" href="/zh/assets/css/styles.62f01ed5.css">
<script src="/zh/assets/js/runtime~main.59b29ed0.js" defer="defer"></script>
<script src="/zh/assets/js/main.e9dfa7c5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://www.starrocks.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/zh/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh/img/logo.svg" alt="StarRocks Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">StarRocks</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/docs/introduction/StarRocks_intro">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/docs/introduction/StarRocks_intro">3.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/next/examples/introduction">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/docs/loading/RoutineLoad">3.1</a></li><li><a class="dropdown__link" href="/zh/docs/3.0/loading/RoutineLoad">3.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/docs/loading/RoutineLoad" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">English</a></li><li><a href="/zh/docs/loading/RoutineLoad" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">中文</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/StarRocks/starrocks" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh/docs/introduction/StarRocks_intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/introduction-to-starrocks">Introduction to StarRocks</a><button aria-label="Expand sidebar category &#x27;Introduction to StarRocks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/release-notes">Release Notes</a><button aria-label="Expand sidebar category &#x27;Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/quick-start">Quick Start</a><button aria-label="Expand sidebar category &#x27;Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/deployment/deployment_overview">Deployment</a><button aria-label="Expand sidebar category &#x27;Deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/table_design/StarRocks_table_design">Table Design</a><button aria-label="Expand sidebar category &#x27;Table Design&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/zh/docs/loading/Loading_intro">Data Loading</a><button aria-label="Collapse sidebar category &#x27;Data Loading&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/category/concepts">Concepts</a><button aria-label="Expand sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/StreamLoad">通过 HTTP PUT 从本地文件系统或流式数据源导入数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/hdfs_load">从 HDFS 导入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/cloud_storage_load">从云存储导入</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/zh/docs/category/load-data-from-apache-kafka">Load data from Apache Kafka</a><button aria-label="Collapse sidebar category &#x27;Load data from Apache Kafka&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/Kafka-connector-starrocks">使用 Kafka connector 导入数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/loading/RoutineLoad">从 Apache Kafka® 持续导入</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/zh/docs/category/load-data-from-apache-spark">Load data from Apache Spark</a><button aria-label="Expand sidebar category &#x27;Load data from Apache Spark&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/InsertInto">通过 INSERT 语句导入数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/Stream_Load_transaction_interface">使用 Stream Load 事务接口导入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/Flink_cdc_load">从 MySQL 实时同步</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/Flink-connector-starrocks">从 Apache Flink® 持续导入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/Load_to_Primary_Key_tables">通过导入实现数据变更</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/loading/Etl_in_loading">导入过程中实现数据转换</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/data-unloading">Data Unloading</a><button aria-label="Expand sidebar category &#x27;Data Unloading&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/query-data-lakes">Query Data Lakes</a><button aria-label="Expand sidebar category &#x27;Query Data Lakes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/query-acceleration">Query Acceleration</a><button aria-label="Expand sidebar category &#x27;Query Acceleration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/integrations">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/administration">Administration</a><button aria-label="Expand sidebar category &#x27;Administration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/reference">Reference</a><button aria-label="Expand sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/faq">FAQ</a><button aria-label="Expand sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/benchmarks">Benchmarks</a><button aria-label="Expand sidebar category &#x27;Benchmarks&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/developers">Developers</a><button aria-label="Expand sidebar category &#x27;Developers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/category/ecosystem-release-notes">Ecosystem Release Notes</a><button aria-label="Expand sidebar category &#x27;Ecosystem Release Notes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/docs/loading/Loading_intro"><span itemprop="name">Data Loading</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/zh/docs/category/load-data-from-apache-kafka"><span itemprop="name">Load data from Apache Kafka</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">从 Apache Kafka® 持续导入</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：3.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>从 Apache Kafka® 持续导入</h1>
<p>本文介绍 Routine Load 的基本原理、以及如何通过 Routine Load 持续消费 Apache Kafka® 的消息并导入至 StarRocks 中。</p>
<p>如果您需要将消息流不间断地导入至 StarRocks，则可以将消息流存储在 Kafka 的 Topic 中，并向 StarRocks 提交一个 Routine Load 导入作业。 StarRocks 会常驻地运行这个导入作业，持续生成一系列导入任务，消费 Kafka 集群中该 Topic 中的全部或部分分区的消息并导入到 StarRocks 中。</p>
<p>Routine Load 支持 Exactly-Once 语义，能够保证数据不丢不重。</p>
<p>Routine Load 支持在导入过程中做数据转换、以及通过 UPSERT 和 DELETE 操作实现数据变更。请参见<a href="/zh/docs/loading/Etl_in_loading">导入过程中实现数据转换</a>和<a href="/zh/docs/loading/Load_to_Primary_Key_tables">通过导入实现数据变更</a>。</p>
<blockquote>
<p><strong>注意</strong></p>
<p>Routine Load 操作需要目标表的 INSERT 权限。如果您的用户账号没有 INSERT 权限，请参考 <a href="/zh/docs/sql-reference/sql-statements/account-management/GRANT">GRANT</a> 给用户赋权。</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="支持的数据文件格式">支持的数据文件格式<a href="#支持的数据文件格式" class="hash-link" aria-label="支持的数据文件格式的直接链接" title="支持的数据文件格式的直接链接">​</a></h2>
<p>Routine Load 目前支持从 Kakfa 集群中消费 CSV、JSON、Avro (自 v3.0.1) 格式的数据。</p>
<blockquote>
<p><strong>说明</strong></p>
<p>对于 CSV 格式的数据，需要注意以下两点：</p>
<ul>
<li>StarRocks 支持设置长度最大不超过 50 个字节的 UTF-8 编码字符串作为列分隔符，包括常见的逗号 (,)、Tab 和 Pipe (|)。</li>
<li>空值 (null) 用 <code>\N</code> 表示。比如，数据文件一共有三列，其中某行数据的第一列、第三列数据分别为 <code>a</code> 和 <code>b</code>，第二列没有数据，则第二列需要用 <code>\N</code> 来表示空值，写作 <code>a,\N,b</code>，而不是 <code>a,,b</code>。<code>a,,b</code> 表示第二列是一个空字符串。</li>
</ul>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本原理">基本原理<a href="#基本原理" class="hash-link" aria-label="基本原理的直接链接" title="基本原理的直接链接">​</a></h2>
<p><img loading="lazy" alt="routine load" src="/zh/assets/images/4.5.2-1-f146fc07da59c8d82569e5f4257aa297.png" width="1319" height="1286" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="概念">概念<a href="#概念" class="hash-link" aria-label="概念的直接链接" title="概念的直接链接">​</a></h3>
<ul>
<li>
<p><strong>导入作业（Load job）</strong></p>
<p>导入作业会常驻运行，当导入作业的状态为 <strong>RUNNING</strong> 时，会持续不断生成一个或多个并行的导入任务，不断消费 Kafka 集群中一个 Topic 的消息，并导入至 StarRocks 中。</p>
</li>
<li>
<p><strong>导入任务（Load task）</strong></p>
<p>导入作业会按照一定规则拆分成若干个导入任务。导入任务是执行导入的基本单位，作为一个独立的事务，通过 <a href="/zh/docs/loading/StreamLoad">Stream Load</a> 导入机制实现。若干个导入任务并行消费一个 Topic 中不同分区的消息，并导入至 StarRocks 中。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="作业流程">作业流程<a href="#作业流程" class="hash-link" aria-label="作业流程的直接链接" title="作业流程的直接链接">​</a></h3>
<ol>
<li>
<p><strong>创建常驻的导入作业</strong></p>
<p>您需要向 StarRocks 提交创建导入作业的 SQL 语句。 FE 会解析 SQL 语句，并创建一个常驻的导入作业。</p>
</li>
<li>
<p><strong>拆分导入作业为多个导入任务</strong></p>
<p>FE 将导入作业按照一定规则拆分成若干个导入任务。一个导入任务作为一个独立的事务。</p>
<p>拆分规则如下：</p>
<ul>
<li>FE 根据期望任务并行度<code>desired_concurrent_number</code>、Kafka Topic 的分区数  量、存活 BE 数量等，计算得出实际任务并行度。</li>
<li>FE 根据实际任务并行度将导入作业分为若干导入任务，放入任务执行队列中。</li>
</ul>
<p>每个 Topic 会有多个分区，分区与导入任务之间的对应关系为：</p>
<ul>
<li>每个分区的消息只能由一个对应的导入任务消费。</li>
<li>一个导入任务可能会消费一个或多个分区。</li>
<li>分区会尽可能均匀地分配给导入任务。</li>
</ul>
</li>
<li>
<p><strong>多个导入任务并行进行，消费 Kafka 多个分区的消息，导入至 StarRocks</strong></p>
<ol>
<li>
<p><strong>调度和提交导入任务</strong>：FE 定时调度任务执行队列中的导入任务，分配给选定的 Coordinator BE。调度导入任务的时间间隔由 <code>max_batch_interval</code> 参数，并且 FE 会尽可能均匀地向所有 BE 分配导入任务。有关 <code>max_batch_interval</code> 参数的详细介绍，请参见  <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/CREATE ROUTINE LOAD#job_properties">CREATE ROUTINE LOAD</a>。</p>
</li>
<li>
<p><strong>执行导入任务</strong>：Coordinator BE 执行导入任务，消费分区的消息，解析并过滤数据。导入任务需要消费足够多的消息，或者消费足够长时间。消费时间和消费的数据量由 FE 配置项 <code>max_routine_load_batch_size</code>、<code>routine_load_task_consume_second</code>决定，有关该配置项的更多说明，请参见 <a href="/zh/docs/administration/Configuration#%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA">配置参数</a>。然后，Coordinator BE 将消息分发至相关 Executor BE 节点， Executor BE 节点将消息写入磁盘。</p>
</li>
</ol>
<blockquote>
<p><strong>说明</strong></p>
<p>StarRocks 可以通过安全认证机制，包括 SASL_SSL 认证、SASL 认证和 SSL 认证，以及无认证的方式连接 Kafka。本文以无认证的方式连接 Kafka 为例进行说明，如果您需要通过安全认证机制  连接 Kafka，请参见<a href="/zh/docs/sql-reference/sql-statements/data-manipulation/CREATE ROUTINE LOAD">CREATE ROUTINE LOAD</a>。</p>
</blockquote>
</li>
<li>
<p><strong>持续生成新的导入任务，不间断地导入数据</strong></p>
<p>Executor BE 节点成功写入数据后， Coordonator BE 会向 FE 汇报导入结果。</p>
<p>FE 根据汇报结果，继续生成新的导入任务，或者对失败的导入任务进行重试，连续地导入数据，并且能够保证导入数据不丢不重。</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="准备工作">准备工作<a href="#准备工作" class="hash-link" aria-label="准备工作的直接链接" title="准备工作的直接链接">​</a></h2>
<p>下载并安装 Kafka。创建 Topic 并且上传数据。操作步骤，请参见<a href="https://kafka.apache.org/quickstart" target="_blank" rel="noopener noreferrer">Apache Kafka quickstart</a>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="创建导入作业">创建导入作业<a href="#创建导入作业" class="hash-link" aria-label="创建导入作业的直接链接" title="创建导入作业的直接链接">​</a></h2>
<p>这里通过三个简单的示例，介绍如何通过 Routine Load 持续消费 Kafka 中 CSV、JSON 和 Avro 格式的数据，并导入至 StarRocks 中。有关创建 Routine Load 的详细语法和参数说明，请参见 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/CREATE ROUTINE LOAD">CREATE ROUTINE LOAD</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="导入-csv-数据">导入 CSV 数据<a href="#导入-csv-数据" class="hash-link" aria-label="导入 CSV 数据的直接链接" title="导入 CSV 数据的直接链接">​</a></h3>
<p>本小节介绍如何创建一个 Routine Load 导入作业，持续不断地消费 Kafka 集群的 CSV 格式的数据，然后导入至 StarRocks 中。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据集">数据集<a href="#数据集" class="hash-link" aria-label="数据集的直接链接" title="数据集的直接链接">​</a></h4>
<p>假设 Kafka 集群的 Topic <code>ordertest1</code> 存在如下 CSV 格式的数据，其中 CSV 数据中列的含义依次是订单编号、支付日期、顾客姓名、国籍、性别、支付金额。</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2020050802,2020-05-08,Johann Georg Faust,Deutschland,male,895</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020050802,2020-05-08,Julien Sorel,France,male,893</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020050803,2020-05-08,Dorian Grey,UK,male,1262</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020050901,2020-05-09,Anna Karenina&quot;,Russia,female,175</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020051001,2020-05-10,Tess Durbeyfield,US,female,986</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2020051101,2020-05-11,Edogawa Conan,japan,male,8924</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="目标数据库和表">目标数据库和表<a href="#目标数据库和表" class="hash-link" aria-label="目标数据库和表的直接链接" title="目标数据库和表的直接链接">​</a></h4>
<p>根据 CSV 数据中需要导入的几列（例如除第五列性别外的其余五列需要导入至 StarRocks）， 在 StarRocks 集群的目标数据库 <code>example_db</code> 中创建表 <code>example_tbl1</code>。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> example_db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">example_tbl1 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">order_id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bigint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;订单编号&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">pay_dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;支付日期&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">customer_name</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;顾客姓名&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">nationality</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;国籍&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">price</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;支付金额&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ENGINE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">OLAP </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DUPLICATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">order_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">pay_dt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">order_id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>自 2.5.7 版本起，StarRocks 支持在建表和新增分区时自动设置分桶数量 (BUCKETS)  ，您无需手动设置分桶数量。更多信息，请参见 <a href="/zh/docs/table_design/Data_distribution#%E7%A1%AE%E5%AE%9A%E5%88%86%E6%A1%B6%E6%95%B0%E9%87%8F">确定分桶数量</a>。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="导入作业">导入作业<a href="#导入作业" class="hash-link" aria-label="导入作业的直接链接" title="导入作业的直接链接">​</a></h4>
<p>通过如下语句，向StarRocks 提交一个 Routine Load 导入作业 <code>example_tbl1_ordertest1</code>，持续消费 Kafka 集群中 Topic <code>ordertest1</code> 的消息，并导入至数据库 <code>example_db</code> 的表 <code>example_tbl1</code> 中。并且导入作业会从该 Topic 所指定分区的最早位点 (Offset) 开始消费。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> example_db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">example_tbl1_ordertest1 </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> example_tbl1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">COLUMNS</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TERMINATED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">COLUMNS</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">order_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pay_dt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> customer_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nationality</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> temp_gender</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> price</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;desired_concurrent_number&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> KAFKA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_broker_list&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;kafka_broker1_ip&gt;:&lt;kafka_broker1_port&gt;,&lt;kafka_broker2_ip&gt;:&lt;kafka_broker2_port&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_topic&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ordertest1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_partitions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;property.kafka_default_offsets&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>提交导入作业后，您可以执行  <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a>，查看导入作业执行情况。</p>
<ul>
<li>
<p><strong>导入作业的名称</strong></p>
<p>一张表可能有多个导入作业，建议您根据 Kafka Topic 的名称和创建导入作业的大致时间等信息来给导入作业命名，这样有助于区分同一张表上的不同导入作业。</p>
</li>
<li>
<p><strong>列分隔符</strong></p>
<p><code>COLUMN TERMINATED BY</code> 指定 CSV 数据的列分隔符，默认为<code>\t</code>。</p>
</li>
<li>
<p><strong>消费分区和起始消费位点</strong></p>
<p>如果需要指定分区、起始消费位点，则可以配置参数 <code>kafka_partitions</code>、<code>kafka_offsets</code>。例如待消费分区为<code>&quot;0,1,2,3,4&quot;</code>，并且为每个分区单独指定起始消费位点，则可以指定如下配置：</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;kafka_partitions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;kafka_offsets&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING, OFFSET_END, 1000, 2000, 3000&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>您也可以使用 <code>property.kafka_default_offsets</code> 来设置全部分区的默认消费位点。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;kafka_partitions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;property.kafka_default_offsets&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>更多参数说明，请参见 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/CREATE ROUTINE LOAD#data_sourcedata_source_properties">CREATE ROUTINE LOAD</a>。</p>
</li>
<li>
<p><strong>数据转换</strong></p>
<p>如果需要指定源数据和目标表之间列的映射和转换关系，则需要配置 <code>COLUMNS</code> 。<code>COLUMNS</code>中列的<strong>顺序</strong>与 <strong>CSV 数据</strong>中列的顺序一致，并且<strong>名称</strong>与<strong>目标表</strong>中的列名对应。本示例中，由于无需导入 CSV 数据的第五列至目标表，因此<code>COLUMNS</code>中把第五列临时命名为 <code>temp_gender</code> 用于占位，其他列都直接映射至表<code>example_tbl1</code>中。</p>
<p>更多数据转换的说明，请参见<a href="/zh/docs/loading/Etl_in_loading">导入时实现数据转换</a>。</p>
<blockquote>
<p><strong>说明</strong></p>
<p>如果 CSV 数据中列的名称、顺序和数量都能与目标表中列完全对应，则无需配置 <code>COLUMNS</code> 。</p>
</blockquote>
</li>
<li>
<p><strong>增加实际任务并行度 加快导入速度</strong></p>
<p>当分区数量较多，并且 BE 节点数量充足时，如果您期望加快导入速度，则可以增加实际任务并行度，将一个导入作业分成尽可能多的导入任务并行执行。</p>
<p>实际任务并行度由如下多个参数组成的公式决定。如果需要增加实际任务并行度，您可以在创建Routine Load 导入作业时为单个导入作业设置较高的期望任务并行度 <code>desired_concurrent_number</code> ，以及设置较高的  Routine Load 导入作业的默认最大任务并行度的<code>max_routine_load_task_concurrent_num</code> ，该参数为 FE 动态参数，详细说明，请参见 <a href="/zh/docs/administration/Configuration#%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA">配置参数</a>。此时实际任务并行度上限为存活 BE 节点数量或者指定分区数量。</p>
<p>本示例中存活 BE 数量为 5， 指定分区数量为 5，<code>max_routine_load_task_concurrent_num</code> 为默认值 <code>5</code>，如果需要增加实际任务并发度至上限，则需要将 <code>desired_concurrent_number</code> 为 <code>5</code>（默认值为 3），计算出实际任务并行度为 5。</p>
<div class="language-Plain language-plain codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plain codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  min(aliveBeNum, partitionNum, desired_concurrent_number, max_routine_load_task_concurrent_num)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>更多调整导入速度的说明，请参见 <a href="/zh/docs/faq/loading/Routine_load_faq">Routine Load 常见问题</a>。</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="导入-json-数据">导入 JSON 数据<a href="#导入-json-数据" class="hash-link" aria-label="导入 JSON 数据的直接链接" title="导入 JSON 数据的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据集-1">数据集<a href="#数据集-1" class="hash-link" aria-label="数据集的直接链接" title="数据集的直接链接">​</a></h4>
<p>假设 Kafka 集群的 Topic <code>ordertest2</code> 中存在如下 JSON 格式的数据。其中一个JSON 对象中 key 的含义依次是 品类 ID、顾客姓名、顾客国籍、支付日期、支付金额。</p>
<p>并且，您希望在导入时进行数据转换，将 JSON 数据中的 <code>pay_time</code> 键转换为 DATE 类型，并导入到目标表的列<code>pay_dt</code>中。</p>
<div class="language-JSON language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;commodity_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;customer_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Mark Twain&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;US&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;pay_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1589191487</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">875</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;commodity_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;customer_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Oscar Wilde&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;UK&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;pay_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1589191487</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">895</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;commodity_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;customer_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Antoine de Saint-Exupéry&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;country&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;France&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;pay_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1589191487</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;price&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">895</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>这里每行一个 JSON 对象必须在一个 Kafka 消息中，否则会出现“JSON 解析错误”的问题。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="目标数据库和表-1">目标数据库和表<a href="#目标数据库和表-1" class="hash-link" aria-label="目标数据库和表的直接链接" title="目标数据库和表的直接链接">​</a></h4>
<p>根据 JSON 数据中需要导入的 key，在StarRocks 集群的目标数据库 <code>example_db</code> 中创建表 <code>example_tbl2</code> 。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">example_tbl2</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">commodity_id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;品类ID&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">customer_name</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;顾客姓名&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">country</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;顾客国籍&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">pay_time</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bigint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;支付时间&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">pay_dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">date</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;支付日期&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">price</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> SUM </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;支付金额&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ENGINE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">OLAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AGGREGATE </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">commodity_id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">customer_name</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">country</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">pay_time</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">pay_dt</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">commodity_id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>自 2.5.7 版本起，StarRocks 支持在建表和新增分区时自动设置分桶数量 (BUCKETS)，您无需手动设置分桶数量。更多信息，请参见 <a href="/zh/docs/table_design/Data_distribution#%E7%A1%AE%E5%AE%9A%E5%88%86%E6%A1%B6%E6%95%B0%E9%87%8F">确定分桶数量</a>。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="导入作业-1">导入作业<a href="#导入作业-1" class="hash-link" aria-label="导入作业的直接链接" title="导入作业的直接链接">​</a></h4>
<p>通过如下语句，向 StarRocks  提交一个 Routine Load 导入作业 <code>example_tbl2_ordertest2</code>，持续消费 Kafka 集群中 Topic <code>ordertest2</code> 的消息，并导入至 <code>example_tbl2</code> 表中。并且导入作业会从此 Topic 所指定分区的最早位点开始消费。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> example_db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">example_tbl2_ordertest2 </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> example_tbl2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">COLUMNS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">commodity_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> customer_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> country</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pay_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> price</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pay_dt</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">from_unixtime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pay_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%Y%m%d&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;desired_concurrent_number&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;format&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;jsonpaths&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[\&quot;$.commodity_id\&quot;,\&quot;$.customer_name\&quot;,\&quot;$.country\&quot;,\&quot;$.pay_time\&quot;,\&quot;$.price\&quot;]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> KAFKA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_broker_list&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;kafka_broker1_ip&gt;:&lt;kafka_broker1_port&gt;,&lt;kafka_broker2_ip&gt;:&lt;kafka_broker2_port&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_topic&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ordertest2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_partitions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;property.kafka_default_offsets&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>提交导入作业后，您可以执行  <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a>，查看导入作业执行情况。</p>
<ul>
<li>
<p><strong>数据格式</strong></p>
<p>需要<code>PROPERTIES</code>子句的<code>&quot;format&quot; = &quot;json&quot;</code>中指定数据格式为 JSON。</p>
</li>
<li>
<p><strong>数据提取和转换</strong></p>
<p>如果需要指定源数据和目标表之间列的映射和转换关系，则可以配置 <code>COLUMNS</code> 和 <code>jsonpaths</code> 参数。<code>COLUMNS</code> 中的列名对应<strong>目标表</strong>的列名，列的顺序对应<strong>源数据</strong>中的列顺序。<code>jsonpaths</code> 参数用于提取 JSON 数据中需要的字段数据，就像新生成的 CSV 数据一样。然后 <code>COLUMNS</code> 参数对 <code>jsonpaths</code> 中的字段<strong>按顺序</strong>进行临时命名。</p>
<p>由于源数据中<code>pay_time</code> 键需要转换为 DATE 类型，导入到目标表的列<code>pay_dt</code>，因此<code>COLUMNS</code>中需要使用函数<code>from_unixtime</code>进行转换。其他字段都能直接映射至表<code>example_tbl2</code>中。</p>
<p>更多数据转换的说明，请参见<a href="/zh/docs/loading/Etl_in_loading">导入时实现数据转换</a>。</p>
<blockquote>
<p><strong>说明</strong></p>
<p>如果每行一个 JSON 对象中 key 的名称和数量（顺序不需要对应）都能对应目标表中列，则无需配置 <code>COLUMNS</code> 。</p>
</blockquote>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="导入-avro-数据">导入 Avro 数据<a href="#导入-avro-数据" class="hash-link" aria-label="导入 Avro 数据的直接链接" title="导入 Avro 数据的直接链接">​</a></h3>
<p>自 3.0.1 版本开始，StarRocks 支持使用 Routine Load 导入 Avro 数据。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据集-2">数据集<a href="#数据集-2" class="hash-link" aria-label="数据集的直接链接" title="数据集的直接链接">​</a></h4>
<p><strong>Avro schema</strong></p>
<ol>
<li>
<p>创建如下 Avro schema 文件 <code>avro_schema.avsc</code>：</p>
<div class="language-JSON language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;record&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor_log&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;fields&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;id&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;long&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;checked&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;boolean&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;double&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor_type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;enum&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor_type_enum&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;symbols&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;TEMPERATURE&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;HUMIDITY&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AIR-PRESSURE&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>注册该 Avro schema 至 <a href="https://docs.confluent.io/cloud/current/get-started/schema-registry.html#create-a-schema" target="_blank" rel="noopener noreferrer">Schema Registry</a>。</p>
</li>
</ol>
<p><strong>Avro 数据</strong></p>
<p>构建 Avro 数据并且发送至 Kafka 集群的 topic <code>topic_0</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="目标数据库和表-2">目标数据库和表<a href="#目标数据库和表-2" class="hash-link" aria-label="目标数据库和表的直接链接" title="目标数据库和表的直接链接">​</a></h4>
<p>根据 Avro 数据中需要导入的字段，在 StarRocks 集群的目标数据库 <code>sensor</code> 中创建表 <code>sensor_log</code>。表的列名与 Avro 数据的字段名保持一致。两者的数据类型映射关系，请参见<a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%98%A0%E5%B0%84">数据类型映射</a>。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain">  example_db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sensor_log </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bigint</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor id&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">name</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">checked</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;checked&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">data</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">sensor_type</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">varchar</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;sensor type&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ENGINE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">OLAP </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DUPLICATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">HASH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>自 2.5.7 版本起，StarRocks 支持在建表和新增分区时自动设置分桶数量 (BUCKETS)，您无需手动设置分桶数量。更多信息，请参见 <a href="/zh/docs/table_design/Data_distribution#%E7%A1%AE%E5%AE%9A%E5%88%86%E6%A1%B6%E6%95%B0%E9%87%8F">确定分桶数量</a>。</p>
</blockquote>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="导入作业-2">导入作业<a href="#导入作业-2" class="hash-link" aria-label="导入作业的直接链接" title="导入作业的直接链接">​</a></h4>
<p>提交一个导入作业 <code>sensor_log_load_job</code>，持续消费 Kafka 集群中 Topic <code>topic_0</code> 的 Avro 消息，并将其导入到数据库 <code>sensor</code> 中的表 <code>sensor_log</code>。并且导入作业会从此 Topic 所指定分区的最早位点开始消费。</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> example_db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sensor_log_load_job </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> sensor_log </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;format&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;avro&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> KAFKA  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_broker_list&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;kafka_broker1_ip&gt;:&lt;kafka_broker1_port&gt;,&lt;kafka_broker2_ip&gt;:&lt;kafka_broker2_port&gt;,...&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;confluent.schema.registry.url&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://172.xx.xxx.xxx:8081&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_topic&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;topic_0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_partitions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4,5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;property.kafka_default_offsets&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>数据格式</p>
<p>在 <code>PROPERTIES</code> 子句中，通过配置 <code>&quot;format&quot; = &quot;avro&quot;</code> 指定数据格式为 Avro。</p>
</li>
<li>
<p>Schema Registry</p>
<p>通过 confluent.schema.registry.url 参数指定注册该 Avro schema 的 <a href="https://docs.confluent.io/platform/current/schema-registry/index.html" target="_blank" rel="noopener noreferrer">Schema Registry</a> 的 URL，StarRocks 会从该 URL 获取 Avro schema。格式如下：</p>
<div class="language-Plaintext language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">confluent.schema.registry.url = http[s]://[&lt;schema-registry-api-key&gt;:&lt;schema-registry-api-secret&gt;@]&lt;hostname|ip address&gt;[:&lt;port&gt;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>数据映射和转换</p>
<p>如果需要指定源数据和目标表之间列的映射和转换关系，则可以配置 <code>COLUMNS</code> 和 <code>jsonpaths</code> 参数。<code>COLUMNS</code> 中的列名对应目标表的列名，列的顺序对应 <code>jsonpaths</code> 中的字段顺序。<code>jsonpaths</code> 参数用于提取 Avro 数据中需要的字段数据，而后（就像新生成的 CSV 数据一样）被 <code>COLUMNS</code> 参数按顺序临时命名。</p>
<p>更多数据转换的说明，请参见<a href="/zh/docs/loading/Etl_in_loading">导入时实现数据转换</a>。</p>
<blockquote>
<p>说明</p>
<p>如果一条 Avro record 中字段的名称和数量（顺序不需要对应）都能对应目标表中列，则无需配置 <code>COLUMNS</code> 。</p>
</blockquote>
</li>
</ul>
<p>提交导入作业后，您可以执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a>，查看导入作业执行情况。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="数据类型映射">数据类型映射<a href="#数据类型映射" class="hash-link" aria-label="数据类型映射的直接链接" title="数据类型映射的直接链接">​</a></h4>
<p>StarRocks 支持导入所有类型的 Avro 数据。导入 Avro 数据至 StarRocks 时，其类型映射关系如下：</p>
<p><strong>原始类型</strong></p>
<table><thead><tr><th>Avro</th><th>StarRocks</th></tr></thead><tbody><tr><td>null</td><td>NULL</td></tr><tr><td>boolean</td><td>BOOLEAN</td></tr><tr><td>int</td><td>INT</td></tr><tr><td>long</td><td>BIGINT</td></tr><tr><td>float</td><td>FLOAT</td></tr><tr><td>double</td><td>DOUBLE</td></tr><tr><td>bytes</td><td>STRING</td></tr><tr><td>string</td><td>STRING</td></tr></tbody></table>
<p><strong>复杂类型</strong></p>
<table><thead><tr><th>Avro</th><th>StarRocks</th></tr></thead><tbody><tr><td>record</td><td>将 RECORD 类型的字段或者其子字段中作为 JSON 导入</td></tr><tr><td>enums</td><td>STRING</td></tr><tr><td>arrays</td><td>ARRAY</td></tr><tr><td>maps</td><td>JSON</td></tr><tr><td>union(T, null)</td><td>NULLABE(T)</td></tr><tr><td>fixed</td><td>STRING</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="使用限制">使用限制<a href="#使用限制" class="hash-link" aria-label="使用限制的直接链接" title="使用限制的直接链接">​</a></h4>
<ul>
<li>
<p>StarRocks 暂时不支持 schema evolution，每次仅从 schema registry 服务获取最新版本的 schema 信息。</p>
</li>
<li>
<p>每条 Kafka 消息中应仅包含单条 Avro 数据。</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="查看导入作业和任务">查看导入作业和任务<a href="#查看导入作业和任务" class="hash-link" aria-label="查看导入作业和任务的直接链接" title="查看导入作业和任务的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看导入作业">查看导入作业<a href="#查看导入作业" class="hash-link" aria-label="查看导入作业的直接链接" title="查看导入作业的直接链接">​</a></h3>
<p>执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a>，查看名称为  <code>example_tbl2_ordertest2</code> 的导入作业的信息，比如导入作业状态<code>State</code>，导入作业的统计信息<code>Statistic</code>（消费的总数据行数、已导入的行数等），消费的分区及进度<code>Progress</code>等。</p>
<p>如果导入作业状态自动变为 <strong>PAUSED</strong>，则可能为导入任务错误行数超过阈值。错误行数阈值的设置方式，请参考 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/CREATE ROUTINE LOAD#job_properties">CREATE ROUTINE LOAD</a>。您可以参考<code>ReasonOfStateChanged</code>、<code>ErrorLogUrls</code>报错进行排查和修复。修复后您可以使用 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/RESUME ROUTINE LOAD">RESUME ROUTINE LOAD</a>，恢复 <strong>PAUSED</strong> 状态的导入作业。</p>
<p>如果导入作业状态为 <strong>CANCELLED</strong>，则可能为导入任务执行遇到异常（如表被删除）。您可以参考<code>ReasonOfStateChanged</code>、<code>ErrorLogUrls</code>报错进行排查和修复。但是修复后，您无法恢复 <strong>CANCELLED</strong> 状态的导入作业。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">example_db</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> example_tbl2_ordertest2 \G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  Id: </span><span class="token number" style="color:#36acaa">63013</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Name: example_tbl2_ordertest2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          CreateTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">09</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           PauseTime: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             EndTime: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              DbName: default_cluster:example_db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           TableName: example_tbl2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               State: RUNNING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      DataSourceType: KAFKA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      CurrentTaskNum: </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       JobProperties: {</span><span class="token string" style="color:#e3116c">&quot;partitions&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;partial_update&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;columnToColumnExpr&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;commodity_id,customer_name,country,pay_time,pay_dt=from_unixtime(`pay_time`, &#x27;%Y%m%d&#x27;),price&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;maxBatchIntervalS&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;20&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;whereExpr&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;dataFormat&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;timezone&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;Asia/Shanghai&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;format&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;json&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;json_root&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;strict_mode&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;jsonpaths&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;[\&quot;$.commodity_id\&quot;,\&quot;$.customer_name\&quot;,\&quot;$.country\&quot;,\&quot;$.pay_time\&quot;,\&quot;$.price\&quot;]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;desireTaskConcurrentNum&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;maxErrorNum&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;strip_outer_array&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;false&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;currentTaskConcurrentNum&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;maxBatchRows&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;200000&quot;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSourceProperties: {</span><span class="token string" style="color:#e3116c">&quot;topic&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;ordertest2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;currentKafkaPartitions&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;brokerList&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;&lt;kafka_broker1_ip&gt;:&lt;kafka_broker1_port&gt;,&lt;kafka_broker2_ip&gt;:&lt;kafka_broker2_port&gt;&quot;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CustomProperties: {</span><span class="token string" style="color:#e3116c">&quot;kafka_default_offsets&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING&quot;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           Statistic: {</span><span class="token string" style="color:#e3116c">&quot;receivedBytes&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">230</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;errorRows&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;committedTaskNum&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;loadedRows&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;loadRowsRate&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;abortedTaskNum&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;totalRows&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;unselectedRows&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;receivedBytesRate&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;taskExecuteTimeMs&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">522</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Progress: {</span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;OFFSET_ZERO&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;OFFSET_ZERO&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;OFFSET_ZERO&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;4&quot;</span><span class="token plain">:</span><span class="token string" style="color:#e3116c">&quot;OFFSET_ZERO&quot;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ReasonOfStateChanged: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ErrorLogUrls: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            OtherMsg: </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>StarRocks 只支持查看当前正在运行中的导入作业，不支持查看已经停止和未开始的导入作业。</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看导入任务">查看导入任务<a href="#查看导入任务" class="hash-link" aria-label="查看导入任务的直接链接" title="查看导入任务的直接链接">​</a></h3>
<p>执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD TASK">SHOW ROUTINE LOAD TASK</a>，查看导入作业<code>example_tbl2_ordertest2</code> 中一个或多个导入任务的信息。比如当前有多少任务正在运行，消费分区及进度<code>DataSourceProperties</code>，以及对应的 Coordinator BE 节点 <code>BeId</code>。</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MySQL </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">example_db</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> TASK </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> JobName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;example_tbl2_ordertest2&quot;</span><span class="token plain"> \G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              TaskId: </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">c3a823</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">d73e</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">a64</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b9cb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b9eced026753</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               TxnId: </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           TxnStatus: UNKNOWN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               JobId: </span><span class="token number" style="color:#36acaa">63013</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          CreateTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">09</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LastScheduledTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">47</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">27</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ExecuteStartTime: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Timeout: </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                BeId: </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSourceProperties: {</span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;4&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Message: there </span><span class="token operator" style="color:#393A34">is</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">no</span><span class="token plain"> new </span><span class="token keyword" style="color:#00009f">data</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> kafka</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wait </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> seconds </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> schedule again</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              TaskId: f76c97ac</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">26</span><span class="token plain">aa</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">b41</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">8194</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a8ba2063eb00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               TxnId: </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           TxnStatus: UNKNOWN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               JobId: </span><span class="token number" style="color:#36acaa">63013</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          CreateTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">09</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">05</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LastScheduledTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">47</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">26</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ExecuteStartTime: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Timeout: </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                BeId: </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSourceProperties: {</span><span class="token string" style="color:#e3116c">&quot;2&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Message: there </span><span class="token operator" style="color:#393A34">is</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">no</span><span class="token plain"> new </span><span class="token keyword" style="color:#00009f">data</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> kafka</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wait </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> seconds </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> schedule again</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              TaskId: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">a327a34</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">99</span><span class="token plain">f4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">f8d</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">8014</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">cd38db99ec6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               TxnId: </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           TxnStatus: UNKNOWN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               JobId: </span><span class="token number" style="color:#36acaa">63013</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          CreateTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">09</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">26</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   LastScheduledTime: </span><span class="token number" style="color:#36acaa">2022</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">08</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">47</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">27</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ExecuteStartTime: </span><span class="token boolean" style="color:#36acaa">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Timeout: </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                BeId: </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSourceProperties: {</span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain">:</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             Message: there </span><span class="token operator" style="color:#393A34">is</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">no</span><span class="token plain"> new </span><span class="token keyword" style="color:#00009f">data</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> kafka</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wait </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> seconds </span><span class="token keyword" style="color:#00009f">to</span><span class="token plain"> schedule again</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="暂停导入作业">暂停导入作业<a href="#暂停导入作业" class="hash-link" aria-label="暂停导入作业的直接链接" title="暂停导入作业的直接链接">​</a></h2>
<p>执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/PAUSE ROUTINE LOAD">PAUSE ROUTINE LOAD</a> 语句后，会暂停导入作业。导入作业会进入 <strong>PAUSED</strong> 状态，但是导入作业未结束，您可以执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/RESUME ROUTINE LOAD">RESUME ROUTINE LOAD</a> 语句重启该导入作业。您也可以执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a> 语句查看已暂停的导入作业的状态。</p>
<p>例如，可以通过以下语句，暂停导入作业<code>example_tbl2_ordertest2</code>：</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PAUSE </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> example_tbl2_ordertest2</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="恢复导入作业">恢复导入作业<a href="#恢复导入作业" class="hash-link" aria-label="恢复导入作业的直接链接" title="恢复导入作业的直接链接">​</a></h2>
<p>执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/RESUME ROUTINE LOAD">RESUME ROUTINE LOAD</a>，恢复导入作业。导入作业会先短暂地进入 <strong>NEED_SCHEDULE</strong> 状态，表示正在重新调度导入作业，一段时间后会恢复至 <strong>RUNNING</strong> 状态，继续消费 Kafka 消息并且导入数据。您可以执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a> 语句查看已恢复的导入作业。</p>
<p>例如，可以通过以下语句，恢复导入作业<code>example_tbl2_ordertest2</code>：</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RESUME </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> example_tbl2_ordertest2</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="修改导入作业">修改导入作业<a href="#修改导入作业" class="hash-link" aria-label="修改导入作业的直接链接" title="修改导入作业的直接链接">​</a></h2>
<p>修改前，您需要先执行 PAUSE ROUTINE LOAD 暂停导入作业。然后执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/alter-routine-load">ALTER ROUTINE LOAD</a> 语句，修改导入作业的参数配置。修改成功后，您需要执行 <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/RESUME ROUTINE LOAD">RESUME ROUTINE LOAD</a>，恢复导入作业。然后执行  <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/SHOW ROUTINE LOAD">SHOW ROUTINE LOAD</a> 语句查看修改后的导入作业。</p>
<p>例如，当存活 BE 节点数增至 6 个，待消费分区为<code>&quot;0,1,2,3,4,5,6,7&quot;</code>时，如果您希望提高实际的导入并行度，则可以通过以下语句，将期望任务并行度<code>desired_concurrent_number</code> 增加至 <code>6</code>（大于等于存活 BE 节点数），并且调整待消费分区和起始消费位点。</p>
<blockquote>
<p><strong>说明</strong></p>
<p>由于实际导入并行度由多个参数的最小值决定，此时，您还需要确保 FE 动态参数 <code>max_routine_load_task_concurrent_num</code>的值大于或等于 <code>6</code>。</p>
</blockquote>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> example_tbl2_ordertest2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROPERTIES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;desired_concurrent_number&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;6&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> kafka</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_partitions&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0,1,2,3,4,5,6,7&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;kafka_offsets&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;OFFSET_BEGINNING,OFFSET_BEGINNING,OFFSET_BEGINNING,OFFSET_BEGINNING,OFFSET_END,OFFSET_END,OFFSET_END,OFFSET_END&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="停止导入作业">停止导入作业<a href="#停止导入作业" class="hash-link" aria-label="停止导入作业的直接链接" title="停止导入作业的直接链接">​</a></h2>
<p>执行  <a href="/zh/docs/sql-reference/sql-statements/data-manipulation/STOP ROUTINE LOAD">STOP ROUTINE LOAD</a>，可以停止导入作业。导入作业会进入 <strong>STOPPED</strong> 状态，代表此导入作业已经结束，且无法恢复。再次执行 SHOW ROUTINE LOAD 语句，将无法看到已经停止的导入作业。</p>
<p>例如，可以通过以下语句，停止导入作业<code>example_tbl2_ordertest2</code>：</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">STOP </span><span class="token keyword" style="color:#00009f">ROUTINE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LOAD</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FOR</span><span class="token plain"> example_tbl2_ordertest2</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常见问题">常见问题<a href="#常见问题" class="hash-link" aria-label="常见问题的直接链接" title="常见问题的直接链接">​</a></h2>
<p>请参见 <a href="/zh/docs/faq/loading/Routine_load_faq">Routine Load 常见问题</a>。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/StarRocks/starrocks/tree/main/versioned_docs/version-3.1/loading/RoutineLoad.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/docs/loading/Kafka-connector-starrocks"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">使用 Kafka connector 导入数据</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/docs/category/load-data-from-apache-spark"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Load data from Apache Spark</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#支持的数据文件格式" class="table-of-contents__link toc-highlight">支持的数据文件格式</a></li><li><a href="#基本原理" class="table-of-contents__link toc-highlight">基本原理</a><ul><li><a href="#概念" class="table-of-contents__link toc-highlight">概念</a></li><li><a href="#作业流程" class="table-of-contents__link toc-highlight">作业流程</a></li></ul></li><li><a href="#准备工作" class="table-of-contents__link toc-highlight">准备工作</a></li><li><a href="#创建导入作业" class="table-of-contents__link toc-highlight">创建导入作业</a><ul><li><a href="#导入-csv-数据" class="table-of-contents__link toc-highlight">导入 CSV 数据</a></li><li><a href="#导入-json-数据" class="table-of-contents__link toc-highlight">导入 JSON 数据</a></li><li><a href="#导入-avro-数据" class="table-of-contents__link toc-highlight">导入 Avro 数据</a></li></ul></li><li><a href="#查看导入作业和任务" class="table-of-contents__link toc-highlight">查看导入作业和任务</a><ul><li><a href="#查看导入作业" class="table-of-contents__link toc-highlight">查看导入作业</a></li><li><a href="#查看导入任务" class="table-of-contents__link toc-highlight">查看导入任务</a></li></ul></li><li><a href="#暂停导入作业" class="table-of-contents__link toc-highlight">暂停导入作业</a></li><li><a href="#恢复导入作业" class="table-of-contents__link toc-highlight">恢复导入作业</a></li><li><a href="#修改导入作业" class="table-of-contents__link toc-highlight">修改导入作业</a></li><li><a href="#停止导入作业" class="table-of-contents__link toc-highlight">停止导入作业</a></li><li><a href="#常见问题" class="table-of-contents__link toc-highlight">常见问题</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh/docs/introduction/StarRocks_intro">Documentation</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 StarRocks, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>