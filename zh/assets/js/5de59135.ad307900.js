"use strict";(self.webpackChunkstarrocks=self.webpackChunkstarrocks||[]).push([[59853],{32453:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>_,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>o});var r=t(85893),i=t(11151);const s={},_="query_dump \u63a5\u53e3",a={id:"faq/Dump_query",title:"query_dump \u63a5\u53e3",description:"\u672c\u6587\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 StarRocks \u7684 query_dump \u63a5\u53e3\u6765\u67e5\u770b SQL \u67e5\u8be2\u7684\u76f8\u5173\u4fe1\u606f\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/version-3.0/faq/Dump_query.md",sourceDirName:"faq",slug:"/faq/Dump_query",permalink:"/zh/docs/3.0/faq/Dump_query",draft:!1,unlisted:!1,editUrl:"https://github.com/StarRocks/starrocks/tree/main/versioned_docs/version-3.0/faq/Dump_query.md",tags:[],version:"3.0",frontMatter:{},sidebar:"documentation",previous:{title:"\u90e8\u7f72\u5e38\u89c1\u95ee\u9898",permalink:"/zh/docs/3.0/faq/Deploy_faq"},next:{title:"Export\u5e38\u89c1\u95ee\u9898",permalink:"/zh/docs/3.0/faq/Exporting_faq"}},l={},o=[{value:"\u529f\u80fd\u4ecb\u7ecd",id:"\u529f\u80fd\u4ecb\u7ecd",level:2},{value:"HTTP \u63a5\u53e3",id:"http-\u63a5\u53e3",level:2},{value:"\u8fd4\u56de\u683c\u5f0f",id:"\u8fd4\u56de\u683c\u5f0f",level:2},{value:"Keywords",id:"keywords",level:2}];function c(e){const n=Object.assign({h1:"h1",p:"p",ul:"ul",li:"li",code:"code",h2:"h2",pre:"pre"},(0,i.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"query_dump-\u63a5\u53e3",children:"query_dump \u63a5\u53e3"}),"\n",(0,r.jsx)(n.p,{children:"\u672c\u6587\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 StarRocks \u7684 query_dump \u63a5\u53e3\u6765\u67e5\u770b SQL \u67e5\u8be2\u7684\u76f8\u5173\u4fe1\u606f\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4f7f\u7528 StarRocks \u6267\u884c\u67e5\u8be2 SQL \u65f6\uff0c\u5982\u679c\u9047\u5230\u4ee5\u4e0b\u95ee\u9898\uff0c\u53ef\u4ee5\u901a\u8fc7 StarRocks \u7684 query_dump \u529f\u80fd\u5c06 SQL \u4ee5\u53ca\u76f8\u5173\u7684\u4fe1\u606f\u53d1\u9001\u7ed9 StarRocks \u6280\u672f\u652f\u6301\u4eba\u5458\u8fdb\u884c\u95ee\u9898\u6392\u67e5\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u6267\u884c SQL \u6216\u8005 Explain SQL \u65f6\u8fd4\u56de ",(0,r.jsx)(n.code,{children:"Unknown Error"}),"\u3002"]}),"\n",(0,r.jsx)(n.li,{children:"\u6267\u884c SQL \u65f6\u9047\u5230\u975e\u6b63\u5e38\u8fd4\u56de\u7684\u62a5\u9519\u4fe1\u606f\u6216\u5f02\u5e38\u3002"}),"\n",(0,r.jsx)(n.li,{children:"\u6267\u884c SQL \u65f6\u6548\u7387\u4e0d\u7b26\u5408\u9884\u671f\uff0c\u6216\u8005\u53d1\u73b0\u6267\u884c\u8ba1\u5212\u6709\u4f18\u5316\u70b9\uff08\u4f8b\u5982\uff0c\u53ef\u4ee5\u88c1\u526a\u5206\u533a\u6216\u8fdb\u884c Join \u987a\u5e8f\u8c03\u6574\uff09\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u529f\u80fd\u4ecb\u7ecd",children:"\u529f\u80fd\u4ecb\u7ecd"}),"\n",(0,r.jsx)(n.p,{children:"query_dump \u4f1a\u6839\u636e\u67e5\u8be2\u7684 SQL\uff0c\u8fd4\u56de FE \u6267\u884c SQL \u65f6\u4f9d\u8d56\u7684\u4fe1\u606f\uff0c\u5305\u62ec\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u67e5\u8be2\u8bed\u53e5"}),"\n",(0,r.jsx)(n.li,{children:"\u67e5\u8be2\u4e2d\u5f15\u7528\u7684\u8868\u7ed3\u6784"}),"\n",(0,r.jsx)(n.li,{children:"Session \u53d8\u91cf"}),"\n",(0,r.jsx)(n.li,{children:"BE \u4e2a\u6570"}),"\n",(0,r.jsx)(n.li,{children:"\u7edf\u8ba1\u4fe1\u606f\uff08Min\uff0cMax\u503c\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u5f02\u5e38\u4fe1\u606f\uff08\u5f02\u5e38\u5806\u6808\uff09"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"http-\u63a5\u53e3",children:"HTTP \u63a5\u53e3"}),"\n",(0,r.jsx)(n.p,{children:"Http Post"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:" fe_host:fe_http_port/api/query_dump?db=${database} post_data=${Query}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"wget --user=${username} --password=${password} --post-file ${query_file} http://${fe_host}:${fe_http_port}/api/query_dump?db=${database} -O ${dump_file}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53c2\u6570\u8bf4\u660e\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"query_file\uff1a\u5305\u542b query \u7684\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(n.li,{children:"dump_file\uff1a\u8f93\u51fa\u6587\u4ef6\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["db\uff1aSQL \u8bed\u53e5\u6267\u884c\u7684\u6570\u636e\u5e93\u3002\u5982\u679c\u7528\u6237\u5728 query \u4e2d\u5305\u542b\u4e86 ",(0,r.jsx)(n.code,{children:"use db"})," \u8bed\u53e5\uff0c\u5219 ",(0,r.jsx)(n.code,{children:"db"})," \u53c2\u6570\u4e3a\u53ef\u9009\uff0c\u5426\u5219\u9700\u8981\u6307\u5b9a\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u8bf7\u6c42\u6837\u4f8b:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"wget --user=root --password=123 --post-file query_file http://127.0.0.1:8030/api/query_dump?db=tpch -O dump_file\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8fd4\u56de\u683c\u5f0f",children:"\u8fd4\u56de\u683c\u5f0f"}),"\n",(0,r.jsx)(n.p,{children:"\u8fd4\u56de\u683c\u5f0f\u4e3a JSON\uff0c\u6837\u4f8b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "statement": "select\\n    l_returnflag,\\n    l_linestatus,\\n    sum(l_quantity) as sum_qty,\\n    sum(l_extendedprice) as sum_base_price,\\n    sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\\n    sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\\n    avg(l_quantity) as avg_qty,\\n    avg(l_extendedprice) as avg_price,\\n    avg(l_discount) as avg_disc,\\n    count(*) as count_order\\nfrom\\n    lineitem\\nwhere\\n    l_shipdate \\u003c\\u003d date \\u00271998-12-01\\u0027\\ngroup by\\n    l_returnflag,\\n    l_linestatus\\norder by\\n    l_returnflag,\\n    l_linestatus ;\\n",\n  "table_meta": {\n    "test.lineitem": "CREATE TABLE `lineitem` (\\n  `L_ORDERKEY` int(11) NOT NULL COMMENT \\"\\",\\n  `L_PARTKEY` int(11) NOT NULL COMMENT \\"\\",\\n  `L_SUPPKEY` int(11) NOT NULL COMMENT \\"\\",\\n  `L_LINENUMBER` int(11) NOT NULL COMMENT \\"\\",\\n  `L_QUANTITY` double NOT NULL COMMENT \\"\\",\\n  `L_EXTENDEDPRICE` double NOT NULL COMMENT \\"\\",\\n  `L_DISCOUNT` double NOT NULL COMMENT \\"\\",\\n  `L_TAX` double NOT NULL COMMENT \\"\\",\\n  `L_RETURNFLAG` char(1) NOT NULL COMMENT \\"\\",\\n  `L_LINESTATUS` char(1) NOT NULL COMMENT \\"\\",\\n  `L_SHIPDATE` date NOT NULL COMMENT \\"\\",\\n  `L_COMMITDATE` date NOT NULL COMMENT \\"\\",\\n  `L_RECEIPTDATE` date NOT NULL COMMENT \\"\\",\\n  `L_SHIPINSTRUCT` char(25) NOT NULL COMMENT \\"\\",\\n  `L_SHIPMODE` char(10) NOT NULL COMMENT \\"\\",\\n  `L_COMMENT` varchar(44) NOT NULL COMMENT \\"\\",\\n  `PAD` char(1) NOT NULL COMMENT \\"\\"\\n) ENGINE\\u003dOLAP \\nDUPLICATE KEY(`L_ORDERKEY`)\\nCOMMENT \\"OLAP\\"\\nDISTRIBUTED BY HASH(`L_ORDERKEY`) BUCKETS 20 \\nPROPERTIES (\\n\\"replication_num\\" \\u003d \\"1\\",\\n\\"in_memory\\" \\u003d \\"false\\",\\n\\"storage_format\\" \\u003d \\"DEFAULT\\"\\n);"\n  },\n  "table_row_count": {\n    "test.lineitem": {\n      "lineitem": 600000000\n    }\n  },\n  "session_variables": "{\\"runtime_join_filter_push_down_limit\\":1024000,\\"codegen_level\\":0,\\"character_set_connection\\":\\"utf8\\",\\"enable_insert_strict\\":true,\\"div_precision_increment\\":4,\\"tx_isolation\\":\\"REPEATABLE-READ\\",\\"wait_timeout\\":28800,\\"auto_increment_increment\\":1,\\"foreign_key_checks\\":true,\\"character_set_client\\":\\"utf8\\",\\"autocommit\\":true,\\"character_set_results\\":\\"utf8\\",\\"parallel_fragment_exec_instance_num\\":1,\\"max_scan_key_num\\":-1,\\"enable_global_runtime_filter\\":true,\\"forward_to_master\\":false,\\"net_read_timeout\\":60,\\"streaming_preaggregation_mode\\":\\"auto\\",\\"storage_engine\\":\\"olap\\",\\"tx_visible_wait_timeout\\":10,\\"new_planner_optimize_timeout\\":3000,\\"force_schedule_local\\":false,\\"enable_query_dump\\":false,\\"prefer_join_method\\":\\"broadcast\\",\\"load_mem_limit\\":0,\\"sql_select_limit\\":9223372036854775807,\\"profiling\\":false,\\"sql_safe_updates\\":0,\\"enable_new_planner_mock_tpch_statistic\\":true,\\"query_cache_type\\":0,\\"use_v2_rollup\\":false,\\"disable_colocate_join\\":false,\\"max_pushdown_conditions_per_column\\":-1,\\"global_runtime_filter_max_size\\":4096000,\\"new_planner_tpch_scale\\":100,\\"enable_vectorized_engine\\":true,\\"net_write_timeout\\":60,\\"collation_database\\":\\"utf8_general_ci\\",\\"hash_join_push_down_right_table\\":true,\\"new_planner_agg_stage\\":0,\\"enable_runtime_filter_from_planner\\":true,\\"collation_connection\\":\\"utf8_general_ci\\",\\"resource_group\\":\\"normal\\",\\"enable_new_planner_push_down_join_to_agg\\":false,\\"broadcast_row_limit\\":15000000,\\"exec_mem_limit\\":2147483648,\\"disable_join_reorder\\":false,\\"is_report_success\\":false,\\"global_runtime_filter_rpc_timeout\\":400,\\"enable_groupby_use_output_alias\\":false,\\"global_runtime_filter_wait_timeout\\":200,\\"enable_vectorized_insert\\":true,\\"net_buffer_length\\":16384,\\"transmission_compression_type\\":\\"LZ4\\",\\"interactive_timeout\\":3600,\\"enable_spilling\\":false,\\"batch_size\\":1024,\\"max_allowed_packet\\":1048576,\\"query_timeout\\":300,\\"test_materialized_view\\":false,\\"enable_cbo\\":false,\\"collation_server\\":\\"utf8_general_ci\\",\\"new_planner_max_transform_reorder_joins\\":8,\\"time_zone\\":\\"Asia/Shanghai\\",\\"max_execution_time\\":3000000,\\"character_set_server\\":\\"utf8\\",\\"rewrite_count_distinct_to_bitmap_hll\\":true,\\"parallel_exchange_instance_num\\":-1,\\"sql_mode\\":0,\\"SQL_AUTO_IS_NULL\\":false,\\"event_scheduler\\":\\"OFF\\",\\"disable_streaming_preaggregations\\":false}",\n  "column_statistics": {\n    "test.lineitem": {\n      "L_TAX": "[0.0, 0.08, 0.0, 8.0, 9.0]",\n      "L_SHIPDATE": "[6.942816E8, 9.124416E8, 0.0, 4.0, 2526.0]",\n      "L_EXTENDEDPRICE": "[901.0, 104949.5, 0.0, 8.0, 932377.0]",\n      "L_DISCOUNT": "[0.0, 0.1, 0.0, 8.0, 11.0]",\n      "L_RETURNFLAG": "[-Infinity, Infinity, 0.0, 1.0, 3.0]",\n      "L_LINESTATUS": "[-Infinity, Infinity, 0.0, 1.0, 2.0]",\n      "L_QUANTITY": "[1.0, 50.0, 0.0, 8.0, 50.0]"\n    }\n  },\n  "be_number": 3,\n  "exception": []\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"keywords",children:"Keywords"}),"\n",(0,r.jsx)(n.p,{children:"query_dump, query dump"})]})}const u=function(e={}){const{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,r.jsx)(n,Object.assign({},e,{children:(0,r.jsx)(c,e)})):c(e)}},11151:(e,n,t)=>{t.d(n,{Zo:()=>a,ah:()=>s});var r=t(67294);const i=r.createContext({});function s(e){const n=r.useContext(i);return r.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const _={};function a({components:e,children:n,disableParentContext:t}){let a;return a=t?"function"==typeof e?e({}):e||_:s(e),r.createElement(i.Provider,{value:a},n)}}}]);